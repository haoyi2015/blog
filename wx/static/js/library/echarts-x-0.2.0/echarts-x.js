define("echarts-x",["echarts-x/echarts-x"],function(t){return t}),define("echarts-x/echarts-x",["require","zrender","qtek","echarts","echarts/config","./config","zrender/tool/util","qtek/Node","qtek/Mesh","qtek/Material","qtek/Shader","qtek/Texture2D","qtek/core/glenum","./util/shader/albedo.essl","./util/shader/points.essl","./util/shader/curveAnimatingPoints.essl","./util/shader/vectorFieldParticle.essl","./util/shader/lambert.essl","./util/shader/motionBlur.essl"],function(t){function r(t){throw Error(t+" version is too old, needs "+i[t]+" or higher")}function e(t,e){t.version.replace(".","")-0<i[e].replace(".","")-0&&r(e),console.log("Loaded "+e+", version "+t.version)}var n={version:"0.2.0",dependencies:{echarts:"2.2.1",zrender:"2.0.8",qtek:"0.2.1"}},i=n.dependencies;e(t("zrender"),"zrender"),e(t("qtek"),"qtek"),e(t("echarts"),"echarts");var a=t("echarts/config"),s=t("./config"),o=t("zrender/tool/util");o.merge(a,s,!0),t("qtek/Node"),t("qtek/Mesh"),t("qtek/Material"),t("qtek/Shader"),t("qtek/Texture2D"),t("qtek/core/glenum");var u=t("qtek/Shader");return u["import"](t("./util/shader/albedo.essl")),u["import"](t("./util/shader/points.essl")),u["import"](t("./util/shader/curveAnimatingPoints.essl")),u["import"](t("./util/shader/vectorFieldParticle.essl")),u["import"](t("./util/shader/lambert.essl")),u["import"](t("./util/shader/motionBlur.essl")),n}),define("qtek",["qtek/qtek.amd"],function(t){return t}),define("qtek/qtek.amd",[],function(){return{version:"0.2.1"}}),define("echarts-x/config",[],{CHART_TYPE_MAP3D:"map3d",map3d:{background:"",zlevel:-1,mapType:"world",flat:!1,flatAngle:30,hoverable:!0,clickable:!0,selectedMode:!1,mapLocation:{x:0,y:0,width:"100%",height:"100%"},baseLayer:{backgroundColor:"black",backgroundImage:"",quality:"medium",heightImage:""},light:{show:!1,sunIntensity:1,ambientIntensity:.1,time:""},surfaceLayers:[],itemStyle:{normal:{label:{show:!1,textStyle:{color:"black"}},borderColor:"black",borderWidth:1,areaStyle:{color:"#396696",opacity:1}},emphasis:{borderColor:"black",borderWidth:1,areaStyle:{color:"rgba(255,215,0,0.5)"}}},roam:{autoRotate:!0,autoRotateAfterStill:3,focus:"",zoom:1,minZoom:.5,maxZoom:1.5,preserve:!0}},markBar:{barSize:1,distance:1,itemStyle:{normal:{}}},markPoint:{symbolSize:4,distance:1,orientation:"tangent",orientationAngle:0,itemStyle:{normal:{borderWidth:1,borderColor:"#000",label:{show:!1,position:"inside",textStyle:{color:"black"}}}}},markLine:{distance:1,itemStyle:{normal:{lineStyle:{width:1,opacity:.2}}}},EVENT:{MAP3D_SELECTED:"map3dSelected"}}),define("qtek/Node",["require","./core/Base","./math/Vector3","./math/Quaternion","./math/Matrix4","./dep/glmatrix"],function(t){"use strict";var r=t("./core/Base"),e=t("./math/Vector3"),n=t("./math/Quaternion"),i=t("./math/Matrix4"),a=t("./dep/glmatrix"),s=a.mat4,o=0,u=r.derive({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name="NODE_"+o++),this.position||(this.position=new e),this.rotation||(this.rotation=new n),this.scale||(this.scale=new e(1,1,1)),this.worldTransform=new i,this.localTransform=new i,this._children=[]},{visible:!0,isRenderable:function(){return!1},setName:function(t){this._scene&&(delete this._scene._nodeRepository[this.name],this._scene._nodeRepository[t]=this),this.name=t},add:function(t){this._inIterating&&console.warn("Add operation can cause unpredictable error when in iterating"),t._parent!==this&&(t._parent&&t._parent.remove(t),t._parent=this,this._children.push(t),this._scene&&this._scene!==t.scene&&t.traverse(this._addSelfToScene,this))},remove:function(t){this._inIterating&&console.warn("Remove operation can cause unpredictable error when in iterating");var r=this._children.indexOf(t);0>r||(this._children.splice(r,1),t._parent=null,this._scene&&t.traverse(this._removeSelfFromScene,this))},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(t){t._scene.removeFromScene(t),t._scene=null},_addSelfToScene:function(t){this._scene.addToScene(t),t._scene=this._scene},isAncestor:function(t){for(var r=t._parent;r;){if(r===this)return!0;r=r._parent}return!1},children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},getChildByName:function(t){for(var r=0;this._children.length>r;r++)if(this._children[r].name===t)return this._children[r]},getDescendantByName:function(t){for(var r=0;this._children.length>r;r++){var e=this._children[r];if(e.name===t)return e;var n=e.getDescendantByName(t);if(n)return n}},queryNode:function(t){if(t){for(var r=t.split("/"),e=this,n=0;r.length>n;n++){var i=r[n];if(i){for(var a=!1,s=0;e._children.length>s;s++){var o=e._children[s];if(o.name===i){e=o,a=!0;break}}if(!a)return}}return e}},getPath:function(t){if(!this._parent)return"/";for(var r=this._parent,e=this.name;r._parent&&(e=r.name+"/"+e,r._parent!=t);)r=r._parent;return!r._parent&&t?null:e},traverse:function(t,r,e){this._inIterating=!0,(void 0===e||this.constructor===e)&&t.call(r,this);for(var n=this._children,i=0,a=n.length;a>i;i++)n[i].traverse(t,r,e);this._inIterating=!1},setLocalTransform:function(t){s.copy(this.localTransform._array,t._array),this.decomposeLocalTransform()},decomposeLocalTransform:function(t){var r=t?null:this.scale;this.localTransform.decomposeMatrix(r,this.rotation,this.position)},setWorldTransform:function(t){s.copy(this.worldTransform._array,t._array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var t=s.create();return function(r){this._parent?(s.invert(t,this._parent.worldTransform._array),s.multiply(this.localTransform._array,t,this.worldTransform._array)):s.copy(this.localTransform._array,this.worldTransform._array);var e=r?null:this.scale;this.localTransform.decomposeMatrix(e,this.rotation,this.position)}}(),updateLocalTransform:function(){var t=this.position,r=this.rotation,e=this.scale;if(t._dirty||e._dirty||r._dirty){var n=this.localTransform._array;s.fromRotationTranslation(n,r._array,t._array),s.scale(n,n,e._array),r._dirty=!1,e._dirty=!1,t._dirty=!1,this._needsUpdateWorldTransform=!0}},updateWorldTransform:function(){this._parent?s.multiply(this.worldTransform._array,this._parent.worldTransform._array,this.localTransform._array):s.copy(this.worldTransform._array,this.localTransform._array)},update:function(t){this.autoUpdateLocalTransform?this.updateLocalTransform():t=!0,(t||this._needsUpdateWorldTransform)&&(this.updateWorldTransform(),t=!0,this._needsUpdateWorldTransform=!1);for(var r=0,e=this._children.length;e>r;r++)this._children[r].update(t)},getWorldPosition:function(t){var r=this.worldTransform._array;return t?(t._array[0]=r[12],t._array[1]=r[13],t._array[2]=r[14],t):new e(r[12],r[13],r[14])},clone:function(){var t=new this.constructor;t.setName(this.name),t.position.copy(this.position),t.rotation.copy(this.rotation),t.scale.copy(this.scale);for(var r=0;this._children.length>r;r++)t.add(this._children[r].clone());return t},rotateAround:function(){var t=new e,r=new i;return function(e,n,i){t.copy(this.position).subtract(e),this.localTransform.identity(),this.localTransform.translate(e),this.localTransform.rotate(i,n),r.fromRotationTranslation(this.rotation,t),this.localTransform.multiply(r),this.localTransform.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var t=new i;return function(r,e){t.lookAt(this.position,r,e||this.localTransform.y).invert(),t.decomposeMatrix(null,this.rotation,this.position)}}()});return u}),define("qtek/Mesh",["require","./Renderable","./core/glenum"],function(t){"use strict";var r=t("./Renderable"),e=t("./core/glenum"),n=r.derive({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{render:function(t,e){var n=e||this.material;if(this.skeleton){var i=this.skeleton.getSubSkinMatrices(this.__GUID__,this.joints);n.shader.setUniformBySemantic(t,"SKIN_MATRIX",i)}return r.prototype.render.call(this,t,e)}});return n.POINTS=e.POINTS,n.LINES=e.LINES,n.LINE_LOOP=e.LINE_LOOP,n.LINE_STRIP=e.LINE_STRIP,n.TRIANGLES=e.TRIANGLES,n.TRIANGLE_STRIP=e.TRIANGLE_STRIP,n.TRIANGLE_FAN=e.TRIANGLE_FAN,n.BACK=e.BACK,n.FRONT=e.FRONT,n.FRONT_AND_BACK=e.FRONT_AND_BACK,n.CW=e.CW,n.CCW=e.CCW,n}),define("qtek/Material",["require","./core/Base","./Texture"],function(t){"use strict";var r=t("./core/Base"),e=t("./Texture"),n=r.derive({name:"",uniforms:null,shader:null,depthTest:!0,depthMask:!0,transparent:!1,blend:null,_enabledUniforms:null},function(){this.name||(this.name="MATERIAL_"+this.__GUID__),this.shader&&this.attachShader(this.shader),this.uniforms||(this.uniforms={})},{bind:function(t,r){for(var n=0,i=r&&r.shader===this.shader,a=0;this._enabledUniforms.length>a;a++){var s=this._enabledUniforms[a],o=this.uniforms[s];if(!i||r.uniforms[s].value!==o.value)if(void 0!==o.value){if(!(null===o.value||o.value instanceof Array&&!o.value.length))if(o.value instanceof e){var u=this.shader.setUniform(t,"1i",s,n);if(!u)continue;var c=o.value;t.activeTexture(t.TEXTURE0+n),c.isRenderable()?c.bind(t):c.unbind(t),n++}else if(o.value instanceof Array){if(0===o.value.length)continue;var _=o.value[0];if(_ instanceof e){if(!this.shader.hasUniform(s))continue;for(var h=[],f=0;o.value.length>f;f++){var c=o.value[f];t.activeTexture(t.TEXTURE0+n),c.isRenderable()?c.bind(t):c.unbind(t),h.push(n++)}this.shader.setUniform(t,"1iv",s,h)}else this.shader.setUniform(t,o.type,s,o.value)}else this.shader.setUniform(t,o.type,s,o.value)}else console.warn('Uniform value "'+s+'" is undefined')}},setUniform:function(t,r){var e=this.uniforms[t];e&&(e.value=r)},setUniforms:function(t){for(var r in t){var e=t[r];this.setUniform(r,e)}},enableUniform:function(t){this.uniforms[t]&&!this.isUniformEnabled(t)&&this._enabledUniforms.push(t)},disableUniform:function(t){var r=this._enabledUniforms.indexOf(t);r>=0&&this._enabledUniforms.splice(r,1)},isUniformEnabled:function(t){return this._enabledUniforms.indexOf(t)>=0},set:function(t,r){if("object"==typeof t)for(var e in t){var n=t[e];this.set(e,n)}else{var i=this.uniforms[t];i&&(i.value=r)}},get:function(t){var r=this.uniforms[t];return r?r.value:void 0},attachShader:function(t,r){this.shader&&this.shader.detached();var e=this.uniforms;if(this.uniforms=t.createUniforms(),this.shader=t,this._enabledUniforms=Object.keys(this.uniforms),r)for(var n in e)this.uniforms[n]&&(this.uniforms[n].value=e[n].value);t.attached()},detachShader:function(){this.shader.detached(),this.shader=null,this.uniforms={}},clone:function(){var t=new n({name:this.name,shader:this.shader});for(var r in this.uniforms)t.uniforms[r].value=this.uniforms[r].value;return t.depthTest=this.depthTest,t.depthMask=this.depthMask,t.transparent=this.transparent,t.blend=this.blend,t},dispose:function(t,r){if(r)for(var n in this.uniforms){var i=this.uniforms[n].value;if(i)if(i instanceof e)i.dispose(t);else if(i instanceof Array)for(var a=0;i.length>a;a++)i[a]instanceof e&&i[a].dispose(t)}var s=this.shader;s&&(this.detachShader(),s.isAttachedToAny()||s.dispose(t))}});return n}),define("qtek/Shader",["require","./core/Base","./core/util","./core/Cache","./dep/glmatrix"],function(t){"use strict";function r(){return{locations:{},attriblocations:{}}}function e(t){for(var r=t.split("\n"),e=0,n=r.length;n>e;e++)r[e]=e+1+": "+r[e];return r.join("\n")}var n=t("./core/Base"),i=t("./core/util"),a=t("./core/Cache"),s=t("./dep/glmatrix"),o=s.mat2,u=s.mat3,c=s.mat4,_=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\w\,]+)?(\[.*?\])?\s*(:\s*([\S\s]+?))?;/g,h=/attribute\s+(float|int|vec2|vec3|vec4)\s+(\w*)\s*(:\s*(\w+))?;/g,f=/#define\s+(\w+)?(\s+[\w-.]+)?\s*\n/g,l={bool:"1i","int":"1i",sampler2D:"t",samplerCube:"t","float":"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"},d={bool:function(){return!0},"int":function(){return 0},"float":function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return[0,0]},vec3:function(){return[0,0,0]},vec4:function(){return[0,0,0,0]},ivec2:function(){return[0,0]},ivec3:function(){return[0,0,0]},ivec4:function(){return[0,0,0,0]},mat2:function(){return o.create()},mat3:function(){return u.create()},mat4:function(){return c.create()},array:function(){return[]}},y=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT","SKIN_MATRIX"],m=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],E={},v=1,T=2,p=3,A=n.derive(function(){return{vertex:"",fragment:"",precision:"mediump",attribSemantics:{},matrixSemantics:{},matrixSemanticKeys:[],uniformTemplates:{},attributeTemplates:{},vertexDefines:{},fragmentDefines:{},lightNumber:{},_attacheMaterialNumber:0,_uniformList:[],_textureStatus:{},_vertexProcessed:"",_fragmentProcessed:"",_currentLocationsMap:{}}},function(){this._cache=new a,this._updateShaderString()},{setVertex:function(t){this.vertex=t,this._updateShaderString(),this.dirty()},setFragment:function(t){this.fragment=t,this._updateShaderString(),this.dirty()},bind:function(t){if(this._cache.use(t.__GLID__,r),this._currentLocationsMap=this._cache.get("locations"),this._cache.isDirty()){this._updateShaderString();var e=this._buildProgram(t,this._vertexProcessed,this._fragmentProcessed);if(this._cache.fresh(),e)return e}t.useProgram(this._cache.get("program"))},dirty:function(){this._cache.dirtyAll();for(var t=0;this._cache._caches.length>t;t++)if(this._cache._caches[t]){var r=this._cache._caches[t];r.locations={},r.attriblocations={}}},_updateShaderString:function(){(this.vertex!==this._vertexPrev||this.fragment!==this._fragmentPrev)&&(this._parseImport(),this.attribSemantics={},this.matrixSemantics={},this._textureStatus={},this._parseUniforms(),this._parseAttributes(),this._parseDefines(),this._vertexPrev=this.vertex,this._fragmentPrev=this.fragment),this._addDefine()},define:function(t,r,e){e=void 0!==e?e:null,("vertex"==t||"both"==t)&&this.vertexDefines[r]!==e&&(this.vertexDefines[r]=e,this.dirty()),("fragment"==t||"both"==t)&&this.fragmentDefines[r]!==e&&(this.fragmentDefines[r]=e,"both"!==t&&this.dirty())},unDefine:function(t,r){("vertex"==t||"both"==t)&&this.isDefined("vertex",r)&&(delete this.vertexDefines[r],this.dirty()),("fragment"==t||"both"==t)&&this.isDefined("fragment",r)&&(delete this.fragmentDefines[r],"both"!==t&&this.dirty())},isDefined:function(t,r){switch(t){case"vertex":return void 0!==this.vertexDefines[r];case"fragment":return void 0!==this.fragmentDefines[r]}},getDefine:function(t,r){switch(t){case"vertex":return this.vertexDefines[r];case"fragment":return this.fragmentDefines[r]}},enableTexture:function(t){var r=this._textureStatus[t];if(r){var e=r.enabled;e||(r.enabled=!0,this.dirty())}},enableTexturesAll:function(){for(var t in this._textureStatus)this._textureStatus[t].enabled=!0;this.dirty()},disableTexture:function(t){var r=this._textureStatus[t];if(r){var e=!r.enabled;e||(r.enabled=!1,this.dirty())}},disableTexturesAll:function(){for(var t in this._textureStatus)this._textureStatus[t].enabled=!1;this.dirty()},isTextureEnabled:function(t){return this._textureStatus[t].enabled},getEnabledTextures:function(){var t=[];for(var r in this._textureStatus)this._textureStatus[r].enabled&&t.push(r);return t},hasUniform:function(t){var r=this._currentLocationsMap[t];return null!==r&&void 0!==r},setUniform:function(t,r,e,n){var i=this._currentLocationsMap,a=i[e];if(null===a||void 0===a)return!1;switch(r){case"m4":t.uniformMatrix4fv(a,!1,n);break;case"2i":t.uniform2i(a,n[0],n[1]);break;case"2f":t.uniform2f(a,n[0],n[1]);break;case"3i":t.uniform3i(a,n[0],n[1],n[2]);break;case"3f":t.uniform3f(a,n[0],n[1],n[2]);break;case"4i":t.uniform4i(a,n[0],n[1],n[2],n[3]);break;case"4f":t.uniform4f(a,n[0],n[1],n[2],n[3]);break;case"1i":t.uniform1i(a,n);break;case"1f":t.uniform1f(a,n);break;case"1fv":t.uniform1fv(a,n);break;case"1iv":t.uniform1iv(a,n);break;case"2iv":t.uniform2iv(a,n);break;case"2fv":t.uniform2fv(a,n);break;case"3iv":t.uniform3iv(a,n);break;case"3fv":t.uniform3fv(a,n);break;case"4iv":t.uniform4iv(a,n);break;case"4fv":t.uniform4fv(a,n);break;case"m2":case"m2v":t.uniformMatrix2fv(a,!1,n);break;case"m3":case"m3v":t.uniformMatrix3fv(a,!1,n);break;case"m4v":if(n instanceof Array){for(var s=new Float32Array(16*n.length),o=0,u=0;n.length>u;u++)for(var c=n[u],_=0;16>_;_++)s[o++]=c[_];t.uniformMatrix4fv(a,!1,s)}else n instanceof Float32Array&&t.uniformMatrix4fv(a,!1,n)}return!0},setUniformBySemantic:function(t,r,e){var n=this.attribSemantics[r];return n?this.setUniform(t,n.type,n.symbol,e):!1},enableAttributes:function(t,r,e){var n,i=this._cache.get("program"),a=this._cache.get("attriblocations");n=e?e.__enabledAttributeList:E[t.__GLID__],n||(n=e?e.__enabledAttributeList=[]:E[t.__GLID__]=[]);for(var s=[],o=0;r.length>o;o++){var u=r[o];if(this.attributeTemplates[u]){var c=a[u];if(void 0===c){if(c=t.getAttribLocation(i,u),-1===c){s[o]=-1;continue}a[u]=c}s[o]=c,n[c]=n[c]?T:v}else s[o]=-1}for(var o=0;n.length>o;o++)switch(n[o]){case v:t.enableVertexAttribArray(o),n[o]=p;break;case T:n[o]=p;break;case p:t.disableVertexAttribArray(o),n[o]=0}return s},_parseImport:function(){this._vertexProcessedNoDefine=A.parseImport(this.vertex),this._fragmentProcessedNoDefine=A.parseImport(this.fragment)},_addDefine:function(){var t=[];for(var r in this.lightNumber){var e=this.lightNumber[r];e>0&&t.push("#define "+r.toUpperCase()+"_NUMBER "+e)}for(var n in this._textureStatus){var i=this._textureStatus[n];i.enabled&&t.push("#define "+n.toUpperCase()+"_ENABLED")}for(var n in this.vertexDefines){var a=this.vertexDefines[n];t.push(null===a?"#define "+n:"#define "+n+" "+a)}this._vertexProcessed=t.join("\n")+"\n"+this._vertexProcessedNoDefine,t=[];for(var r in this.lightNumber){var e=this.lightNumber[r];e>0&&t.push("#define "+r.toUpperCase()+"_NUMBER "+e)}for(var n in this._textureStatus){var i=this._textureStatus[n];i.enabled&&t.push("#define "+n.toUpperCase()+"_ENABLED")}for(var n in this.fragmentDefines){var a=this.fragmentDefines[n];t.push(null===a?"#define "+n:"#define "+n+" "+a)}var s=t.join("\n")+"\n"+this._fragmentProcessedNoDefine;this._fragmentProcessed=["precision",this.precision,"float"].join(" ")+";\n"+s},_parseUniforms:function(){function t(t,i,a,s,o,u){if(i&&a){var c,_=l[i],h=!0;if(_){if(e._uniformList.push(a),("sampler2D"===i||"samplerCube"===i)&&(e._textureStatus[a]={enabled:!1,shaderType:n}),s&&(_+="v"),u)if(y.indexOf(u)>=0)e.attribSemantics[u]={symbol:a,type:_},h=!1;else if(m.indexOf(u)>=0){var f=!1,E=u;u.match(/TRANSPOSE$/)&&(f=!0,E=u.slice(0,-9)),e.matrixSemantics[u]={symbol:a,type:_,isTranspose:f,semanticNoTranspose:E},h=!1}else if("unconfigurable"===u)h=!1;else{if(c=e._parseDefaultValue(i,u),!c)throw Error('Unkown semantic "'+u+'"');u=""}h&&(r[a]={type:_,value:s?d.array:c||d[i],semantic:u||null})}return["uniform",i,a,s].join(" ")+";\n"}}var r={},e=this,n="vertex";this._uniformList=[],this._vertexProcessedNoDefine=this._vertexProcessedNoDefine.replace(_,t),n="fragment",this._fragmentProcessedNoDefine=this._fragmentProcessedNoDefine.replace(_,t),e.matrixSemanticKeys=Object.keys(this.matrixSemantics),this.uniformTemplates=r},_parseDefaultValue:function(t,r){var e=/\[\s*(.*)\s*\]/;if("vec2"!==t&&"vec3"!==t&&"vec4"!==t)return"bool"===t?function(){return"true"===r.toLowerCase()?!0:!1}:"float"===t?function(){return parseFloat(r)}:void 0;var n=e.exec(r)[1];if(n){var i=n.split(/\s*,\s*/);return function(){return new Float32Array(i)}}},createUniforms:function(){var t={};for(var r in this.uniformTemplates){var e=this.uniformTemplates[r];t[r]={type:e.type,value:e.value()}}return t},attached:function(){this._attacheMaterialNumber++},detached:function(){this._attacheMaterialNumber--},isAttachedToAny:function(){return 0!==this._attacheMaterialNumber},_parseAttributes:function(){function t(t,n,i,a,s){if(n&&i){var o=1;switch(n){case"vec4":o=4;break;case"vec3":o=3;break;case"vec2":o=2;break;case"float":o=1}if(r[i]={type:"float",size:o,semantic:s||null},s){if(0>y.indexOf(s))throw Error('Unkown semantic "'+s+'"');e.attribSemantics[s]={symbol:i,type:n}}}return["attribute",n,i].join(" ")+";\n"}var r={},e=this;this._vertexProcessedNoDefine=this._vertexProcessedNoDefine.replace(h,t),this.attributeTemplates=r},_parseDefines:function(){function t(t,n,i){var a="vertex"===e?r.vertexDefines:r.fragmentDefines;return a[n]||(a[n]="false"==i?!1:"true"==i?!0:i?parseFloat(i):null),""}var r=this,e="vertex";this._vertexProcessedNoDefine=this._vertexProcessedNoDefine.replace(f,t),e="fragment",this._fragmentProcessedNoDefine=this._fragmentProcessedNoDefine.replace(f,t)},_buildProgram:function(t,r,e){this._cache.get("program")&&t.deleteProgram(this._cache.get("program"));var n=t.createProgram(),i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,r),t.compileShader(i);var a=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,e),t.compileShader(a);var s=this._checkShaderErrorMsg(t,i,r);if(s)return s;if(s=this._checkShaderErrorMsg(t,a,e))return s;if(t.attachShader(n,i),t.attachShader(n,a),this.attribSemantics.POSITION)t.bindAttribLocation(n,0,this.attribSemantics.POSITION.symbol);else{var o=Object.keys(this.attributeTemplates);t.bindAttribLocation(n,0,o[0])}if(t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))return"Could not link program\nVALIDATE_STATUS: "+t.getProgramParameter(n,t.VALIDATE_STATUS)+", gl error ["+t.getError()+"]";for(var u=0;this._uniformList.length>u;u++){var c=this._uniformList[u],_=this._cache.get("locations");_[c]=t.getUniformLocation(n,c)}t.deleteShader(i),t.deleteShader(a),this._cache.put("program",n)},_checkShaderErrorMsg:function(t,r,n){return t.getShaderParameter(r,t.COMPILE_STATUS)?void 0:[t.getShaderInfoLog(r),e(n)].join("\n")},clone:function(){var t=new A({vertex:this.vertex,fragment:this.fragment,vertexDefines:i.clone(this.vertexDefines),fragmentDefines:i.clone(this.fragmentDefines)});for(var r in this._textureStatus)t._textureStatus[r]=i.clone(this._textureStatus[r]);return t},dispose:function(t){this._cache.use(t.__GLID__);var r=this._cache.get("program");r&&t.deleteProgram(r),this._cache.deleteContext(t.__GLID__),this._locations={}}}),R=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;A.parseImport=function(t){return t=t.replace(R,function(t,r,e){var t=A.source(e);return t?A.parseImport(t):(console.warn('Shader chunk "'+e+'" not existed in library'),"")})};var g=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;return A["import"]=function(t){t.replace(g,function(t,r,e,n){var n=n.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(n){for(var i,a=e.split("."),s=A.codes,o=0;a.length-1>o;)i=a[o++],s[i]||(s[i]={}),s=s[i];i=a[o],s[i]=n}return n})},A.codes={},A.source=function(t){for(var r=t.split("."),e=A.codes,n=0;e&&r.length>n;){var i=r[n++];e=e[i]}return e?e:void console.warn('Shader "'+t+'" not existed in library')},A}),define("qtek/Texture2D",["require","./Texture","./core/glinfo","./core/glenum"],function(t){var r=t("./Texture"),e=t("./core/glinfo"),n=t("./core/glenum"),i=r.derive(function(){return{image:null,pixels:null,mipmaps:[]}},{update:function(t){t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.beforeUpdate(t);var r=this.format,i=this.type;t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter);var a=e.getExtension(t,"EXT_texture_filter_anisotropic");if(a&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===i){var s=e.getExtension(t,"OES_texture_half_float");s||(i=n.FLOAT)}if(this.mipmaps.length)for(var o=this.width,u=this.height,c=0;this.mipmaps.length>c;c++){var _=this.mipmaps[c];this._updateTextureData(t,_,c,o,u,r,i),o/=2,u/=2}else this._updateTextureData(t,this,0,this.width,this.height,r,i),this.useMipmap&&!this.NPOT&&t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},_updateTextureData:function(t,e,n,i,a,s,o){e.image?t.texImage2D(t.TEXTURE_2D,n,s,s,o,e.image):r.COMPRESSED_RGBA_S3TC_DXT5_EXT>=s&&s>=r.COMPRESSED_RGB_S3TC_DXT1_EXT?t.compressedTexImage2D(t.TEXTURE_2D,n,s,i,a,0,e.pixels):t.texImage2D(t.TEXTURE_2D,n,s,i,a,0,s,o,e.pixels)},generateMipmap:function(t){this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D))},isPowerOfTwo:function(){var t,r;return this.image?(t=this.image.width,r=this.image.height):(t=this.width,r=this.height),0===(t&t-1)&&0===(r&r-1)},isRenderable:function(){return this.image?"CANVAS"===this.image.nodeName||this.image.complete:this.width&&this.height},bind:function(t){t.bindTexture(t.TEXTURE_2D,this.getWebGLTexture(t))},unbind:function(t){t.bindTexture(t.TEXTURE_2D,null)},load:function(t){var r=new Image,e=this;return r.onload=function(){e.dirty(),e.trigger("success",e),r.onload=null},r.onerror=function(){e.trigger("error",e),r.onerror=null},r.src=t,this.image=r,this}});return i}),define("qtek/core/glenum",[],function(){return{DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444}}),define("echarts-x/util/shader/albedo.essl",function(){return"@export ecx.albedo.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec2 uvRepeat: [1, 1];\n\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 position: POSITION;\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n    v_Texcoord = texcoord * uvRepeat;\n\n    #ifdef VERTEX_COLOR\n    v_Color = a_Color;\n    #endif\n}\n\n@end\n\n@export ecx.albedo.fragment\n\nuniform sampler2D diffuseMap;\nuniform vec3 color : [1.0, 1.0, 1.0];\nuniform float alpha : 1.0;\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    gl_FragColor = vec4(color, alpha);\n    \n    #ifdef VERTEX_COLOR\n        gl_FragColor *= v_Color;\n    #endif\n    #ifdef DIFFUSEMAP_ENABLED\n        vec4 tex = texture2D(diffuseMap, v_Texcoord);\n        // Premultiplied alpha\n        #ifdef PREMULTIPLIED_ALPHA\n        tex.rgb /= tex.a;\n        #endif\n        gl_FragColor *= tex;\n    #endif\n}\n@end"
}),define("echarts-x/util/shader/points.essl",function(){return"@export ecx.points.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float elapsedTime : 0;\n\nattribute vec3 position : POSITION;\nattribute vec4 color : COLOR;\nattribute float size;\n\n#ifdef ANIMATING\nattribute float delay;\n#endif\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    #ifdef ANIMATING\n        gl_PointSize = size * (sin((elapsedTime + delay) * 3.14) * 0.5 + 1.0);\n    #else\n        gl_PointSize = size;\n    #endif\n\n    v_Color = color;\n}\n\n@end\n\n@export ecx.points.fragment\n\nvarying vec4 v_Color;\nuniform sampler2D sprite;\n\nvoid main()\n{\n    vec4 color = v_Color;\n\n    #ifdef SPRITE_ENABLED\n        color *= texture2D(sprite, gl_PointCoord);\n    #endif\n\n    gl_FragColor = color;\n}\n@end"}),define("echarts-x/util/shader/curveAnimatingPoints.essl",function(){return"@export ecx.curveAnimatingPoints.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float percent : 0.0;\nuniform float pointSize : 2.0;\n\nattribute vec3 p0;\nattribute vec3 p1;\nattribute vec3 p2;\nattribute vec3 p3;\nattribute vec4 color : COLOR;\n\nattribute float offset;\nattribute float size;\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    float t = mod(offset + percent, 1.0);\n    float onet = 1.0 - t;\n    vec3 position = onet * onet * (onet * p0 + 3.0 * t * p1)\n        + t * t * (t * p3 + 3.0 * onet * p2);\n\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    gl_PointSize = pointSize * size;\n\n    v_Color = color;\n}\n\n@end\n\n@export ecx.curveAnimatingPoints.fragment\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    gl_FragColor = v_Color;\n}\n@end"}),define("echarts-x/util/shader/vectorFieldParticle.essl",function(){return"@export ecx.vfParticle.particle.fragment\n\nuniform sampler2D particleTexture;\nuniform sampler2D spawnTexture;\nuniform sampler2D velocityTexture;\n\nuniform float deltaTime;\nuniform float elapsedTime;\n\nuniform float speedScaling : 1.0;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    vec4 p = texture2D(particleTexture, v_Texcoord);\n    if (p.w > 0.0) {\n        vec4 vTex = texture2D(velocityTexture, p.xy);\n        vec2 v = vTex.xy;\n        v = (v - 0.5) * 2.0;\n        p.z = length(v);\n        p.xy += v * deltaTime / 50.0 * speedScaling;\n        // Make the particle surface seamless \n        p.xy = fract(p.xy);\n        p.w -= deltaTime;\n    }\n    else {\n        p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));\n        p.z = 0.0;\n    }\n    gl_FragColor = p;\n}\n@end\n\n@export ecx.vfParticle.renderPoints.vertex\n\n#define PI 3.1415926\n\nattribute vec2 texcoord : TEXCOORD_0;\n\nuniform sampler2D particleTexture;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nuniform float sizeScaling : 1.0;\n\nvoid main()\n{\n    vec4 p = texture2D(particleTexture, texcoord);\n\n    if (p.w > 0.0) {\n        gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);\n    }\n    else {\n        gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);\n    }\n\n    gl_PointSize = sizeScaling * p.z;\n}\n\n@end\n\n@export ecx.vfParticle.renderPoints.fragment\n\nuniform sampler2D spriteTexture;\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvoid main()\n{\n    gl_FragColor = color * texture2D(spriteTexture, gl_PointCoord);\n}\n\n@end\n"}),define("echarts-x/util/shader/lambert.essl",function(){return"/**\n * http://en.wikipedia.org/wiki/Lambertian_reflectance\n */\n\n@export ecx.lambert.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;\nuniform mat4 world : WORLD;\n\nuniform vec2 uvRepeat : [1.0, 1.0];\nuniform vec2 uvOffset : [0.0, 0.0];\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 normal : NORMAL;\n\nvarying vec2 v_Texcoord;\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    v_Texcoord = texcoord * uvRepeat + uvOffset;\n\n    v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);\n    v_WorldPosition = (world * vec4(position, 1.0)).xyz;\n}\n\n@end\n\n\n@export ecx.lambert.fragment\n\n#define PI 3.14159265358979\n\n#extension GL_OES_standard_derivatives : enable\n\nvarying vec2 v_Texcoord;\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\n#ifdef DIFFUSEMAP_ENABLED\nuniform sampler2D diffuseMap;\n#endif\n\n#ifdef BUMPMAP_ENABLED\nuniform sampler2D bumpMap;\nuniform float bumpScale : 1.0;\n// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n//  http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\nvec3 perturbNormalArb(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)\n{\n    vec2 dSTdx = dFdx(v_Texcoord);\n    vec2 dSTdy = dFdy(v_Texcoord);\n\n    float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;\n    float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;\n    float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;\n\n    vec3 vSigmaX = dFdx(surfPos);\n    vec3 vSigmaY = dFdy(surfPos);\n    vec3 vN = surfNormal;\n\n    vec3 R1 = cross(vSigmaY, vN);\n    vec3 R2 = cross(vN, vSigmaX);\n\n    float fDet = dot(vSigmaX, R1);\n\n    vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);\n    return normalize(abs(fDet) * baseNormal - vGrad);\n\n}\n#endif\n\nuniform vec3 color : [1.0, 1.0, 1.0];\nuniform float alpha : 1.0;\n\n#ifdef AMBIENT_LIGHT_NUMBER\n@import buildin.header.ambient_light\n#endif\n#ifdef DIRECTIONAL_LIGHT_NUMBER\n@import buildin.header.directional_light\n#endif\n\nvoid main()\n{\n#ifdef RENDER_TEXCOORD\n    gl_FragColor = vec4(v_Texcoord, 1.0, 1.0);\n    return;\n#endif\n\n    gl_FragColor = vec4(color, alpha);\n\n#ifdef DIFFUSEMAP_ENABLED\n    vec4 tex = texture2D(diffuseMap, v_Texcoord);\n    // Premultiplied alpha\n#ifdef PREMULTIPLIED_ALPHA\n    tex.rgb /= tex.a;\n#endif\n    gl_FragColor *= tex;\n#endif\n\n    vec3 N = v_Normal;\n    vec3 P = v_WorldPosition;\n    float ambientFactor = 1.0;\n#ifdef FLAT\n    // Map plane normal and position to sphere coordinates\n    float theta = (1.0 - v_Texcoord.y) * PI;\n    float phi = v_Texcoord.x * PI * 2.0;\n    float r0 = sin(theta);\n    N = vec3(-cos(phi) * r0, cos(theta), sin(phi) * r0);\n    P = N;\n#endif\n    \n#ifdef BUMPMAP_ENABLED\n    N = perturbNormalArb(v_WorldPosition, v_Normal, N);\n    #ifdef FLAT\n        ambientFactor = dot(P, N);\n    #else\n        ambientFactor = dot(v_Normal, N);\n    #endif\n#endif\n\nvec3 diffuseColor = vec3(0.0, 0.0, 0.0);\n\n#ifdef AMBIENT_LIGHT_NUMBER\n    for(int i = 0; i < AMBIENT_LIGHT_NUMBER; i++)\n    {\n        // Multiply a dot factor to make sure the bump detail can be seen \n        // in the dark side\n        diffuseColor += ambientLightColor[i] * ambientFactor;\n    }\n#endif\n#ifdef DIRECTIONAL_LIGHT_NUMBER\n    for(int i = 0; i < DIRECTIONAL_LIGHT_NUMBER; i++)\n    {\n        vec3 lightDirection = -directionalLightDirection[i];\n        vec3 lightColor = directionalLightColor[i];\n        \n        float ndl = dot(N, normalize(lightDirection));\n\n        float shadowContrib = 1.0;\n        #if defined(DIRECTIONAL_LIGHT_SHADOWMAP_NUMBER)\n            if(shadowEnabled)\n            {\n                shadowContrib = shadowContribs[i];\n            }\n        #endif\n\n        diffuseColor += lightColor * clamp(ndl, 0.0, 1.0) * shadowContrib;\n    }\n#endif\n\n    gl_FragColor.rgb *= diffuseColor;\n}\n\n@end"}),define("echarts-x/util/shader/motionBlur.essl",function(){return"@export ecx.motionBlur.fragment\n\nuniform sampler2D lastFrame;\nuniform sampler2D thisFrame;\n\nuniform float percent: 0.7;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    vec4 tex0 = texture2D(lastFrame, v_Texcoord);\n    vec4 tex1 = texture2D(thisFrame, v_Texcoord);\n\n    gl_FragColor = tex0 * percent + tex1;\n}\n\n@end"}),define("qtek/core/Base",["require","./mixin/derive","./mixin/notifier","./util"],function(t){"use strict";var r=t("./mixin/derive"),e=t("./mixin/notifier"),n=t("./util"),i=function(){this.__GUID__=n.genGUID()};return i.__initializers__=[function(t){n.extend(this,t)}],n.extend(i,r),n.extend(i.prototype,e),i}),define("qtek/math/Vector3",["require","../dep/glmatrix"],function(t){"use strict";function r(t,r,e){return r>t?r:t>e?e:t}var e=t("../dep/glmatrix"),n=e.vec3,i=function(t,r,e){t=t||0,r=r||0,e=e||0,this._array=n.fromValues(t,r,e),this._dirty=!0};if(i.prototype={constructor:i,add:function(t){return n.add(this._array,this._array,t._array),this._dirty=!0,this},set:function(t,r,e){return this._array[0]=t,this._array[1]=r,this._array[2]=e,this._dirty=!0,this},setArray:function(t){return this._array[0]=t[0],this._array[1]=t[1],this._array[2]=t[2],this._dirty=!0,this},clone:function(){return new i(this.x,this.y,this.z)},copy:function(t){return n.copy(this._array,t._array),this._dirty=!0,this},cross:function(t,r){return n.cross(this._array,t._array,r._array),this._dirty=!0,this},dist:function(t){return n.dist(this._array,t._array)},distance:function(t){return n.distance(this._array,t._array)},div:function(t){return n.div(this._array,this._array,t._array),this._dirty=!0,this},divide:function(t){return n.divide(this._array,this._array,t._array),this._dirty=!0,this},dot:function(t){return n.dot(this._array,t._array)},len:function(){return n.len(this._array)},length:function(){return n.length(this._array)},lerp:function(t,r,e){return n.lerp(this._array,t._array,r._array,e),this._dirty=!0,this},min:function(t){return n.min(this._array,this._array,t._array),this._dirty=!0,this},max:function(t){return n.max(this._array,this._array,t._array),this._dirty=!0,this},mul:function(t){return n.mul(this._array,this._array,t._array),this._dirty=!0,this},multiply:function(t){return n.multiply(this._array,this._array,t._array),this._dirty=!0,this},negate:function(){return n.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return n.normalize(this._array,this._array),this._dirty=!0,this},random:function(t){return n.random(this._array,t),this._dirty=!0,this},scale:function(t){return n.scale(this._array,this._array,t),this._dirty=!0,this},scaleAndAdd:function(t,r){return n.scaleAndAdd(this._array,this._array,t._array,r),this._dirty=!0,this},sqrDist:function(t){return n.sqrDist(this._array,t._array)},squaredDistance:function(t){return n.squaredDistance(this._array,t._array)},sqrLen:function(){return n.sqrLen(this._array)},squaredLength:function(){return n.squaredLength(this._array)},sub:function(t){return n.sub(this._array,this._array,t._array),this._dirty=!0,this},subtract:function(t){return n.subtract(this._array,this._array,t._array),this._dirty=!0,this},transformMat3:function(t){return n.transformMat3(this._array,this._array,t._array),this._dirty=!0,this},transformMat4:function(t){return n.transformMat4(this._array,this._array,t._array),this._dirty=!0,this},transformQuat:function(t){return n.transformQuat(this._array,this._array,t._array),this._dirty=!0,this},applyProjection:function(t){var r=this._array;if(t=t._array,0===t[15]){var e=-1/r[2];r[0]=t[0]*r[0]*e,r[1]=t[5]*r[1]*e,r[2]=(t[10]*r[2]+t[14])*e}else r[0]=t[0]*r[0]+t[12],r[1]=t[5]*r[1]+t[13],r[2]=t[10]*r[2]+t[14];return this._dirty=!0,this},eulerFromQuaternion:function(t,r){i.eulerFromQuaternion(this,t,r)},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var a=i.prototype;Object.defineProperty(a,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]=t,this._dirty=!0}}),Object.defineProperty(a,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]=t,this._dirty=!0}}),Object.defineProperty(a,"z",{get:function(){return this._array[2]},set:function(t){this._array[2]=t,this._dirty=!0}})}return i.add=function(t,r,e){return n.add(t._array,r._array,e._array),t._dirty=!0,t},i.set=function(t,r,e,i){n.set(t._array,r,e,i),t._dirty=!0},i.copy=function(t,r){return n.copy(t._array,r._array),t._dirty=!0,t},i.cross=function(t,r,e){return n.cross(t._array,r._array,e._array),t._dirty=!0,t},i.dist=function(t,r){return n.distance(t._array,r._array)},i.distance=i.dist,i.div=function(t,r,e){return n.divide(t._array,r._array,e._array),t._dirty=!0,t},i.divide=i.div,i.dot=function(t,r){return n.dot(t._array,r._array)},i.len=function(t){return n.length(t._array)},i.lerp=function(t,r,e,i){return n.lerp(t._array,r._array,e._array,i),t._dirty=!0,t},i.min=function(t,r,e){return n.min(t._array,r._array,e._array),t._dirty=!0,t},i.max=function(t,r,e){return n.max(t._array,r._array,e._array),t._dirty=!0,t},i.mul=function(t,r,e){return n.multiply(t._array,r._array,e._array),t._dirty=!0,t},i.multiply=i.mul,i.negate=function(t,r){return n.negate(t._array,r._array),t._dirty=!0,t},i.normalize=function(t,r){return n.normalize(t._array,r._array),t._dirty=!0,t},i.random=function(t,r){return n.random(t._array,r),t._dirty=!0,t},i.scale=function(t,r,e){return n.scale(t._array,r._array,e),t._dirty=!0,t},i.scaleAndAdd=function(t,r,e,i){return n.scaleAndAdd(t._array,r._array,e._array,i),t._dirty=!0,t},i.sqrDist=function(t,r){return n.sqrDist(t._array,r._array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(t){return n.sqrLen(t._array)},i.squaredLength=i.sqrLen,i.sub=function(t,r,e){return n.subtract(t._array,r._array,e._array),t._dirty=!0,t},i.subtract=i.sub,i.transformMat3=function(t,r,e){return n.transformMat3(t._array,r._array,e._array),t._dirty=!0,t},i.transformMat4=function(t,r,e){return n.transformMat4(t._array,r._array,e._array),t._dirty=!0,t},i.transformQuat=function(t,r,e){return n.transformQuat(t._array,r._array,e._array),t._dirty=!0,t},i.eulerFromQuaternion=function(t,e,n){t=t._array,e=e._array;var i=e[0],a=e[1],s=e[2],o=e[3],u=i*i,c=a*a,_=s*s,h=o*o,f=Math.atan2,l=Math.asin;switch(n&&n.toUpperCase()){case"YXZ":t[0]=l(r(2*(i*o-a*s),-1,1)),t[1]=f(2*(i*s+a*o),h-u-c+_),t[2]=f(2*(i*a+s*o),h-u+c-_);break;case"ZXY":t[0]=l(r(2*(i*o+a*s),-1,1)),t[1]=f(2*(a*o-s*i),h-u-c+_),t[2]=f(2*(s*o-i*a),h-u+c-_);break;case"ZYX":t[0]=f(2*(i*o+s*a),h-u-c+_),t[1]=l(r(2*(a*o-i*s),-1,1)),t[2]=f(2*(i*a+s*o),h+u-c-_);break;case"YZX":t[0]=f(2*(i*o-s*a),h-u+c-_),t[1]=f(2*(a*o-i*s),h+u-c-_),t[2]=l(r(2*(i*a+s*o),-1,1));break;case"XZY":t[0]=f(2*(i*o+a*s),h-u+c-_),t[1]=f(2*(i*s+a*o),h+u-c-_),t[2]=l(r(2*(s*o-i*a),-1,1));break;case"XYZ":default:t[0]=f(2*(i*o-a*s),h-u-c+_),t[1]=l(r(2*(i*s+a*o),-1,1)),t[2]=f(2*(s*o-i*a),h+u-c-_)}return t._dirty=!0,t},i.POSITIVE_X=new i(1,0,0),i.NEGATIVE_X=new i(-1,0,0),i.POSITIVE_Y=new i(0,1,0),i.NEGATIVE_Y=new i(0,-1,0),i.POSITIVE_Z=new i(0,0,1),i.NEGATIVE_Z=new i(0,0,-1),i.UP=new i(0,1,0),i.ZERO=new i(0,0,0),i}),define("qtek/math/Quaternion",["require","../dep/glmatrix"],function(t){"use strict";var r=t("../dep/glmatrix"),e=r.quat,n=function(t,r,n,i){t=t||0,r=r||0,n=n||0,i=void 0===i?1:i,this._array=e.fromValues(t,r,n,i),this._dirty=!0};if(n.prototype={constructor:n,add:function(t){return e.add(this._array,this._array,t._array),this._dirty=!0,this},calculateW:function(){return e.calculateW(this._array,this._array),this._dirty=!0,this},set:function(t,r,e,n){return this._array[0]=t,this._array[1]=r,this._array[2]=e,this._array[3]=n,this._dirty=!0,this},setArray:function(t){return this._array[0]=t[0],this._array[1]=t[1],this._array[2]=t[2],this._array[3]=t[3],this._dirty=!0,this},clone:function(){return new n(this.x,this.y,this.z,this.w)},conjugate:function(){return e.conjugate(this._array,this._array),this._dirty=!0,this},copy:function(t){return e.copy(this._array,t._array),this._dirty=!0,this},dot:function(t){return e.dot(this._array,t._array)},fromMat3:function(t){return e.fromMat3(this._array,t._array),this._dirty=!0,this},fromMat4:function(){var t=r.mat3,n=t.create();return function(r){return t.fromMat4(n,r._array),t.transpose(n,n),e.fromMat3(this._array,n),this._dirty=!0,this}}(),identity:function(){return e.identity(this._array),this._dirty=!0,this},invert:function(){return e.invert(this._array,this._array),this._dirty=!0,this},len:function(){return e.len(this._array)},length:function(){return e.length(this._array)},lerp:function(t,r,n){return e.lerp(this._array,t._array,r._array,n),this._dirty=!0,this},mul:function(t){return e.mul(this._array,this._array,t._array),this._dirty=!0,this},mulLeft:function(t){return e.multiply(this._array,t._array,this._array),this._dirty=!0,this},multiply:function(t){return e.multiply(this._array,this._array,t._array),this._dirty=!0,this},multiplyLeft:function(t){return e.multiply(this._array,t._array,this._array),this._dirty=!0,this},normalize:function(){return e.normalize(this._array,this._array),this._dirty=!0,this},rotateX:function(t){return e.rotateX(this._array,this._array,t),this._dirty=!0,this},rotateY:function(t){return e.rotateY(this._array,this._array,t),this._dirty=!0,this},rotateZ:function(t){return e.rotateZ(this._array,this._array,t),this._dirty=!0,this},rotationTo:function(t,r){return e.rotationTo(this._array,t._array,r._array),this._dirty=!0,this},setAxes:function(t,r,n){return e.setAxes(this._array,t._array,r._array,n._array),this._dirty=!0,this},setAxisAngle:function(t,r){return e.setAxisAngle(this._array,t._array,r),this._dirty=!0,this},slerp:function(t,r,n){return e.slerp(this._array,t._array,r._array,n),this._dirty=!0,this},sqrLen:function(){return e.sqrLen(this._array)},squaredLength:function(){return e.squaredLength(this._array)},setFromEuler:function(){},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var i=n.prototype;Object.defineProperty(i,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]=t,this._dirty=!0}}),Object.defineProperty(i,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]=t,this._dirty=!0}}),Object.defineProperty(i,"z",{get:function(){return this._array[2]},set:function(t){this._array[2]=t,this._dirty=!0}}),Object.defineProperty(i,"w",{get:function(){return this._array[3]},set:function(t){this._array[3]=t,this._dirty=!0}})}return n.add=function(t,r,n){return e.add(t._array,r._array,n._array),t._dirty=!0,t},n.set=function(t,r,n,i,a){e.set(t._array,r,n,i,a),t._dirty=!0},n.copy=function(t,r){return e.copy(t._array,r._array),t._dirty=!0,t},n.calculateW=function(t,r){return e.calculateW(t._array,r._array),t._dirty=!0,t},n.conjugate=function(t,r){return e.conjugate(t._array,r._array),t._dirty=!0,t},n.identity=function(t){return e.identity(t._array),t._dirty=!0,t},n.invert=function(t,r){return e.invert(t._array,r._array),t._dirty=!0,t},n.dot=function(t,r){return e.dot(t._array,r._array)},n.len=function(t){return e.length(t._array)},n.lerp=function(t,r,n,i){return e.lerp(t._array,r._array,n._array,i),t._dirty=!0,t},n.slerp=function(t,r,n,i){return e.slerp(t._array,r._array,n._array,i),t._dirty=!0,t},n.mul=function(t,r,n){return e.multiply(t._array,r._array,n._array),t._dirty=!0,t},n.multiply=n.mul,n.rotateX=function(t,r,n){return e.rotateX(t._array,r._array,n),t._dirty=!0,t},n.rotateY=function(t,r,n){return e.rotateY(t._array,r._array,n),t._dirty=!0,t},n.rotateZ=function(t,r,n){return e.rotateZ(t._array,r._array,n),t._dirty=!0,t},n.setAxisAngle=function(t,r,n){return e.setAxisAngle(t._array,r._array,n),t._dirty=!0,t},n.normalize=function(t,r){return e.normalize(t._array,r._array),t._dirty=!0,t},n.sqrLen=function(t){return e.sqrLen(t._array)},n.squaredLength=n.sqrLen,n.fromMat3=function(t,r){return e.fromMat3(t._array,r._array),t._dirty=!0,t},n.setAxes=function(t,r,n,i){return e.setAxes(t._array,r._array,n._array,i._array),t._dirty=!0,t},n.rotationTo=function(t,r,n){return e.rotationTo(t._array,r._array,n._array),t._dirty=!0,t},n}),define("qtek/math/Matrix4",["require","../dep/glmatrix","./Vector3"],function(t){"use strict";var r=t("../dep/glmatrix"),e=t("./Vector3"),n=r.mat4,i=r.vec3,a=r.mat3,s=r.quat,o=function(){this._axisX=new e,this._axisY=new e,this._axisZ=new e,this._array=n.create(),this._dirty=!0};if(o.prototype={constructor:o,adjoint:function(){return n.adjoint(this._array,this._array),this._dirty=!0,this},clone:function(){return(new o).copy(this)},copy:function(t){return n.copy(this._array,t._array),this._dirty=!0,this},determinant:function(){return n.determinant(this._array)},fromQuat:function(t){return n.fromQuat(this._array,t._array),this._dirty=!0,this},fromRotationTranslation:function(t,r){return n.fromRotationTranslation(this._array,t._array,r._array),this._dirty=!0,this},fromMat2d:function(t){return o.fromMat2d(this,t),this},frustum:function(t,r,e,i,a,s){return n.frustum(this._array,t,r,e,i,a,s),this._dirty=!0,this},identity:function(){return n.identity(this._array),this._dirty=!0,this},invert:function(){return n.invert(this._array,this._array),this._dirty=!0,this},lookAt:function(t,r,e){return n.lookAt(this._array,t._array,r._array,e._array),this._dirty=!0,this},mul:function(t){return n.mul(this._array,this._array,t._array),this._dirty=!0,this},mulLeft:function(t){return n.mul(this._array,t._array,this._array),this._dirty=!0,this},multiply:function(t){return n.multiply(this._array,this._array,t._array),this._dirty=!0,this},multiplyLeft:function(t){return n.multiply(this._array,t._array,this._array),this._dirty=!0,this},ortho:function(t,r,e,i,a,s){return n.ortho(this._array,t,r,e,i,a,s),this._dirty=!0,this},perspective:function(t,r,e,i){return n.perspective(this._array,t,r,e,i),this._dirty=!0,this},rotate:function(t,r){return n.rotate(this._array,this._array,t,r._array),this._dirty=!0,this},rotateX:function(t){return n.rotateX(this._array,this._array,t),this._dirty=!0,this},rotateY:function(t){return n.rotateY(this._array,this._array,t),this._dirty=!0,this},rotateZ:function(t){return n.rotateZ(this._array,this._array,t),this._dirty=!0,this},scale:function(t){return n.scale(this._array,this._array,t._array),this._dirty=!0,this},translate:function(t){return n.translate(this._array,this._array,t._array),this._dirty=!0,this},transpose:function(){return n.transpose(this._array,this._array),this._dirty=!0,this},decomposeMatrix:function(){var t=i.create(),r=i.create(),e=i.create(),n=a.create();return function(o,u,c){var _=this._array;i.set(t,_[0],_[1],_[2]),i.set(r,_[4],_[5],_[6]),i.set(e,_[8],_[9],_[10]);var h=i.length(t),f=i.length(r),l=i.length(e);o&&(o.x=h,o.y=f,o.z=l,o._dirty=!0),c.set(_[12],_[13],_[14]),a.fromMat4(n,_),a.transpose(n,n),n[0]/=h,n[1]/=h,n[2]/=h,n[3]/=f,n[4]/=f,n[5]/=f,n[6]/=l,n[7]/=l,n[8]/=l,s.fromMat3(u._array,n),s.normalize(u._array,u._array),u._dirty=!0,c._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var u=o.prototype;Object.defineProperty(u,"z",{get:function(){var t=this._array;return this._axisZ.set(t[8],t[9],t[10]),this._axisZ},set:function(t){var r=this._array;t=t._array,r[8]=t[0],r[9]=t[1],r[10]=t[2],this._dirty=!0}}),Object.defineProperty(u,"y",{get:function(){var t=this._array;return this._axisY.set(t[4],t[5],t[6]),this._axisY},set:function(t){var r=this._array;t=t._array,r[4]=t[0],r[5]=t[1],r[6]=t[2],this._dirty=!0}}),Object.defineProperty(u,"x",{get:function(){var t=this._array;return this._axisX.set(t[0],t[1],t[2]),this._axisX},set:function(t){var r=this._array;t=t._array,r[0]=t[0],r[1]=t[1],r[2]=t[2],this._dirty=!0}})}return o.adjoint=function(t,r){return n.adjoint(t._array,r._array),t._dirty=!0,t},o.copy=function(t,r){return n.copy(t._array,r._array),t._dirty=!0,t},o.determinant=function(t){return n.determinant(t._array)},o.identity=function(t){return n.identity(t._array),t._dirty=!0,t},o.ortho=function(t,r,e,i,a,s,o){return n.ortho(t._array,r,e,i,a,s,o),t._dirty=!0,t},o.perspective=function(t,r,e,i,a){return n.perspective(t._array,r,e,i,a),t._dirty=!0,t},o.lookAt=function(t,r,e,i){return n.lookAt(t._array,r._array,e._array,i._array),t._dirty=!0,t},o.invert=function(t,r){return n.invert(t._array,r._array),t._dirty=!0,t},o.mul=function(t,r,e){return n.mul(t._array,r._array,e._array),t._dirty=!0,t},o.multiply=o.mul,o.fromQuat=function(t,r){return n.fromQuat(t._array,r._array),t._dirty=!0,t},o.fromRotationTranslation=function(t,r,e){return n.fromRotationTranslation(t._array,r._array,e._array),t._dirty=!0,t},o.fromMat2d=function(t,r){t._dirty=!0;var r=r._array,t=t._array;return t[0]=r[0],t[4]=r[2],t[12]=r[4],t[1]=r[1],t[5]=r[3],t[13]=r[5],t},o.rotate=function(t,r,e,i){return n.rotate(t._array,r._array,e,i._array),t._dirty=!0,t},o.rotateX=function(t,r,e){return n.rotateX(t._array,r._array,e),t._dirty=!0,t},o.rotateY=function(t,r,e){return n.rotateY(t._array,r._array,e),t._dirty=!0,t},o.rotateZ=function(t,r,e){return n.rotateZ(t._array,r._array,e),t._dirty=!0,t},o.scale=function(t,r,e){return n.scale(t._array,r._array,e._array),t._dirty=!0,t},o.transpose=function(t,r){return n.transpose(t._array,r._array),t._dirty=!0,t},o.translate=function(t,r,e){return n.translate(t._array,r._array,e._array),t._dirty=!0,t},o}),function(t){"use strict";var r={};"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(r.exports={},define("qtek/dep/glmatrix",[],function(){return r.exports})):r.exports="undefined"!=typeof window?window:t:r.exports=exports,function(t){if(!r)var r=1e-6;if(!e)var e="undefined"!=typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var i={};i.setMatrixArrayType=function(t){e=t},void 0!==t&&(t.glMatrix=i);var a=Math.PI/180;i.toRadian=function(t){return t*a};var s={};s.create=function(){var t=new e(2);return t[0]=0,t[1]=0,t},s.clone=function(t){var r=new e(2);return r[0]=t[0],r[1]=t[1],r},s.fromValues=function(t,r){var n=new e(2);return n[0]=t,n[1]=r,n},s.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t},s.set=function(t,r,e){return t[0]=r,t[1]=e,t},s.add=function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t},s.subtract=function(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t},s.sub=s.subtract,s.multiply=function(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t},s.mul=s.multiply,s.divide=function(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t},s.div=s.divide,s.min=function(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t},s.max=function(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t},s.scale=function(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t},s.scaleAndAdd=function(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t},s.distance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1];return Math.sqrt(e*e+n*n)},s.dist=s.distance,s.squaredDistance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1];return e*e+n*n},s.sqrDist=s.squaredDistance,s.length=function(t){var r=t[0],e=t[1];return Math.sqrt(r*r+e*e)},s.len=s.length,s.squaredLength=function(t){var r=t[0],e=t[1];return r*r+e*e},s.sqrLen=s.squaredLength,s.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t},s.normalize=function(t,r){var e=r[0],n=r[1],i=e*e+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=r[0]*i,t[1]=r[1]*i),t},s.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]},s.cross=function(t,r,e){var n=r[0]*e[1]-r[1]*e[0];return t[0]=t[1]=0,t[2]=n,t},s.lerp=function(t,r,e,n){var i=r[0],a=r[1];return t[0]=i+n*(e[0]-i),t[1]=a+n*(e[1]-a),t},s.random=function(t,r){r=r||1;var e=2*n()*Math.PI;return t[0]=Math.cos(e)*r,t[1]=Math.sin(e)*r,t},s.transformMat2=function(t,r,e){var n=r[0],i=r[1];return t[0]=e[0]*n+e[2]*i,t[1]=e[1]*n+e[3]*i,t},s.transformMat2d=function(t,r,e){var n=r[0],i=r[1];return t[0]=e[0]*n+e[2]*i+e[4],t[1]=e[1]*n+e[3]*i+e[5],t},s.transformMat3=function(t,r,e){var n=r[0],i=r[1];return t[0]=e[0]*n+e[3]*i+e[6],t[1]=e[1]*n+e[4]*i+e[7],t},s.transformMat4=function(t,r,e){var n=r[0],i=r[1];return t[0]=e[0]*n+e[4]*i+e[12],t[1]=e[1]*n+e[5]*i+e[13],t},s.forEach=function(){var t=s.create();return function(r,e,n,i,a,s){var o,u;for(e||(e=2),n||(n=0),u=i?Math.min(i*e+n,r.length):r.length,o=n;u>o;o+=e)t[0]=r[o],t[1]=r[o+1],a(t,t,s),r[o]=t[0],r[o+1]=t[1];return r}}(),s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},void 0!==t&&(t.vec2=s);var o={};o.create=function(){var t=new e(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var r=new e(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},o.fromValues=function(t,r,n){var i=new e(3);return i[0]=t,i[1]=r,i[2]=n,i},o.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},o.set=function(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t},o.add=function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t},o.subtract=function(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t},o.sub=o.subtract,o.multiply=function(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t},o.mul=o.multiply,o.divide=function(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t},o.div=o.divide,o.min=function(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t},o.max=function(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t},o.scale=function(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t},o.scaleAndAdd=function(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t},o.distance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],i=r[2]-t[2];return Math.sqrt(e*e+n*n+i*i)},o.dist=o.distance,o.squaredDistance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],i=r[2]-t[2];return e*e+n*n+i*i},o.sqrDist=o.squaredDistance,o.length=function(t){var r=t[0],e=t[1],n=t[2];return Math.sqrt(r*r+e*e+n*n)},o.len=o.length,o.squaredLength=function(t){var r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t},o.normalize=function(t,r){var e=r[0],n=r[1],i=r[2],a=e*e+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a),t},o.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},o.cross=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=e[0],o=e[1],u=e[2];return t[0]=i*u-a*o,t[1]=a*s-n*u,t[2]=n*o-i*s,t},o.lerp=function(t,r,e,n){var i=r[0],a=r[1],s=r[2];return t[0]=i+n*(e[0]-i),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t},o.random=function(t,r){r=r||1;var e=2*n()*Math.PI,i=2*n()-1,a=Math.sqrt(1-i*i)*r;return t[0]=Math.cos(e)*a,t[1]=Math.sin(e)*a,t[2]=i*r,t},o.transformMat4=function(t,r,e){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n+e[4]*i+e[8]*a+e[12],t[1]=e[1]*n+e[5]*i+e[9]*a+e[13],t[2]=e[2]*n+e[6]*i+e[10]*a+e[14],t},o.transformMat3=function(t,r,e){var n=r[0],i=r[1],a=r[2];return t[0]=n*e[0]+i*e[3]+a*e[6],t[1]=n*e[1]+i*e[4]+a*e[7],t[2]=n*e[2]+i*e[5]+a*e[8],t},o.transformQuat=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=e[0],o=e[1],u=e[2],c=e[3],_=c*n+o*a-u*i,h=c*i+u*n-s*a,f=c*a+s*i-o*n,l=-s*n-o*i-u*a;return t[0]=_*c+l*-s+h*-u-f*-o,t[1]=h*c+l*-o+f*-s-_*-u,t[2]=f*c+l*-u+_*-o-h*-s,t},o.forEach=function(){var t=o.create();return function(r,e,n,i,a,s){var o,u;for(e||(e=3),n||(n=0),u=i?Math.min(i*e+n,r.length):r.length,o=n;u>o;o+=e)t[0]=r[o],t[1]=r[o+1],t[2]=r[o+2],a(t,t,s),r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2];return r}}(),o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},void 0!==t&&(t.vec3=o);var u={};u.create=function(){var t=new e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var r=new e(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},u.fromValues=function(t,r,n,i){var a=new e(4);return a[0]=t,a[1]=r,a[2]=n,a[3]=i,a},u.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},u.set=function(t,r,e,n,i){return t[0]=r,t[1]=e,t[2]=n,t[3]=i,t},u.add=function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t},u.subtract=function(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t},u.sub=u.subtract,u.multiply=function(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t[3]=r[3]*e[3],t},u.mul=u.multiply,u.divide=function(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t[3]=r[3]/e[3],t},u.div=u.divide,u.min=function(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t[3]=Math.min(r[3],e[3]),t},u.max=function(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t[3]=Math.max(r[3],e[3]),t
},u.scale=function(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t},u.scaleAndAdd=function(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t},u.distance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],i=r[2]-t[2],a=r[3]-t[3];return Math.sqrt(e*e+n*n+i*i+a*a)},u.dist=u.distance,u.squaredDistance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],i=r[2]-t[2],a=r[3]-t[3];return e*e+n*n+i*i+a*a},u.sqrDist=u.squaredDistance,u.length=function(t){var r=t[0],e=t[1],n=t[2],i=t[3];return Math.sqrt(r*r+e*e+n*n+i*i)},u.len=u.length,u.squaredLength=function(t){var r=t[0],e=t[1],n=t[2],i=t[3];return r*r+e*e+n*n+i*i},u.sqrLen=u.squaredLength,u.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t},u.normalize=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=e*e+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s),t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t[3]=r[3]*s),t},u.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]},u.lerp=function(t,r,e,n){var i=r[0],a=r[1],s=r[2],o=r[3];return t[0]=i+n*(e[0]-i),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t[3]=o+n*(e[3]-o),t},u.random=function(t,r){return r=r||1,t[0]=n(),t[1]=n(),t[2]=n(),t[3]=n(),u.normalize(t,t),u.scale(t,t,r),t},u.transformMat4=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3];return t[0]=e[0]*n+e[4]*i+e[8]*a+e[12]*s,t[1]=e[1]*n+e[5]*i+e[9]*a+e[13]*s,t[2]=e[2]*n+e[6]*i+e[10]*a+e[14]*s,t[3]=e[3]*n+e[7]*i+e[11]*a+e[15]*s,t},u.transformQuat=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=e[0],o=e[1],u=e[2],c=e[3],_=c*n+o*a-u*i,h=c*i+u*n-s*a,f=c*a+s*i-o*n,l=-s*n-o*i-u*a;return t[0]=_*c+l*-s+h*-u-f*-o,t[1]=h*c+l*-o+f*-s-_*-u,t[2]=f*c+l*-u+_*-o-h*-s,t},u.forEach=function(){var t=u.create();return function(r,e,n,i,a,s){var o,u;for(e||(e=4),n||(n=0),u=i?Math.min(i*e+n,r.length):r.length,o=n;u>o;o+=e)t[0]=r[o],t[1]=r[o+1],t[2]=r[o+2],t[3]=r[o+3],a(t,t,s),r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2],r[o+3]=t[3];return r}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.vec4=u);var c={};c.create=function(){var t=new e(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.clone=function(t){var r=new e(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},c.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.transpose=function(t,r){if(t===r){var e=r[1];t[1]=r[2],t[2]=e}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t},c.invert=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=e*a-i*n;return s?(s=1/s,t[0]=a*s,t[1]=-n*s,t[2]=-i*s,t[3]=e*s,t):null},c.adjoint=function(t,r){var e=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=e,t},c.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},c.multiply=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1],c=e[2],_=e[3];return t[0]=n*o+i*c,t[1]=n*u+i*_,t[2]=a*o+s*c,t[3]=a*u+s*_,t},c.mul=c.multiply,c.rotate=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=Math.sin(e),u=Math.cos(e);return t[0]=n*u+i*o,t[1]=n*-o+i*u,t[2]=a*u+s*o,t[3]=a*-o+s*u,t},c.scale=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1];return t[0]=n*o,t[1]=i*u,t[2]=a*o,t[3]=s*u,t},c.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.mat2=c);var _={};_.create=function(){var t=new e(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},_.clone=function(t){var r=new e(6);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},_.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},_.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},_.invert=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=e*a-n*i;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-i*u,t[3]=e*u,t[4]=(i*o-a*s)*u,t[5]=(n*s-e*o)*u,t):null},_.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},_.multiply=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=e[0],_=e[1],h=e[2],f=e[3],l=e[4],d=e[5];return t[0]=n*c+i*h,t[1]=n*_+i*f,t[2]=a*c+s*h,t[3]=a*_+s*f,t[4]=c*o+h*u+l,t[5]=_*o+f*u+d,t},_.mul=_.multiply,_.rotate=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=Math.sin(e),_=Math.cos(e);return t[0]=n*_+i*c,t[1]=-n*c+i*_,t[2]=a*_+s*c,t[3]=-a*c+_*s,t[4]=_*o+c*u,t[5]=_*u-c*o,t},_.scale=function(t,r,e){var n=e[0],i=e[1];return t[0]=r[0]*n,t[1]=r[1]*i,t[2]=r[2]*n,t[3]=r[3]*i,t[4]=r[4]*n,t[5]=r[5]*i,t},_.translate=function(t,r,e){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4]+e[0],t[5]=r[5]+e[1],t},_.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},void 0!==t&&(t.mat2d=_);var h={};h.create=function(){var t=new e(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.fromMat4=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t},h.clone=function(t){var r=new e(9);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},h.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.transpose=function(t,r){if(t===r){var e=r[1],n=r[2],i=r[5];t[1]=r[3],t[2]=r[6],t[3]=e,t[5]=r[7],t[6]=n,t[7]=i}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t},h.invert=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=r[6],c=r[7],_=r[8],h=_*s-o*c,f=-_*a+o*u,l=c*a-s*u,d=e*h+n*f+i*l;return d?(d=1/d,t[0]=h*d,t[1]=(-_*n+i*c)*d,t[2]=(o*n-i*s)*d,t[3]=f*d,t[4]=(_*e-i*u)*d,t[5]=(-o*e+i*a)*d,t[6]=l*d,t[7]=(-c*e+n*u)*d,t[8]=(s*e-n*a)*d,t):null},h.adjoint=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=r[6],c=r[7],_=r[8];return t[0]=s*_-o*c,t[1]=i*c-n*_,t[2]=n*o-i*s,t[3]=o*u-a*_,t[4]=e*_-i*u,t[5]=i*a-e*o,t[6]=a*c-s*u,t[7]=n*u-e*c,t[8]=e*s-n*a,t},h.determinant=function(t){var r=t[0],e=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],c=t[8];return r*(c*a-s*u)+e*(-c*i+s*o)+n*(u*i-a*o)},h.multiply=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=r[6],_=r[7],h=r[8],f=e[0],l=e[1],d=e[2],y=e[3],m=e[4],E=e[5],v=e[6],T=e[7],p=e[8];return t[0]=f*n+l*s+d*c,t[1]=f*i+l*o+d*_,t[2]=f*a+l*u+d*h,t[3]=y*n+m*s+E*c,t[4]=y*i+m*o+E*_,t[5]=y*a+m*u+E*h,t[6]=v*n+T*s+p*c,t[7]=v*i+T*o+p*_,t[8]=v*a+T*u+p*h,t},h.mul=h.multiply,h.translate=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=r[6],_=r[7],h=r[8],f=e[0],l=e[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=u,t[6]=f*n+l*s+c,t[7]=f*i+l*o+_,t[8]=f*a+l*u+h,t},h.rotate=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=r[6],_=r[7],h=r[8],f=Math.sin(e),l=Math.cos(e);return t[0]=l*n+f*s,t[1]=l*i+f*o,t[2]=l*a+f*u,t[3]=l*s-f*n,t[4]=l*o-f*i,t[5]=l*u-f*a,t[6]=c,t[7]=_,t[8]=h,t},h.scale=function(t,r,e){var n=e[0],i=e[1];return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=i*r[3],t[4]=i*r[4],t[5]=i*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},h.fromMat2d=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t},h.fromQuat=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=e+e,o=n+n,u=i+i,c=e*s,_=n*s,h=n*o,f=i*s,l=i*o,d=i*u,y=a*s,m=a*o,E=a*u;return t[0]=1-h-d,t[3]=_-E,t[6]=f+m,t[1]=_+E,t[4]=1-c-d,t[7]=l-y,t[2]=f-m,t[5]=l+y,t[8]=1-c-h,t},h.normalFromMat4=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=r[6],c=r[7],_=r[8],h=r[9],f=r[10],l=r[11],d=r[12],y=r[13],m=r[14],E=r[15],v=e*o-n*s,T=e*u-i*s,p=e*c-a*s,A=n*u-i*o,R=n*c-a*o,g=i*c-a*u,N=_*y-h*d,I=_*m-f*d,b=_*E-l*d,S=h*m-f*y,x=h*E-l*y,L=f*E-l*m,O=v*L-T*x+p*S+A*b-R*I+g*N;return O?(O=1/O,t[0]=(o*L-u*x+c*S)*O,t[1]=(u*b-s*L-c*I)*O,t[2]=(s*x-o*b+c*N)*O,t[3]=(i*x-n*L-a*S)*O,t[4]=(e*L-i*b+a*I)*O,t[5]=(n*b-e*x-a*N)*O,t[6]=(y*g-m*R+E*A)*O,t[7]=(m*p-d*g-E*T)*O,t[8]=(d*R-y*p+E*v)*O,t):null},h.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},void 0!==t&&(t.mat3=h);var f={};f.create=function(){var t=new e(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.clone=function(t){var r=new e(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},f.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.transpose=function(t,r){if(t===r){var e=r[1],n=r[2],i=r[3],a=r[6],s=r[7],o=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=a,t[11]=r[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t},f.invert=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=r[6],c=r[7],_=r[8],h=r[9],f=r[10],l=r[11],d=r[12],y=r[13],m=r[14],E=r[15],v=e*o-n*s,T=e*u-i*s,p=e*c-a*s,A=n*u-i*o,R=n*c-a*o,g=i*c-a*u,N=_*y-h*d,I=_*m-f*d,b=_*E-l*d,S=h*m-f*y,x=h*E-l*y,L=f*E-l*m,O=v*L-T*x+p*S+A*b-R*I+g*N;return O?(O=1/O,t[0]=(o*L-u*x+c*S)*O,t[1]=(i*x-n*L-a*S)*O,t[2]=(y*g-m*R+E*A)*O,t[3]=(f*R-h*g-l*A)*O,t[4]=(u*b-s*L-c*I)*O,t[5]=(e*L-i*b+a*I)*O,t[6]=(m*p-d*g-E*T)*O,t[7]=(_*g-f*p+l*T)*O,t[8]=(s*x-o*b+c*N)*O,t[9]=(n*b-e*x-a*N)*O,t[10]=(d*R-y*p+E*v)*O,t[11]=(h*p-_*R-l*v)*O,t[12]=(o*I-s*S-u*N)*O,t[13]=(e*S-n*I+i*N)*O,t[14]=(y*T-d*A-m*v)*O,t[15]=(_*A-h*T+f*v)*O,t):null},f.adjoint=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=r[6],c=r[7],_=r[8],h=r[9],f=r[10],l=r[11],d=r[12],y=r[13],m=r[14],E=r[15];return t[0]=o*(f*E-l*m)-h*(u*E-c*m)+y*(u*l-c*f),t[1]=-(n*(f*E-l*m)-h*(i*E-a*m)+y*(i*l-a*f)),t[2]=n*(u*E-c*m)-o*(i*E-a*m)+y*(i*c-a*u),t[3]=-(n*(u*l-c*f)-o*(i*l-a*f)+h*(i*c-a*u)),t[4]=-(s*(f*E-l*m)-_*(u*E-c*m)+d*(u*l-c*f)),t[5]=e*(f*E-l*m)-_*(i*E-a*m)+d*(i*l-a*f),t[6]=-(e*(u*E-c*m)-s*(i*E-a*m)+d*(i*c-a*u)),t[7]=e*(u*l-c*f)-s*(i*l-a*f)+_*(i*c-a*u),t[8]=s*(h*E-l*y)-_*(o*E-c*y)+d*(o*l-c*h),t[9]=-(e*(h*E-l*y)-_*(n*E-a*y)+d*(n*l-a*h)),t[10]=e*(o*E-c*y)-s*(n*E-a*y)+d*(n*c-a*o),t[11]=-(e*(o*l-c*h)-s*(n*l-a*h)+_*(n*c-a*o)),t[12]=-(s*(h*m-f*y)-_*(o*m-u*y)+d*(o*f-u*h)),t[13]=e*(h*m-f*y)-_*(n*m-i*y)+d*(n*f-i*h),t[14]=-(e*(o*m-u*y)-s*(n*m-i*y)+d*(n*u-i*o)),t[15]=e*(o*f-u*h)-s*(n*f-i*h)+_*(n*u-i*o),t},f.determinant=function(t){var r=t[0],e=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],c=t[8],_=t[9],h=t[10],f=t[11],l=t[12],d=t[13],y=t[14],m=t[15],E=r*s-e*a,v=r*o-n*a,T=r*u-i*a,p=e*o-n*s,A=e*u-i*s,R=n*u-i*o,g=c*d-_*l,N=c*y-h*l,I=c*m-f*l,b=_*y-h*d,S=_*m-f*d,x=h*m-f*y;return E*x-v*S+T*b+p*I-A*N+R*g},f.multiply=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=r[6],_=r[7],h=r[8],f=r[9],l=r[10],d=r[11],y=r[12],m=r[13],E=r[14],v=r[15],T=e[0],p=e[1],A=e[2],R=e[3];return t[0]=T*n+p*o+A*h+R*y,t[1]=T*i+p*u+A*f+R*m,t[2]=T*a+p*c+A*l+R*E,t[3]=T*s+p*_+A*d+R*v,T=e[4],p=e[5],A=e[6],R=e[7],t[4]=T*n+p*o+A*h+R*y,t[5]=T*i+p*u+A*f+R*m,t[6]=T*a+p*c+A*l+R*E,t[7]=T*s+p*_+A*d+R*v,T=e[8],p=e[9],A=e[10],R=e[11],t[8]=T*n+p*o+A*h+R*y,t[9]=T*i+p*u+A*f+R*m,t[10]=T*a+p*c+A*l+R*E,t[11]=T*s+p*_+A*d+R*v,T=e[12],p=e[13],A=e[14],R=e[15],t[12]=T*n+p*o+A*h+R*y,t[13]=T*i+p*u+A*f+R*m,t[14]=T*a+p*c+A*l+R*E,t[15]=T*s+p*_+A*d+R*v,t},f.mul=f.multiply,f.translate=function(t,r,e){var n,i,a,s,o,u,c,_,h,f,l,d,y,m,E,v,T=e[0],p=e[1],A=e[2];return n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5],c=r[6],_=r[7],h=r[8],f=r[9],l=r[10],d=r[11],y=r[12],m=r[13],E=r[14],v=r[15],t[0]=n+s*T,t[1]=i+s*p,t[2]=a+s*A,t[3]=s,t[4]=o+_*T,t[5]=u+_*p,t[6]=c+_*A,t[7]=_,t[8]=h+d*T,t[9]=f+d*p,t[10]=l+d*A,t[11]=d,t[12]=y+v*T,t[13]=m+v*p,t[14]=E+v*A,t[15]=v,t},f.scale=function(t,r,e){var n=e[0],i=e[1],a=e[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=r[7]*i,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=r[11]*a,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},f.rotate=function(t,e,n,i){var a,s,o,u,c,_,h,f,l,d,y,m,E,v,T,p,A,R,g,N,I,b,S,x,L=i[0],O=i[1],M=i[2],P=Math.sqrt(L*L+O*O+M*M);return r>Math.abs(P)?null:(P=1/P,L*=P,O*=P,M*=P,a=Math.sin(n),s=Math.cos(n),o=1-s,u=e[0],c=e[1],_=e[2],h=e[3],f=e[4],l=e[5],d=e[6],y=e[7],m=e[8],E=e[9],v=e[10],T=e[11],p=L*L*o+s,A=O*L*o+M*a,R=M*L*o-O*a,g=L*O*o-M*a,N=O*O*o+s,I=M*O*o+L*a,b=L*M*o+O*a,S=O*M*o-L*a,x=M*M*o+s,t[0]=u*p+f*A+m*R,t[1]=c*p+l*A+E*R,t[2]=_*p+d*A+v*R,t[3]=h*p+y*A+T*R,t[4]=u*g+f*N+m*I,t[5]=c*g+l*N+E*I,t[6]=_*g+d*N+v*I,t[7]=h*g+y*N+T*I,t[8]=u*b+f*S+m*x,t[9]=c*b+l*S+E*x,t[10]=_*b+d*S+v*x,t[11]=h*b+y*S+T*x,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},f.rotateX=function(t,r,e){var n=Math.sin(e),i=Math.cos(e),a=r[4],s=r[5],o=r[6],u=r[7],c=r[8],_=r[9],h=r[10],f=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=a*i+c*n,t[5]=s*i+_*n,t[6]=o*i+h*n,t[7]=u*i+f*n,t[8]=c*i-a*n,t[9]=_*i-s*n,t[10]=h*i-o*n,t[11]=f*i-u*n,t},f.rotateY=function(t,r,e){var n=Math.sin(e),i=Math.cos(e),a=r[0],s=r[1],o=r[2],u=r[3],c=r[8],_=r[9],h=r[10],f=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=a*i-c*n,t[1]=s*i-_*n,t[2]=o*i-h*n,t[3]=u*i-f*n,t[8]=a*n+c*i,t[9]=s*n+_*i,t[10]=o*n+h*i,t[11]=u*n+f*i,t},f.rotateZ=function(t,r,e){var n=Math.sin(e),i=Math.cos(e),a=r[0],s=r[1],o=r[2],u=r[3],c=r[4],_=r[5],h=r[6],f=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=a*i+c*n,t[1]=s*i+_*n,t[2]=o*i+h*n,t[3]=u*i+f*n,t[4]=c*i-a*n,t[5]=_*i-s*n,t[6]=h*i-o*n,t[7]=f*i-u*n,t},f.fromRotationTranslation=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=n+n,u=i+i,c=a+a,_=n*o,h=n*u,f=n*c,l=i*u,d=i*c,y=a*c,m=s*o,E=s*u,v=s*c;return t[0]=1-(l+y),t[1]=h+v,t[2]=f-E,t[3]=0,t[4]=h-v,t[5]=1-(_+y),t[6]=d+m,t[7]=0,t[8]=f+E,t[9]=d-m,t[10]=1-(_+l),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},f.fromQuat=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=e+e,o=n+n,u=i+i,c=e*s,_=n*s,h=n*o,f=i*s,l=i*o,d=i*u,y=a*s,m=a*o,E=a*u;return t[0]=1-h-d,t[1]=_+E,t[2]=f-m,t[3]=0,t[4]=_-E,t[5]=1-c-d,t[6]=l+y,t[7]=0,t[8]=f+m,t[9]=l-y,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.frustum=function(t,r,e,n,i,a,s){var o=1/(e-r),u=1/(i-n),c=1/(a-s);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(e+r)*o,t[9]=(i+n)*u,t[10]=(s+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*s*a*c,t[15]=0,t},f.perspective=function(t,r,e,n,i){var a=1/Math.tan(r/2),s=1/(n-i);return t[0]=a/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*s,t[15]=0,t},f.ortho=function(t,r,e,n,i,a,s){var o=1/(r-e),u=1/(n-i),c=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+e)*o,t[13]=(i+n)*u,t[14]=(s+a)*c,t[15]=1,t},f.lookAt=function(t,e,n,i){var a,s,o,u,c,_,h,l,d,y,m=e[0],E=e[1],v=e[2],T=i[0],p=i[1],A=i[2],R=n[0],g=n[1],N=n[2];return r>Math.abs(m-R)&&r>Math.abs(E-g)&&r>Math.abs(v-N)?f.identity(t):(h=m-R,l=E-g,d=v-N,y=1/Math.sqrt(h*h+l*l+d*d),h*=y,l*=y,d*=y,a=p*d-A*l,s=A*h-T*d,o=T*l-p*h,y=Math.sqrt(a*a+s*s+o*o),y?(y=1/y,a*=y,s*=y,o*=y):(a=0,s=0,o=0),u=l*o-d*s,c=d*a-h*o,_=h*s-l*a,y=Math.sqrt(u*u+c*c+_*_),y?(y=1/y,u*=y,c*=y,_*=y):(u=0,c=0,_=0),t[0]=a,t[1]=u,t[2]=h,t[3]=0,t[4]=s,t[5]=c,t[6]=l,t[7]=0,t[8]=o,t[9]=_,t[10]=d,t[11]=0,t[12]=-(a*m+s*E+o*v),t[13]=-(u*m+c*E+_*v),t[14]=-(h*m+l*E+d*v),t[15]=1,t)},f.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},void 0!==t&&(t.mat4=f);var l={};l.create=function(){var t=new e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},l.rotationTo=function(){var t=o.create(),r=o.fromValues(1,0,0),e=o.fromValues(0,1,0);return function(n,i,a){var s=o.dot(i,a);return-.999999>s?(o.cross(t,r,i),1e-6>o.length(t)&&o.cross(t,e,i),o.normalize(t,t),l.setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,i,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,l.normalize(n,n))}}(),l.setAxes=function(){var t=h.create();return function(r,e,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],l.normalize(r,l.fromMat3(r,t))}}(),l.clone=u.clone,l.fromValues=u.fromValues,l.copy=u.copy,l.set=u.set,l.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},l.setAxisAngle=function(t,r,e){e=.5*e;var n=Math.sin(e);return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=Math.cos(e),t},l.add=u.add,l.multiply=function(t,r,e){var n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1],c=e[2],_=e[3];return t[0]=n*_+s*o+i*c-a*u,t[1]=i*_+s*u+a*o-n*c,t[2]=a*_+s*c+n*u-i*o,t[3]=s*_-n*o-i*u-a*c,t},l.mul=l.multiply,l.scale=u.scale,l.rotateX=function(t,r,e){e*=.5;var n=r[0],i=r[1],a=r[2],s=r[3],o=Math.sin(e),u=Math.cos(e);return t[0]=n*u+s*o,t[1]=i*u+a*o,t[2]=a*u-i*o,t[3]=s*u-n*o,t},l.rotateY=function(t,r,e){e*=.5;var n=r[0],i=r[1],a=r[2],s=r[3],o=Math.sin(e),u=Math.cos(e);return t[0]=n*u-a*o,t[1]=i*u+s*o,t[2]=a*u+n*o,t[3]=s*u-i*o,t},l.rotateZ=function(t,r,e){e*=.5;var n=r[0],i=r[1],a=r[2],s=r[3],o=Math.sin(e),u=Math.cos(e);return t[0]=n*u+i*o,t[1]=i*u-n*o,t[2]=a*u+s*o,t[3]=s*u-a*o,t},l.calculateW=function(t,r){var e=r[0],n=r[1],i=r[2];return t[0]=e,t[1]=n,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-e*e-n*n-i*i)),t},l.dot=u.dot,l.lerp=u.lerp,l.slerp=function(t,r,e,n){var i,a,s,o,u,c=r[0],_=r[1],h=r[2],f=r[3],l=e[0],d=e[1],y=e[2],m=e[3];return a=c*l+_*d+h*y+f*m,0>a&&(a=-a,l=-l,d=-d,y=-y,m=-m),1-a>1e-6?(i=Math.acos(a),s=Math.sin(i),o=Math.sin((1-n)*i)/s,u=Math.sin(n*i)/s):(o=1-n,u=n),t[0]=o*c+u*l,t[1]=o*_+u*d,t[2]=o*h+u*y,t[3]=o*f+u*m,t},l.invert=function(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],s=e*e+n*n+i*i+a*a,o=s?1/s:0;return t[0]=-e*o,t[1]=-n*o,t[2]=-i*o,t[3]=a*o,t},l.conjugate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t},l.length=u.length,l.len=l.length,l.squaredLength=u.squaredLength,l.sqrLen=l.squaredLength,l.normalize=u.normalize,l.fromMat3=function(t,r){var e,n=r[0]+r[4]+r[8];if(n>0)e=Math.sqrt(n+1),t[3]=.5*e,e=.5/e,t[0]=(r[7]-r[5])*e,t[1]=(r[2]-r[6])*e,t[2]=(r[3]-r[1])*e;else{var i=0;r[4]>r[0]&&(i=1),r[8]>r[3*i+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;e=Math.sqrt(r[3*i+i]-r[3*a+a]-r[3*s+s]+1),t[i]=.5*e,e=.5/e,t[3]=(r[3*s+a]-r[3*a+s])*e,t[a]=(r[3*a+i]+r[3*i+a])*e,t[s]=(r[3*s+i]+r[3*i+s])*e}return t},l.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.quat=l)}(r.exports)}(this),define("qtek/core/mixin/derive",["require"],function(){"use strict";function t(t,n,i){"object"==typeof n&&(i=n,n=null);var a,s=this;if(!(t instanceof Function)){a=[];for(var o in t)t.hasOwnProperty(o)&&a.push(o)}var u=function(){if(s.apply(this,arguments),t instanceof Function?r(this,t.call(this)):e(this,t,a),this.constructor===u)for(var n=u.__initializers__,i=0;n.length>i;i++)n[i].apply(this,arguments)};u.__super__=s,u.__initializers__=s.__initializers__?s.__initializers__.slice():[],n&&u.__initializers__.push(n);var c=function(){};return c.prototype=s.prototype,u.prototype=new c,u.prototype.constructor=u,r(u.prototype,i),u.derive=s.derive,u}function r(t,r){if(r)for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])}function e(t,r,e){for(var n=0;e.length>n;n++){var i=e[n];t[i]=r[i]}}return{derive:t}}),define("qtek/core/mixin/notifier",[],function(){function t(t,r){this.action=t,this.context=r}var r={trigger:function(t){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(t)){var r=this.__handlers__[t],e=r.length,n=-1,i=arguments;switch(i.length){case 1:for(;e>++n;)r[n].action.call(r[n].context);return;case 2:for(;e>++n;)r[n].action.call(r[n].context,i[1]);return;case 3:for(;e>++n;)r[n].action.call(r[n].context,i[1],i[2]);return;case 4:for(;e>++n;)r[n].action.call(r[n].context,i[1],i[2],i[3]);return;case 5:for(;e>++n;)r[n].action.call(r[n].context,i[1],i[2],i[3],i[4]);return;default:for(;e>++n;)r[n].action.apply(r[n].context,Array.prototype.slice.call(i,1));return}}},on:function(r,e,n){if(r&&e){var i=this.__handlers__||(this.__handlers__={});if(i[r]){if(this.has(r,e))return}else i[r]=[];var a=new t(e,n||this);return i[r].push(a),this}},once:function(t,r,e){function n(){i.off(t,n),r.apply(this,arguments)}if(t&&r){var i=this;return this.on(t,n,e)}},before:function(t,r,e){return t&&r?(t="before"+t,this.on(t,r,e)):void 0},after:function(t,r,e){return t&&r?(t="after"+t,this.on(t,r,e)):void 0},success:function(t,r){return this.once("success",t,r)},error:function(t,r){return this.once("error",t,r)},off:function(t,r){var e=this.__handlers__||(this.__handlers__={});if(!r)return void(e[t]=[]);if(e[t]){for(var n=e[t],i=[],a=0;n.length>a;a++)r&&n[a].action!==r&&i.push(n[a]);e[t]=i}return this},has:function(t,r){var e=this.__handlers__;if(!e||!e[t])return!1;for(var n=e[t],i=0;n.length>i;i++)if(n[i].action===r)return!0}};return r}),define("qtek/core/util",["require"],function(){"use strict";var t=0,r={genGUID:function(){return++t},relative2absolute:function(t,r){if(!r||t.match(/^\//))return t;for(var e=t.split("/"),n=r.split("/"),i=e[0];"."===i||".."===i;)".."===i&&n.pop(),e.shift(),i=e[0];return n.join("/")+"/"+e.join("/")},extend:function(t,r){if(r)for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);return t},defaults:function(t,r){if(r)for(var e in r)void 0===t[e]&&(t[e]=r[e]);return t},extendWithPropList:function(t,r,e){if(r)for(var n=0;e.length>n;n++){var i=e[n];t[i]=r[i]}return t},defaultsWithPropList:function(t,r,e){if(r)for(var n=0;e.length>n;n++){var i=e[n];void 0===t[i]&&(t[i]=r[i])}return t},each:function(t,r,e){if(t&&r)if(t.forEach)t.forEach(r,e);else if(t.length===+t.length)for(var n=0,i=t.length;i>n;n++)r.call(e,t[n],n,t);else for(var a in t)t.hasOwnProperty(a)&&r.call(e,t[a],a,t)},isObject:function(t){return t===Object(t)},isArray:function(t){return t instanceof Array},isArrayLike:function(t){return t?t.length===+t.length:!1},clone:function(t){if(r.isObject(t)){if(r.isArray(t))return t.slice();if(r.isArrayLike(t)){for(var e=new t.constructor(t.length),n=0;t.length>n;n++)e[n]=t[n];return e}return r.extend({},t)}return t}};return r}),define("qtek/Renderable",["require","./Node","./core/glenum","./core/glinfo","./DynamicGeometry"],function(t){"use strict";function r(t,r,e){this.availableAttributes=t,this.availableAttributeSymbols=r,this.indicesBuffer=e,this.vao=null}var e,n=t("./Node"),i=t("./core/glenum"),a=t("./core/glinfo"),s=t("./DynamicGeometry"),o=0,u=null,c=!0,_=function(){this.faceNumber=0,this.vertexNumber=0,this.drawCallNumber=0},h=n.derive({material:null,geometry:null,mode:i.TRIANGLES,_drawCache:null,_renderInfo:null},function(){this._drawCache={},this._renderInfo=new _},{lineWidth:1,culling:!0,cullFace:i.BACK,frontFace:i.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&this.visible},render:function(t,n){var _=n||this.material,h=_.shader,f=this.geometry,l=this.mode,d=f.getVertexNumber(),y=f.isUseFace(),m=a.getExtension(t,"OES_element_index_uint"),E=m&&d>65535,v=E?t.UNSIGNED_INT:t.UNSIGNED_SHORT,T=a.getExtension(t,"OES_vertex_array_object"),p=!f.dynamic,A=this._renderInfo;A.vertexNumber=d,A.faceNumber=0,A.drawCallNumber=0;var R=!1;if(e=t.__GLID__+"-"+f.__GUID__+"-"+h.__GUID__,e!==o?R=!0:(f instanceof s&&d>65535&&!m&&y||T&&p||f._cache.isDirty())&&(R=!0),o=e,R){var g=this._drawCache[e];if(!g){var N=f.getBufferChunks(t);if(!N)return;g=[];for(var I=0;N.length>I;I++){for(var b=N[I],S=b.attributeBuffers,x=b.indicesBuffer,L=[],O=[],M=0;S.length>M;M++){var P,D=S[M],C=D.name,U=D.semantic;if(U){var F=h.attribSemantics[U];P=F&&F.symbol}else P=C;P&&h.attributeTemplates[P]&&(L.push(D),O.push(P))}var B=new r(L,O,x);g.push(B)}p&&(this._drawCache[e]=g)}for(var w=0;g.length>w;w++){var B=g[w],k=!0;T&&p&&(null==B.vao?B.vao=T.createVertexArrayOES():k=!1,T.bindVertexArrayOES(B.vao));var L=B.availableAttributes,x=B.indicesBuffer;if(k)for(var G=h.enableAttributes(t,B.availableAttributeSymbols,T&&p&&B.vao),M=0;L.length>M;M++){var X=G[M];if(-1!==X){var V,D=L[M],q=D.buffer,W=D.size;switch(D.type){case"float":V=t.FLOAT;break;case"byte":V=t.BYTE;break;case"ubyte":V=t.UNSIGNED_BYTE;break;case"short":V=t.SHORT;break;case"ushort":V=t.UNSIGNED_SHORT;break;default:V=t.FLOAT}t.bindBuffer(t.ARRAY_BUFFER,q),t.vertexAttribPointer(X,W,V,!1,0,0)}}(l==i.LINES||l==i.LINE_STRIP||l==i.LINE_LOOP)&&t.lineWidth(this.lineWidth),u=x,c=f.isUseFace(),c?(k&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,x.buffer),t.drawElements(l,x.count,v,0),A.faceNumber+=x.count/3):t.drawArrays(l,0,d),T&&p&&T.bindVertexArrayOES(null),A.drawCallNumber++}}else c?(t.drawElements(l,u.count,v,0),A.faceNumber=u.count/3):t.drawArrays(l,0,d),A.drawCallNumber=1;return A},clone:function(){var t=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling"];return function(){var r=n.prototype.clone.call(this);r.geometry=this.geometry,r.material=this.material;for(var e=0;t.length>e;e++){var i=t[e];r[i]!==this[i]&&(r[i]=this[i])}return r}}()});return h.beforeFrame=function(){o=0},h.POINTS=i.POINTS,h.LINES=i.LINES,h.LINE_LOOP=i.LINE_LOOP,h.LINE_STRIP=i.LINE_STRIP,h.TRIANGLES=i.TRIANGLES,h.TRIANGLE_STRIP=i.TRIANGLE_STRIP,h.TRIANGLE_FAN=i.TRIANGLE_FAN,h.BACK=i.BACK,h.FRONT=i.FRONT,h.FRONT_AND_BACK=i.FRONT_AND_BACK,h.CW=i.CW,h.CCW=i.CCW,h.RenderInfo=_,h}),define("qtek/core/glinfo",[],function(){"use strict";var t=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers"],r=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"],e={},n={},i={initialize:function(i){var a=i.__GLID__;if(!e[a]){e[a]={},n[a]={};for(var s=0;t.length>s;s++){var o=t[s];this._createExtension(i,o)}for(var s=0;r.length>s;s++){var u=r[s];n[a][u]=i.getParameter(i[u])}}},getExtension:function(t,r){var n=t.__GLID__;return e[n]?(void 0===e[n][r]&&this._createExtension(t,r),e[n][r]):void 0},getParameter:function(t,r){var e=t.__GLID__;return n[e]?n[e][r]:void 0},dispose:function(t){delete e[t.__GLID__],delete n[t.__GLID__]},_createExtension:function(t,r){var n=t.getExtension(r);n||(n=t.getExtension("MOZ_"+r)),n||(n=t.getExtension("WEBKIT_"+r)),e[t.__GLID__][r]=n}};return i}),define("qtek/DynamicGeometry",["require","./Geometry","./math/BoundingBox","./core/glenum","./core/glinfo","./dep/glmatrix"],function(t){"use strict";var r=t("./Geometry"),e=t("./math/BoundingBox"),n=t("./core/glenum"),i=t("./core/glinfo"),a=t("./dep/glmatrix"),s=a.vec3,o=a.mat4,u=Array.prototype.slice,c=r.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),texcoord0:new r.Attribute("texcoord0","float",2,"TEXCOORD_0",!0),texcoord1:new r.Attribute("texcoord1","float",2,"TEXCOORD_1",!0),normal:new r.Attribute("normal","float",3,"NORMAL",!0),tangent:new r.Attribute("tangent","float",4,"TANGENT",!0),color:new r.Attribute("color","float",4,"COLOR",!0),weight:new r.Attribute("weight","float",3,"WEIGHT",!0),joint:new r.Attribute("joint","float",4,"JOINT",!0),barycentric:new r.Attribute("barycentric","float",3,null,!0)},dynamic:!0,hint:n.DYNAMIC_DRAW,faces:[],_enabledAttributes:null,_arrayChunks:[]}},{updateBoundingBox:function(){this.boundingBox||(this.boundingBox=new e),this.boundingBox.updateFromVertices(this.attributes.position.value)},dirty:function(t){if(t)this._cache.dirtyAll(t),this._cache.dirtyAll(),this._enabledAttributes=null;else{this.dirty("indices");for(var r in this.attributes)this.dirty(r)}},getVertexNumber:function(){var t=this.attributes[this.mainAttribute];return t&&t.value?t.value.length:0},getFaceNumber:function(){return this.faces.length},getFace:function(t,r){return this.getFaceNumber()>t&&t>=0?(r||(r=s.create()),s.copy(r,this.faces[t]),r):void 0},isUseFace:function(){return this.useFace&&this.faces.length>0},isSplitted:function(){return this.getVertexNumber()>65535},createAttribute:function(t,e,n,i){var a=new r.Attribute(t,e,n,i,!0);return this.attributes[t]=a,this._attributeList.push(t),a},removeAttribute:function(t){var r=this._attributeList.indexOf(t);return r>=0?(this._attributeList.splice(r,1),delete this.attributes[t],!0):!1},getEnabledAttributes:function(){if(this._enabledAttributes)return this._enabledAttributes;for(var t={},r=this.getVertexNumber(),e=0;this._attributeList.length>e;e++){var n=this._attributeList[e],i=this.attributes[n];i.value.length&&i.value.length===r&&(t[n]=i)}return this._enabledAttributes=t,t},_getDirtyAttributes:function(){var t=this.getEnabledAttributes();if(this._cache.miss("chunks"))return t;var r={},e=!0;for(var n in t)this._cache.isDirty(n)&&(r[n]=t[n],e=!1);return e?void 0:r},getChunkNumber:function(){return this._arrayChunks.length},getBufferChunks:function(t){if(this._cache.use(t.__GLID__),this._cache.isDirty()){var r=this._getDirtyAttributes(),e=this._cache.isDirty("indices");if(e=e&&this.isUseFace(),r){this._updateAttributesAndIndicesArrays(r,e,null!=i.getExtension(t,"OES_element_index_uint")),this._updateBuffer(t,r,e);for(var n in r)this._cache.fresh(n);this._cache.fresh("indices"),this._cache.fresh()}}return this._cache.get("chunks")},_updateAttributesAndIndicesArrays:function(t,r,e){var n=this,i=this.getVertexNumber(),a=[],s=[],o={};for(var u in t)switch(F){case"byte":o[u]=Int8Array;break;case"ubyte":o[u]=Uint8Array;break;case"short":o[u]=Int16Array;break;case"ushort":o[u]=Uint16Array;break;default:o[u]=Float32Array}var c=function(r){if(n._arrayChunks[r])return n._arrayChunks[r];var e={attributeArrays:{},indicesArray:null};for(var s in t)e.attributeArrays[s]=null;for(var o=0;i>o;o++)a[o]=-1;return n._arrayChunks.push(e),e},_=Object.keys(t);if(i>65535&&this.isUseFace()&&!e){var h,f=0,l=[0],d=[];for(m=0;i>m;m++)d[m]=-1,a[m]=-1;if(r)for(m=0;this.faces.length>m;m++)s[m]=[0,0,0];h=c(f);for(var y=0,m=0;this.faces.length>m;m++){var E=this.faces[m],v=s[m];y+3>65535&&(f++,l[f]=m,y=0,h=c(f));for(var T=0;3>T;T++){for(var p=E[T],A=-1===a[p],R=0;_.length>R;R++){var u=_[R],g=h.attributeArrays[u],N=t[u].value,I=t[u].size;if(g||(g=h.attributeArrays[u]=[]),A){1===I&&(g[y]=N[p]);for(var b=0;I>b;b++)g[y*I+b]=N[p][b]}}A?(a[p]=y,v[T]=y,y++):v[T]=a[p]}}for(var S=0;this._arrayChunks.length>S;S++){var x=this._arrayChunks[S];for(var u in x.attributeArrays){var L=x.attributeArrays[u];L instanceof Array&&(x.attributeArrays[u]=new o[u](L))}}if(r)for(var O,M,P,x,S=0;this._arrayChunks.length>S;S++){O=l[S],M=l[S+1]||this.faces.length,P=0,x=this._arrayChunks[S];var D=x.indicesArray;D||(D=x.indicesArray=new Uint16Array(3*(M-O)));for(var m=O;M>m;m++)D[P++]=s[m][0],D[P++]=s[m][1],D[P++]=s[m][2]}}else{var x=c(0);if(r){var D=x.indicesArray,C=this.faces.length;if(!D||3*C!==D.length){var U=i>65535?Uint32Array:Uint16Array;D=x.indicesArray=new U(3*this.faces.length)}for(var P=0,m=0;C>m;m++)D[P++]=this.faces[m][0],D[P++]=this.faces[m][1],D[P++]=this.faces[m][2]}for(var u in t){var N=t[u].value,F=t[u].type,I=t[u].size,g=x.attributeArrays[u],B=i*I;if(g&&g.length===B||(g=new o[u](B),x.attributeArrays[u]=g),1===I)for(var m=0;N.length>m;m++)g[m]=N[m];else for(var P=0,m=0;N.length>m;m++)for(var b=0;I>b;b++)g[P++]=N[m][b]}}},_updateBuffer:function(t,e,n){var i=this._cache.get("chunks"),a=!1;if(!i){i=[];for(var s=0;this._arrayChunks.length>s;s++)i[s]={attributeBuffers:[],indicesBuffer:null};this._cache.put("chunks",i),a=!0}for(var o=0;this._arrayChunks.length>o;o++){var u=i[o];u||(u=i[o]={attributeBuffers:[],indicesBuffer:null});var c=u.attributeBuffers,_=u.indicesBuffer,h=this._arrayChunks[o],f=h.attributeArrays,l=h.indicesArray,d=0,y=0;for(var m in e){var E,v=e[m],T=v.type,p=v.semantic,A=v.size;if(!a){for(var s=y;c.length>s;s++)if(c[s].name===m){E=c[s],y=s+1;
break}if(!E)for(var s=y-1;s>=0;s--)if(c[s].name===m){E=c[s],y=s;break}}var R;R=E?E.buffer:t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,R),t.bufferData(t.ARRAY_BUFFER,f[m],this.hint),c[d++]=new r.AttributeBuffer(m,T,R,A,p)}c.length=d,n&&(_||(_=new r.IndicesBuffer(t.createBuffer()),u.indicesBuffer=_),_.count=l.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,_.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,l,this.hint))}},generateVertexNormals:function(){for(var t=this.faces,r=t.length,e=this.attributes.position.value,n=this.attributes.normal.value,i=s.create(),a=s.create(),o=s.create(),u=0;n.length>u;u++)s.set(n[u],0,0,0);for(var u=n.length;e.length>u;u++)n[u]=[0,0,0];for(var c=0;r>c;c++){var _=t[c],h=_[0],f=_[1],l=_[2],d=e[h],y=e[f],m=e[l];s.sub(a,d,y),s.sub(o,y,m),s.cross(i,a,o),s.add(n[h],n[h],i),s.add(n[f],n[f],i),s.add(n[l],n[l],i)}for(var u=0;n.length>u;u++)s.normalize(n[u],n[u])},generateFaceNormals:function(){this.isUniqueVertex()||this.generateUniqueVertex();for(var t=this.faces,r=t.length,e=this.attributes.position.value,n=this.attributes.normal.value,i=s.create(),a=s.create(),o=s.create(),c=n.length===e.length,_=0;r>_;_++){var h=t[_],f=h[0],l=h[1],d=h[2],y=e[f],m=e[l],E=e[d];s.sub(a,y,m),s.sub(o,m,E),s.cross(i,a,o),c?(s.copy(n[f],i),s.copy(n[l],i),s.copy(n[d],i)):n[f]=n[l]=n[d]=u.call(i)}},generateTangents:function(){for(var t=this.attributes.texcoord0.value,r=this.attributes.position.value,e=this.attributes.tangent.value,n=this.attributes.normal.value,i=[],a=[],o=this.getVertexNumber(),u=0;o>u;u++)i[u]=[0,0,0],a[u]=[0,0,0];for(var c=[0,0,0],_=[0,0,0],u=0;this.faces.length>u;u++){var h=this.faces[u],f=h[0],l=h[1],d=h[2],y=t[f],m=t[l],E=t[d],v=r[f],T=r[l],p=r[d],A=T[0]-v[0],R=p[0]-v[0],g=T[1]-v[1],N=p[1]-v[1],I=T[2]-v[2],b=p[2]-v[2],S=m[0]-y[0],x=E[0]-y[0],L=m[1]-y[1],O=E[1]-y[1],M=1/(S*O-L*x);c[0]=(O*A-L*R)*M,c[1]=(O*g-L*N)*M,c[2]=(O*I-L*b)*M,_[0]=(S*R-x*A)*M,_[1]=(S*N-x*g)*M,_[2]=(S*b-x*I)*M,s.add(i[f],i[f],c),s.add(i[l],i[l],c),s.add(i[d],i[d],c),s.add(a[f],a[f],_),s.add(a[l],a[l],_),s.add(a[d],a[d],_)}for(var P=[0,0,0,0],D=[0,0,0],u=0;o>u;u++){var C=n[u],U=i[u];s.scale(P,C,s.dot(C,U)),s.sub(P,U,P),s.normalize(P,P),s.cross(D,C,U),P[3]=0>s.dot(D,a[u])?-1:1,e[u]=P.slice()}},isUniqueVertex:function(){return this.isUseFace()?this.getVertexNumber()===3*this.faces.length:!0},generateUniqueVertex:function(){for(var t=[],r=0;this.getVertexNumber()>r;r++)t[r]=0;for(var e=this.getVertexNumber(),n=this.getEnabledAttributes(),i=this.faces,a=Object.keys(n),r=0;i.length>r;r++)for(var s=i[r],o=0;3>o;o++){var c=s[o];if(t[c]>0){for(var _=0;a.length>_;_++){var h=a[_],f=n[h].value,l=n[h].size;f.push(1===l?f[c]:u.call(f[c]))}s[o]=e,e++}t[c]++}this.dirty()},generateBarycentric:function(){var t=[1,0,0],r=[0,0,1],e=[0,1,0];return function(){this.isUniqueVertex()||this.generateUniqueVertex();var n=this.attributes.barycentric.value;if(n.length!=3*this.faces.length)for(var i,a,s,o,u=0;this.faces.length>u;u++)o=this.faces[u],i=o[0],a=o[1],s=o[2],n[i]=t,n[a]=r,n[s]=e}}(),convertToStatic:function(t,r){if(this._updateAttributesAndIndicesArrays(this.getEnabledAttributes(),!0,r),this._arrayChunks.length>1)console.warn("Large geometry will discard chunks when convert to StaticGeometry");else if(0===this._arrayChunks.length)return t;var n=this._arrayChunks[0],i=this.getEnabledAttributes();for(var a in i){var s=i[a],o=t.attributes[a];o||(o=t.attributes[a]={type:s.type,size:s.size,value:null},s.semantic&&(o.semantic=s.semantic)),o.value=n.attributeArrays[a]}return t.faces=n.indicesArray,this.boundingBox&&(t.boundingBox=new e,t.boundingBox.min.copy(this.boundingBox.min),t.boundingBox.max.copy(this.boundingBox.max)),t},applyTransform:function(t){var r=this.attributes.position.value,e=this.attributes.normal.value,n=this.attributes.tangent.value;t=t._array;for(var i=0;r.length>i;i++)s.transformMat4(r[i],r[i],t);var a=o.create();o.invert(a,t),o.transpose(a,a);for(var i=0;e.length>i;i++)s.transformMat4(e[i],e[i],a);for(var i=0;n.length>i;i++)s.transformMat4(n[i],n[i],a);this.boundingBox&&this.updateBoundingBox()},dispose:function(t){this._cache.use(t.__GLID__);var r=this._cache.get("chunks");if(r)for(var e=0;r.length>e;e++)for(var n=r[e],i=0;n.attributeBuffers.length>i;i++){var a=n.attributeBuffers[i];t.deleteBuffer(a.buffer)}this._cache.deleteContext(t.__GLID__)}});return c}),define("qtek/Geometry",["require","./core/Base","./core/glenum","./core/Cache","./dep/glmatrix"],function(t){"use strict";function r(t,r,e,n,i){switch(this.name=t,this.type=r,this.size=e,n&&(this.semantic=n),i?(this._isDynamic=!0,this.value=[]):(this._isDynamic=!1,this.value=null),e){case 1:this.get=function(t){return this.value[t]},this.set=function(t,r){this.value[t]=r};break;case 2:i?(this.get=function(t,r){r=r._array||r;var e=this.value[t];return e&&c.copy(r,e),r},this.set=function(t,r){r=r._array||r;var e=this.value[t];e||(e=this.value[t]=c.create()),c.copy(e,r)}):(this.get=function(t,r){return r=r._array||r,r[0]=this.value[2*t],r[1]=this.value[2*t+1],r},this.set=function(t,r){r=r._array||r,this.value[2*t]=r[0],this.value[2*t+1]=r[1]});break;case 3:i?(this.get=function(t,r){r=r._array||r;var e=this.value[t];return e&&_.copy(r,e),r},this.set=function(t,r){r=r._array||r;var e=this.value[t];e||(e=this.value[t]=_.create()),_.copy(e,r)}):(this.get=function(t,r){return r=r._array||r,r[0]=this.value[3*t],r[1]=this.value[3*t+1],r[2]=this.value[3*t+2],r},this.set=function(t,r){r=r._array||r,this.value[3*t]=r[0],this.value[3*t+1]=r[1],this.value[3*t+2]=r[2]});break;case 4:i?(this.get=function(t,r){r=r._array||r;var e=this.value[t];return e&&h.copy(r,e),r},this.set=function(t,r){r=r._array||r;var e=this.value[t];e||(e=this.value[t]=h.create()),h.copy(e,r)}):(this.get=function(t,r){return r=r._array||r,r[0]=this.value[4*t],r[1]=this.value[4*t+1],r[2]=this.value[4*t+2],r[3]=this.value[4*t+3],r},this.set=function(t,r){r=r._array||r,this.value[4*t]=r[0],this.value[4*t+1]=r[1],this.value[4*t+2]=r[2],this.value[4*t+3]=r[3]})}}function e(t,r,e,n,i){this.name=t,this.type=r,this.buffer=e,this.size=n,this.semantic=i,this.symbol=""}function n(t){this.buffer=t,this.count=0}function i(){console.warn("Geometry doesn't implement this method, use DynamicGeometry or StaticGeometry instead")}var a=t("./core/Base"),s=t("./core/glenum"),o=t("./core/Cache"),u=t("./dep/glmatrix"),c=u.vec2,_=u.vec3,h=u.vec4;r.prototype.init=function(t){if(this._isDynamic)console.warn("Dynamic geometry not support init method");else if(!this.value||this.value.length!=t*this.size){var r;switch(this.type){case"byte":r=Int8Array;break;case"ubyte":r=Uint8Array;break;case"short":r=Int16Array;break;case"ushort":r=Uint16Array;break;default:r=Float32Array}this.value=new r(t*this.size)}},r.prototype.clone=function(t){var e=new r(this.name,this.type,this.size,this.semantic,this._isDynamic);return t&&console.warn("todo"),e};var f=a.derive({boundingBox:null,attributes:{},faces:null,dynamic:!1,useFace:!0},function(){this._cache=new o,this._attributeList=Object.keys(this.attributes)},{pickByRay:null,mainAttribute:"position",dirty:i,createAttribute:i,removeAttribute:i,getVertexNumber:i,getFaceNumber:i,getFace:i,isUseFace:i,getEnabledAttributes:i,getBufferChunks:i,generateVertexNormals:i,generateFaceNormals:i,isUniqueVertex:i,generateUniqueVertex:i,generateTangents:i,generateBarycentric:i,applyTransform:i,dispose:i});return f.STATIC_DRAW=s.STATIC_DRAW,f.DYNAMIC_DRAW=s.DYNAMIC_DRAW,f.STREAM_DRAW=s.STREAM_DRAW,f.AttributeBuffer=e,f.IndicesBuffer=n,f.Attribute=r,f}),define("qtek/math/BoundingBox",["require","./Vector3","../dep/glmatrix"],function(t){"use strict";var r=t("./Vector3"),e=t("../dep/glmatrix"),n=e.vec3,i=n.transformMat4,a=n.copy,s=n.set,o=function(t,e){this.min=t||new r(1/0,1/0,1/0),this.max=e||new r(-1/0,-1/0,-1/0);for(var i=[],a=0;8>a;a++)i[a]=n.fromValues(0,0,0);this.vertices=i};return o.prototype={constructor:o,updateFromVertices:function(t){if(t.length>0){var r=this.min._array,e=this.max._array;a(r,t[0]),a(e,t[0]);for(var n=1;t.length>n;n++){var i=t[n];i[0]<r[0]&&(r[0]=i[0]),i[1]<r[1]&&(r[1]=i[1]),i[2]<r[2]&&(r[2]=i[2]),i[0]>e[0]&&(e[0]=i[0]),i[1]>e[1]&&(e[1]=i[1]),i[2]>e[2]&&(e[2]=i[2])}this.min._dirty=!0,this.max._dirty=!0}},union:function(t){n.min(this.min._array,this.min._array,t.min._array),n.max(this.max._array,this.max._array,t.max._array),this.min._dirty=!0,this.max._dirty=!0},intersectBoundingBox:function(t){var r=this.min._array,e=this.max._array,n=t.min._array,i=t.max._array;return!(r[0]>i[0]||r[1]>i[1]||r[2]>i[2]||e[0]<n[0]||e[1]<n[1]||e[2]<n[2])},applyTransform:function(t){(this.min._dirty||this.max._dirty)&&(this.updateVertices(),this.min._dirty=!1,this.max._dirty=!1);var r=t._array,e=this.min._array,n=this.max._array,s=this.vertices,o=s[0];i(o,o,r),a(e,o),a(n,o);for(var u=1;8>u;u++)o=s[u],i(o,o,r),o[0]<e[0]&&(e[0]=o[0]),o[1]<e[1]&&(e[1]=o[1]),o[2]<e[2]&&(e[2]=o[2]),o[0]>n[0]&&(n[0]=o[0]),o[1]>n[1]&&(n[1]=o[1]),o[2]>n[2]&&(n[2]=o[2]);this.min._dirty=!0,this.max._dirty=!0},applyProjection:function(t){(this.min._dirty||this.max._dirty)&&(this.updateVertices(),this.min._dirty=!1,this.max._dirty=!1);var r=t._array,e=this.vertices[0],n=this.vertices[3],i=this.vertices[7],a=this.min._array,s=this.max._array;if(1===r[15])a[0]=r[0]*e[0]+r[12],a[1]=r[5]*e[1]+r[13],s[2]=r[10]*e[2]+r[14],s[0]=r[0]*i[0]+r[12],s[1]=r[5]*i[1]+r[13],a[2]=r[10]*i[2]+r[14];else{var o=-1/e[2];a[0]=r[0]*e[0]*o,a[1]=r[5]*e[1]*o,s[2]=(r[10]*e[2]+r[14])*o,o=-1/n[2],s[0]=r[0]*n[0]*o,s[1]=r[5]*n[1]*o,o=-1/i[2],a[2]=(r[10]*i[2]+r[14])*o}this.min._dirty=!0,this.max._dirty=!0},updateVertices:function(){var t=this.min._array,r=this.max._array,e=this.vertices;s(e[0],t[0],t[1],t[2]),s(e[1],t[0],r[1],t[2]),s(e[2],r[0],t[1],t[2]),s(e[3],r[0],r[1],t[2]),s(e[4],t[0],t[1],r[2]),s(e[5],t[0],r[1],r[2]),s(e[6],r[0],t[1],r[2]),s(e[7],r[0],r[1],r[2])},copy:function(t){a(this.min._array,t.min._array),a(this.max._array,t.max._array),this.min._dirty=!0,this.max._dirty=!0},clone:function(){var t=new o;return t.copy(this),t}},o}),define("qtek/core/Cache",[],function(){"use strict";var t=function(){this._contextId=0,this._caches=[],this._context={}};return t.prototype={use:function(t,r){this._caches[t]||(this._caches[t]={},r&&(this._caches[t]=r())),this._contextId=t,this._context=this._caches[t]},put:function(t,r){this._context[t]=r},get:function(t){return this._context[t]},dirty:function(t){t=t||"";var r="__dirty__"+t;this.put(r,!0)},dirtyAll:function(t){t=t||"";for(var r="__dirty__"+t,e=0;this._caches.length>e;e++)this._caches[e]&&(this._caches[e][r]=!0)},fresh:function(t){t=t||"";var r="__dirty__"+t;this.put(r,!1)},freshAll:function(t){t=t||"";for(var r="__dirty__"+t,e=0;this._caches.length>e;e++)this._caches[e]&&(this._caches[e][r]=!1)},isDirty:function(t){t=t||"";var r="__dirty__"+t;return!this._context.hasOwnProperty(r)||this._context[r]===!0},deleteContext:function(t){delete this._caches[t],this._context={}},"delete":function(t){delete this._context[t]},clearAll:function(){this._caches={}},getContext:function(){return this._context},miss:function(t){return!this._context.hasOwnProperty(t)}},t.prototype.constructor=t,t}),define("qtek/Texture",["require","./core/Base","./core/glenum","./core/Cache"],function(t){"use strict";var r=t("./core/Base"),e=t("./core/glenum"),n=t("./core/Cache"),i=r.derive({width:512,height:512,type:e.UNSIGNED_BYTE,format:e.RGBA,wrapS:e.CLAMP_TO_EDGE,wrapT:e.CLAMP_TO_EDGE,minFilter:e.LINEAR_MIPMAP_LINEAR,magFilter:e.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1},function(){this._cache=new n},{getWebGLTexture:function(t){var r=this._cache;return r.use(t.__GLID__),r.miss("webgl_texture")&&r.put("webgl_texture",t.createTexture()),this.dynamic?this.update(t):r.isDirty()&&(this.update(t),r.fresh()),r.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache.dirtyAll()},update:function(){},beforeUpdate:function(t){t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.fallBack()},fallBack:function(){var t=this.isPowerOfTwo();this.format===e.DEPTH_COMPONENT&&(this.useMipmap=!1),t&&this.useMipmap?(this.NPOT=!1,this._minFilterOriginal&&(this.minFilter=this._minFilterOriginal),this._magFilterOriginal&&(this.magFilter=this._magFilterOriginal),this._wrapSOriginal&&(this.wrapS=this._wrapSOriginal),this._wrapTOriginal&&(this.wrapT=this._wrapTOriginal)):(this.NPOT=!0,this._minFilterOriginal=this.minFilter,this._magFilterOriginal=this.magFilter,this._wrapSOriginal=this.wrapS,this._wrapTOriginal=this.wrapT,this.minFilter==e.NEAREST_MIPMAP_NEAREST||this.minFilter==e.NEAREST_MIPMAP_LINEAR?this.minFilter=e.NEAREST:(this.minFilter==e.LINEAR_MIPMAP_LINEAR||this.minFilter==e.LINEAR_MIPMAP_NEAREST)&&(this.minFilter=e.LINEAR),this.wrapS=e.CLAMP_TO_EDGE,this.wrapT=e.CLAMP_TO_EDGE)},nextHighestPowerOfTwo:function(t){--t;for(var r=1;32>r;r<<=1)t|=t>>r;return t+1},dispose:function(t){var r=this._cache;r.use(t.__GLID__);var e=r.get("webgl_texture");e&&t.deleteTexture(e),r.deleteContext(t.__GLID__)},isRenderable:function(){},isPowerOfTwo:function(){}});return i.BYTE=e.BYTE,i.UNSIGNED_BYTE=e.UNSIGNED_BYTE,i.SHORT=e.SHORT,i.UNSIGNED_SHORT=e.UNSIGNED_SHORT,i.INT=e.INT,i.UNSIGNED_INT=e.UNSIGNED_INT,i.FLOAT=e.FLOAT,i.HALF_FLOAT=36193,i.DEPTH_COMPONENT=e.DEPTH_COMPONENT,i.ALPHA=e.ALPHA,i.RGB=e.RGB,i.RGBA=e.RGBA,i.LUMINANCE=e.LUMINANCE,i.LUMINANCE_ALPHA=e.LUMINANCE_ALPHA,i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,i.NEAREST=e.NEAREST,i.LINEAR=e.LINEAR,i.NEAREST_MIPMAP_NEAREST=e.NEAREST_MIPMAP_NEAREST,i.LINEAR_MIPMAP_NEAREST=e.LINEAR_MIPMAP_NEAREST,i.NEAREST_MIPMAP_LINEAR=e.NEAREST_MIPMAP_LINEAR,i.LINEAR_MIPMAP_LINEAR=e.LINEAR_MIPMAP_LINEAR,i.TEXTURE_MAG_FILTER=e.TEXTURE_MAG_FILTER,i.TEXTURE_MIN_FILTER=e.TEXTURE_MIN_FILTER,i.REPEAT=e.REPEAT,i.CLAMP_TO_EDGE=e.CLAMP_TO_EDGE,i.MIRRORED_REPEAT=e.MIRRORED_REPEAT,i});