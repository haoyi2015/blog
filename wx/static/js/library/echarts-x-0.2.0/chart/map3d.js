define("echarts-x/chart/map3d",["require","zrender/tool/util","zrender/config","echarts/util/ecData","echarts/util/mapData/params","echarts/util/mapData/geoCoord","echarts/util/mapData/textFixed","echarts/util/projection/normal","zrender/shape/Polygon","zrender/shape/ShapeBundle","zrender/shape/Text","qtek/Node","qtek/Mesh","qtek/geometry/Sphere","qtek/geometry/Plane","qtek/Material","qtek/Shader","qtek/Texture2D","qtek/math/Vector3","qtek/math/Matrix4","qtek/math/Plane","qtek/math/Quaternion","qtek/light/Directional","qtek/light/Ambient","qtek/picking/RayPicking","../config","./base3d","../util/OrbitControl","../surface/ZRenderSurface","../surface/VectorFieldParticleSurface","../util/sunCalc","qtek/core/LRU","echarts/chart"],function(e){function t(e,t,r,i,a){R.call(this,e,t,r,i,a),this.baseLayer.renderer&&(this._earthRadius=100,this._baseTextureSize=2048,this._mapRootNode=null,this._mapDataMap={},this._nameMap={},this._globeSurface=null,this._surfaceLayerRoot=null,this._lambertDiffShader=new g({vertex:g.source("ecx.lambert.vertex"),fragment:g.source("ecx.lambert.fragment")}),this._lambertDiffShader.enableTexture("diffuseMap"),this._albedoShader=new g({vertex:g.source("ecx.albedo.vertex"),fragment:g.source("ecx.albedo.fragment")}),this._albedoShader.enableTexture("diffuseMap"),this._albedoShaderPA=this._albedoShader.clone(),this._albedoShaderPA.define("fragment","PREMULTIPLIED_ALPHA"),this._sphereGeometry=new m({widthSegments:60,heightSegments:60}),this._sphereGeometryLowRes=new m({widthSegments:30,heightSegments:30}),this._planeGeometry=new _,this._imageCache=new A(6),this._vfParticleSurfaceList=[],this._skydome=null,this._selectedShapeMap={},this._selectedShapeList=[],this._selectedMode=!1,this.refresh(i))}var r=e("zrender/tool/util"),i=e("zrender/config"),a=e("echarts/util/ecData"),n=e("echarts/util/mapData/params").params,s=e("echarts/util/mapData/geoCoord"),o=e("echarts/util/mapData/textFixed"),h=e("echarts/util/projection/normal"),u=e("zrender/shape/Polygon"),l=e("zrender/shape/ShapeBundle"),c=e("zrender/shape/Text"),d=e("qtek/Node"),f=e("qtek/Mesh"),m=e("qtek/geometry/Sphere"),_=e("qtek/geometry/Plane"),p=e("qtek/Material"),g=e("qtek/Shader"),y=e("qtek/Texture2D"),v=e("qtek/math/Vector3"),b=e("qtek/math/Matrix4"),x=e("qtek/math/Plane"),T=e("qtek/math/Quaternion"),w=e("qtek/light/Directional"),S=e("qtek/light/Ambient"),k=e("qtek/picking/RayPicking"),E=e("../config"),R=e("./base3d"),M=e("../util/OrbitControl"),P=e("../surface/ZRenderSurface"),N=e("../surface/VectorFieldParticleSurface"),L=e("../util/sunCalc"),A=e("qtek/core/LRU"),C=function(e){return[(-168.5>e[0]&&e[1]>63.8?e[0]+360:e[0])+168.5,90-e[1]]},q=Math.PI,I=2*q,O=Math.sin,B=Math.cos;return t.prototype={type:E.CHART_TYPE_MAP3D,constructor:t,_init:function(){function e(e){n[e].getGeoJson(function(r){r.mapType=e,h._mapDataMap[e]=r,m--,m||t()})}function t(){if(!h._disposed){for(var e in f){var t=d[e];h._initMap3D(e,t,f[e]);break}h.afterBuildMark()}}var i=this.component.legend,a=this.series,h=this;this.selectedMap={},this.beforeBuildMark();for(var u=0;a.length>u;u++)if(a[u].type===E.CHART_TYPE_MAP3D){a[u]=this.reformOption(a[u]);var l=a[u].name,c=a[u].mapType;this.selectedMap[l]=i?i.isSelected(l):!0,a[u].geoCoord&&r.merge(s,a[u].geoCoord,!0),a[u].textFixed&&r.merge(o,a[u].textFixed,!0),a[u].nameMap&&(this._nameMap[c]=this._nameMap[c]||{},r.merge(this._nameMap[c],a[u].nameMap,!0))}var d=this._groupSeriesByMapType(a),f=this._mergeSeriesData(a),m=0,_=!0;for(var c in f){!this._mapDataMap[c]&&n[c].getGeoJson&&(m++,_=!1,e(c));break}_&&t()},_initMap3D:function(e,t,r){var i=this.deepQuery(t,"baseLayer.quality");if(isNaN(i))switch(i){case"low":this._baseTextureSize=1024;break;case"high":this._baseTextureSize=4096;break;default:this._baseTextureSize=2048}else this._baseTextureSize=i;this._selectedShapeMap={},this._selectedShapeList=[],this._selectedMode=this.deepQuery(t,"selectedMode");var a=this.deepQuery(t,"flat"),n=this._mapRootNode;if(n&&n.__isFlatMap===a||(n&&(n.__control&&n.__control.dispose(),this.baseLayer.renderer.disposeNode(n,!0,!0),this.disposeMark()),this._createMapRootNode(t)),a){var s=this.deepQuery(t,"flatAngle")*Math.PI/180;s=Math.max(Math.min(Math.PI/2,s),0),this._mapRootNode.rotation.identity().rotateX(-s);var o=this._getMapBBox(this._mapDataMap[e]),h=o.height/o.width,u=this._mapRootNode.queryNode("earth");u.scale.y=u.scale.x*h}this._initMapHandlers(t),this._updateMapLayers(e,r,t),this._setViewport(t),this._updateOrbitControl(t)},_setViewport:function(e){var t=this.deepQuery(e,"mapLocation")||{},r=t.x,i=t.y,a=t.width,n=t.height,s=this.zr.getWidth(),o=this.zr.getHeight();r=this.parsePercent(r,s),i=this.parsePercent(i,o),a=this.parsePercent(a,s),n=this.parsePercent(n,o),r=isNaN(r)?0:r,i=isNaN(i)?0:r,a=isNaN(a)?s:a,n=isNaN(n)?o:n,this.baseLayer.setViewport(r,i,a,n)},_groupSeriesByMapType:function(e){for(var t={},r=0;e.length>r;r++)if(e[r].type===E.CHART_TYPE_MAP3D&&this.selectedMap[e[r].name]){var i=e[r].mapType;t[i]=t[i]||[],t[i].push(e[r])}return t},_mergeSeriesData:function(e){for(var t={},r=0;e.length>r;r++)if(e[r].type===E.CHART_TYPE_MAP3D&&this.selectedMap[e[r].name]){var i=e[r].mapType;t[i]=t[i]||{};for(var a=e[r].data||[],n=0;a.length>n;n++){var s=a[n].name||"";t[i][s]=t[i][s]||{seriesIdx:[],value:0},t[i][s].seriesIdx.push(r);for(var o in a[n]){var h=a[n][o];"value"===o?isNaN(h)||(t[i][s].value+=+h):t[i][s][o]=h}}}return t},_createMapRootNode:function(e){var t=this.zr,r=this.deepQuery(e,"flat"),i=this.baseLayer.camera;this._mapRootNode=new d({name:"globe"});var a=this._mapRootNode;a.__isFlatMap=r,r||a.rotation.rotateY(-Math.PI/2);var n=new f({name:"earth",geometry:r?this._planeGeometry:this._sphereGeometry,material:new p({shader:this._albedoShader,transparent:!0})});n.geometry.pickByRay=r?this._getPlaneRayPickingHooker(n):this._getSphereRayPickingHooker(n);var s=this._earthRadius;r?n.scale.set(s*Math.PI,s*Math.PI/2,1):n.scale.set(s,s,s),i.position.z=s*(r?1:2.5),i.position.y=0,i.lookAt(v.ZERO),a.add(n);var o=this.baseLayer.scene;o.add(a);var h=new M(a,this.zr,this.baseLayer);h.__firstInit=!0,h.mode=r?"pan":"rotate",h.init(),a.__control=h,this._globeSurface=this._globeSurface||new P(this._baseTextureSize,this._baseTextureSize);var u=this._globeSurface.getTexture();n.material.set("diffuseMap",u),u.flipY=r,this._globeSurface.onrefresh=function(){t.refreshNextFrame()}},_updateOrbitControl:function(e){var t=this._mapRootNode.__control;if(["autoRotate","autoRotateAfterStill","maxZoom","minZoom"].forEach(function(r){t[r]=this.deepQuery(e,"roam."+r)},this),t.stopAllAnimation(),!this.deepQuery(e,"roam.preserve")||t.__firstInit){var r=this.deepQuery(e,"roam.focus");if(this._isValueNone(r)){t.__firstInit&&t.setZoom(10);var i=this.deepQuery(e,"roam.zoom");i!==t.getZoom()&&t.zoomTo({zoom:i,easing:"CubicOut"})}else{var a=this._globeSurface.getShapeByName(r);a&&this._focusOnShape(a)}}t.__firstInit=!1},_updateMapLayers:function(e,t,r){var i=this,a=this._mapRootNode,n=this._globeSurface,s=this.deepQuery;n.resize(this._baseTextureSize,this._baseTextureSize),this._updateLightShading(r),this._updateSkydome(r);var o=s(r,"baseLayer.backgroundColor"),h=s(r,"baseLayer.backgroundImage");if(n.backgroundColor=this._isValueNone(o)?"":o,this._isValueNone(h))n.backgroundImage=null;else if("string"==typeof h){var u=this._imageCache.get(h);if(u)n.backgroundImage=u;else{var u=new Image;u.onload=function(){n.backgroundImage=u,n.refresh(),i._imageCache.put(h,u)},u.src=h}}else n.backgroundImage=h;this._mapDataMap[e]&&this._updateMapPolygonShapes(t,this._mapDataMap[e],r),n.refresh(),this._surfaceLayerRoot&&this.baseLayer.renderer.disposeNode(this._surfaceLayerRoot,!1,!0),this._surfaceLayerRoot=new d({name:"surfaceLayers"}),a.add(this._surfaceLayerRoot);for(var l=0;this._vfParticleSurfaceList.length>l;l++)this._vfParticleSurfaceList[l].dispose();this._vfParticleSurfaceList=[],r.forEach(function(e){var t=this.series.indexOf(e);this.buildMark(t,a),this._createSurfaceLayers(t)},this)},_updateSkydome:function(e){var t=this.deepQuery(e,"background"),r=this;if(this._isValueNone(t))this._skydome&&(this._skydome.visible=!1);else{this._skydome||(this._skydome=new f({material:new p({shader:this._albedoShader}),geometry:this._sphereGeometryLowRes,frontFace:f.CW}),this._skydome.scale.set(1e3,1e3,1e3));var i=this._skydome;i.visible=!0;var a=i.material.get("diffuseMap");if(a||(a=new y({flipY:!1}),i.material.set("diffuseMap",a)),"string"==typeof t){var n=this._imageCache.get(t);n?a.image=n:a.load(t).success(function(){r._imageCache.put(t,n),r.zr.refreshNextFrame()})}else this._isValueImage(t)&&(a.image=t);a.dirty(),this.baseLayer.scene.add(i)}},_updateLightShading:function(e){var t=this,r=this._mapRootNode,i=r.queryNode("earth"),a=i.material,n=r.__isFlatMap,s=this.deepQuery,o=s(e,"light.show");if(o){var h=this._lambertDiffShader;a.shader!==h&&a.attachShader(h,!0),n?h.define("fragment","FLAT"):h.unDefine("fragment","FLAT");var u=r.queryNode("sun"),l=r.queryNode("ambient");u||(u=new w({name:"sun"}),r.add(u),l=new S({name:"ambient"}),r.add(l)),u.intensity=s(e,"light.sunIntensity"),l.intensity=s(e,"light.ambientIntensity");var c=s(e,"light.time")||new Date;this._getSunPosition(new Date(c).toUTCString(),u.position),u.lookAt(v.ZERO);var d=s(e,"baseLayer.heightImage");if(this._isValueNone(d))h.disableTexture("bumpMap");else{var f=a.get("bumpMap");if(f||(f=new y({anisotropic:32,flipY:n})),"string"==typeof d){var m=d;d=this._imageCache.get(m),d?f.image=d:f.load(m).success(function(){h.enableTexture("bumpMap"),a.set("bumpMap",f),t._imageCache.put(m,f.image),t.zr.refreshNextFrame()})}else this._isValueImage(d)&&(f.image=d);f.dirty()}}else o||a.shader===this._albedoShader||a.attachShader(this._albedoShader,!0)},_getSunPosition:function(e,t){var r=L.getPosition(Date.parse(e),0,0),i=Math.cos(r.altitude);t.y=-i*Math.cos(r.azimuth),t.x=Math.sin(r.altitude),t.z=i*Math.sin(r.azimuth)},_createSurfaceLayers:function(e){for(var t=this.series[e],r=this._mapRootNode.__isFlatMap,i=0;t.surfaceLayers.length>i;i++){var a=t.surfaceLayers[i],n=new f({name:"surfaceLayer"+i,geometry:r?this._planeGeometry:this._sphereGeometryLowRes,ignorePicking:!0}),s=a.distance;if(null==s&&(s=i+1),r)n.position.z=s,n.scale.copy(this._mapRootNode.queryNode("earth").scale);else{var o=this._earthRadius+s;n.scale.set(o,o,o)}switch(a.type){case"particle":this._createParticleSurfaceLayer(e,a,n);break;default:this._createTextureSurfaceLayer(e,a,n)}this._surfaceLayerRoot.add(n)}},_createTextureSurfaceLayer:function(e,t,r){var i=this;r.material=new p({shader:this._albedoShader,transparent:!0,depthMask:!1});var a=t.image,n=document.createElement("canvas");n.width=1,n.height=1;var s=new y({anisotropic:32,image:n});if(r.material.set("diffuseMap",s),"string"==typeof a){var o=a;a=this._imageCache.get(o),a?s.image=a:s.load(o).success(function(){i.zr.refreshNextFrame(),i._imageCache.put(o,s.image)})}else this._isValueImage(a)&&(s.image=a)},_createParticleSurfaceLayer:function(e,t,r){var i=this.query(t,"particle.vectorField");r.material=new p({shader:this._albedoShaderPA,transparent:!0,depthMask:!1});var a,n=new N(this.baseLayer.renderer,i),s=0,o=0;if(i instanceof Array){if(a=this._createCanvasFromDataMatrix(i),s=a.width,o=a.height,!a)return!1}else{if(!this._isValueImage(i))return!1;s=i.width,o=i.height,a=i}if(s&&o){var h=this.query(t,"size");"number"==typeof h?h=[h,h]:h||(h=[2048,1024]);var u=this.query(t,"particle.sizeScaling")||1,l=this.query(t,"particle.speedScaling");null==l&&(l=1),u*=h[0]/1024;var c=this.query(t,"particle.color")||"white",d=this.query(t,"particle.number");null==d&&(d=65536);var f=this.query(t,"particle.motionBlurFactor");null==f&&(f=.99),n.vectorFieldTexture=new y({image:a,flipY:!this._mapRootNode.__isFlatMap}),n.surfaceTexture=new y({width:h[0],height:h[1],anisotropic:32}),n.particleSizeScaling=u,n.particleSpeedScaling=l,n.particleColor=this.parseColor(c),n.motionBlurFactor=f;var m=Math.round(Math.sqrt(d));n.init(m,m),n.surfaceMesh=r,this._vfParticleSurfaceList.push(n)}},_createCanvasFromDataMatrix:function(e){var t=e.length;if(!(e[0]instanceof Array))return null;var r=e[0].length;if(!(e[0][0]instanceof Array))return null;var i=document.createElement("canvas");i.width=r,i.height=t;for(var a=i.getContext("2d"),n=a.getImageData(0,0,r,t),s=0,o=0;t>o;o++)for(var h=0;r>h;h++){var u=e[o][h],l=null==u.x?u[0]:u.x,c=null==u.y?u[1]:u.y;n.data[s++]=128*l+128,n.data[s++]=128*c+128,n.data[s++]=0,n.data[s++]=255}return a.putImageData(n,0,0),i},_updateMapPolygonShapes:function(e,t,r){function i(e,t){if("Polygon"==e.type)n(e.coordinates,t);else if("MultiPolygon"==e.type)for(var r=0;e.coordinates.length>r;r++)n(e.coordinates[r],t)}function n(e,t){for(var r=0;e.length>r;r++){for(var i=new u({style:{pointList:[]}}),a=0;e[r].length>a;a++){var n=s._normalizeGeoCoord(e[r][a],h);n[0]*=s._baseTextureSize,n[1]*=s._baseTextureSize,i.style.pointList.push(n)}t.style.shapeList.push(i)}}this._globeSurface.clearElements();for(var s=this,o=this.component.dataRange,h=this._getMapBBox(t),d=this._mapRootNode.__isFlatMap,f=this.deepQuery(r,"mapType"),m=this._nameMap[f]||{},_=0;t.features.length>_;_++){var p=t.features[_],g=p.properties.name;g=m[g]||g;var y,v=e[g],b=[],x=[];if(v){b.push(v);for(var T=0;v.seriesIdx.length>T;T++){var w=v.seriesIdx[T];x.push(this.series[w].name),b.push(this.series[w])}y=v.value}else v="-",y="-",b=r;x=x.join(" ");var S=this.deepQuery(b,"itemStyle.normal.areaStyle.color");S=o&&!isNaN(y)?o.getColor(y):S;var k=new l({name:g,zlevel:0,cp:p.properties.cp,style:{shapeList:[],brushType:"both",color:S,strokeColor:this.deepQuery(b,"itemStyle.normal.borderColor"),lineWidth:this.deepQuery(b,"itemStyle.normal.borderWidth"),opacity:this.deepQuery(b,"itemStyle.normal.opacity")},highlightStyle:{color:this.deepQuery(b,"itemStyle.emphasis.areaStyle.color"),strokeColor:this.deepQuery(b,"itemStyle.emphasis.borderColor"),lineWidth:this.deepQuery(b,"itemStyle.emphasis.borderWidth"),opacity:this.deepQuery(b,"itemStyle.emphasis.opacity")}});if(v.selected&&this._selectShape(k),a.pack(k,{name:x,tooltip:this.deepQuery(b,"tooltip")},0,v,0,g),"Feature"==p.type)i(p.geometry,k);else if("GeometryCollection"==p.type)for(var T=0;p.geometries>T;T++)i(p.geometries[T],k);this._globeSurface.addElement(k);var E=this._getTextPosition(k,h),R=1;if(!d)var M=(.5-E[1]/this._baseTextureSize)*q,R=.5/B(M);var P=this._baseTextureSize/2048*Math.sqrt(Math.min(360/h.width,180/h.height)),N=new c({zlevel:1,position:E,scale:[R*P,P],style:{x:0,y:0,brushType:"fill",text:this._getMapLabelText(g,y,b,"normal"),textAlign:"center",color:this.deepQuery(b,"itemStyle.normal.label.textStyle.color"),opacity:this.deepQuery(b,"itemStyle.normal.label.show")?1:0,textFont:this.getFont(this.deepQuery(b,"itemStyle.normal.label.textStyle"))},highlightStyle:{color:this.deepQuery(b,"itemStyle.emphasis.label.textStyle.color"),opacity:this.deepQuery(b,"itemStyle.emphasis.label.show")?1:0,textFont:this.getFont(this.deepQuery(b,"itemStyle.emphasis.label.textStyle"))}});this._globeSurface.addElement(N)}},_normalizeGeoCoord:function(e,t){return e=C(e),e[0]=(e[0]-t.left)/t.width,e[1]=(e[1]-t.top)/t.height,e},_getMapBBox:function(e){return this._mapRootNode.__isFlatMap&&!e.mapType.match("world")?e.bbox||h.getBbox(e):{top:0,left:-11.5,width:360,height:180}},_selectShape:function(e){if(!e.__selected){if(this._selectedShapeMap[e.name]=e,this._selectedShapeList.push(e),"single"===this._selectedMode&&this._selectedShapeList.length>1){var t=this._selectedShapeList.shift();this._unselectShape(t)}e.__selected=!0,e._style=e.style,e.style=e.highlightStyle,e.style.shapeList=e._style.shapeList,e.style.brushType=e._style.brushType,e.modSelf()}},_unselectShape:function(e){if(e.__selected){delete this._selectedShapeMap[e.name];var t=this._selectedShapeList.indexOf(e);t>=0&&this._selectedShapeList.splice(t,1),e.__selected=!1,e.style=e._style,e.modSelf()}},_getTextPosition:function(e,t){var r,i=e.name,a=o[i]||[0,0],n=this._baseTextureSize;if(s[i])r=this._normalizeGeoCoord(s[i],t),r[0]*=n,r[1]*=n;else if(e.cp)r=this._normalizeGeoCoord(e.cp,t),r[0]*=n,r[1]*=n;else{var t=e.getRect(e.style);r=[t.x+t.width/2+a[0],t.y+t.height/2+a[1]]}return r},_getSphereRayPickingHooker:function(e){var t=new v;return function(r){var i=e.geometry.radius,a=r.intersectSphere(v.ZERO,i);if(a){var n=new v;v.transformMat4(n,a,e.worldTransform),v.transformMat4(t,r.origin,e.worldTransform);var s=v.distance(t,a);return new k.Intersection(a,n,e,null,s)}}},_getPlaneRayPickingHooker:function(e){var t=new v,r=new x;return r.normal.set(0,0,1),function(i){var a=i.intersectPlane(r);if(a.x>=-1&&1>=a.x&&a.y>=-1&&1>=a.y){var n=new v;v.transformMat4(n,a,e.worldTransform),v.transformMat4(t,i.origin,e.worldTransform);var s=v.distance(t,a);return new k.Intersection(a,n,e,null,s)}}},_initMapHandlers:function(e){var t=this._mapRootNode.queryNode("earth"),r=this.deepQuery(e,"clickable"),a=this.deepQuery(e,"hoverable"),n=this._mapRootNode.__isFlatMap,s=function(e){if(e.type===i.EVENT.CLICK||e.type===i.EVENT.DBLCLICK){if(!r)return}else if(!a)return;var t,s,o=e.point,h=this._globeSurface.getWidth(),u=this._globeSurface.getWidth();if(n)t=(o.x+1)*h/2,s=(1-o.y)*u/2;else{var l=this._eulerToGeographic(o.x,o.y,o.z);t=(l[0]+180)/360*h,s=(90-l[1])/180*u}var c=this._globeSurface.hover(t,s);if(c){if(e.type===i.EVENT.CLICK&&this._selectedMode){c.__selected?this._unselectShape(c):this._selectShape(c);var d={};for(var f in this._selectedShapeMap)d[f]=!0;this.messageCenter.dispatch(E.EVENT.MAP3D_SELECTED,e.event,{selected:d,target:c.name},this.myChart)}this.zr.handler.dispatch(e.type,{target:c,event:e.event,type:e.type})}},o=["CLICK","DBLCLICK","MOUSEOVER","MOUSEOUT","MOUSEMOVE"];o.forEach(function(e){t.off(i.EVENT[e]),t.on(i.EVENT[e],s,this)},this)},_eulerToGeographic:function(e,t,r){var i=Math.asin(t),a=Math.atan2(r,-e);0>a&&(a=I+a);var n=180*i/q,s=180*a/q-180;return[s,n]},_isValueNone:function(e){return null==e||""===e||"string"==typeof e&&"none"==e.toLowerCase()},_isValueImage:function(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image},_getMapLabelText:function(e,t,r,i){var a=this.deepQuery(r,"itemStyle."+i+".label.formatter");return a?"function"==typeof a?a.call(this.myChart,e,t):"string"==typeof a?(a=a.replace("{a}","{a0}").replace("{b}","{b0}"),a=a.replace("{a0}",e).replace("{b0}",t)):void 0:e},_focusOnShape:function(e){function t(e,t){if(e/=s,t/=o,a)return new v(2*i.scale.x*(e-.5),2*i.scale.y*(.5-t),0);var r=h*O(t*q);return new v(-r*B(e*I),h*B(t*q),r*O(e*I))}if(e){var r=this._mapRootNode,i=r.queryNode("earth"),a=r.__isFlatMap,n=this._globeSurface,s=n.getWidth(),o=n.getHeight(),h=this._earthRadius,u=e.getRect(e.style),l=u.x,c=u.y,d=u.width,f=u.height,m=t(l,c),_=t(l+d,c),p=t(l,c+f),g=t(l+d,c+f);if(a){var y=(new v).add(m).add(_).add(p).add(g).scale(.25),b=r.worldTransform.y,x=r.worldTransform.x,l=y.x,c=y.y;y.set(0,0,0).scaleAndAdd(b,-c).scaleAndAdd(x,-l),this._mapRootNode.__control.moveTo({position:y,easing:"CubicOut"})}else{var w=(new v).add(m).add(_).add(p).add(g).normalize(),S=new v,k=new v;k.cross(v.UP,w).normalize(),S.cross(w,k).normalize();var E=(new T).setAxes(w.negate(),k,S).invert();this._mapRootNode.__control.rotateTo({rotation:E,easing:"CubicOut"})}}},getMarkCoord:function(e,t,r){var i=this._mapRootNode,a=i.queryNode("earth"),n=i.__isFlatMap,o=t.geoCoord||s[t.name],h=[],u=this.series[e],l=this.deepQuery([t,u.markPoint||u.markLine||u.markBar],"distance");h[0]=null==o.x?o[0]:o.x,h[1]=null==o.y?o[1]:o.y;var c=this._earthRadius;if(n){var d=this._getMapBBox(this._mapDataMap[u.mapType]);h=this._normalizeGeoCoord(h,d),r._array[0]=2*(h[0]-.5)*a.scale.x,r._array[1]=2*(.5-h[1])*a.scale.y,r._array[2]=l}else{var f=h[0],m=h[1];f=q*f/180,m=q*m/180,c+=l;var _=B(m)*c;r._array[1]=O(m)*c,r._array[0]=-_*B(f+q),r._array[2]=_*O(f+q)}},getMarkPointTransform:function(){var e=new v,t=new v,r=new v,i=new v;return function(a,n,s){var o=this._mapRootNode.__isFlatMap,h=this.series[a],u=[n,h.markPoint],l=this.deepQuery(u,"symbolSize"),c=this.deepQuery(u,"orientation"),d=this.deepQuery(u,"orientationAngle");if(this.getMarkCoord(a,n,i),o?(v.set(r,0,0,1),v.set(t,0,1,0),v.set(e,1,0,0)):(v.normalize(r,i),v.cross(e,v.UP,r),v.normalize(e,e),v.cross(t,r,e)),isNaN(l)||(l=[l,l]),"tangent"===c){var f=r;r=t,t=f,v.negate(r,r),v.scaleAndAdd(i,i,t,l[1])}s.x=e,s.y=t,s.z=r,b.rotateX(s,s,-d/180*q),b.scale(s,s,new v(l[0],l[1],1));var m=s._array;m[12]=i.x,m[13]=i.y,m[14]=i.z}}(),getMarkBarPoints:function(){var e=new v;return function(t,r,i,a){var n=this._mapRootNode.__isFlatMap,s=null!=r.barHeight?r.barHeight:1;"function"==typeof s&&(s=s(r)),this.getMarkCoord(t,r,i),n?v.set(e,0,0,1):(v.copy(e,i),v.normalize(e,e)),v.scaleAndAdd(a,i,e,s)}}(),getMarkLinePoints:function(){var e=new v,t=new v,r=new v,i=new v;return function(a,n,s,o,h,u){var l=this._mapRootNode.__isFlatMap,c=!!h;c||(u=o),this.getMarkCoord(a,n[0],s),this.getMarkCoord(a,n[1],u);var d=v.normalize,f=v.cross,m=v.sub,_=v.add,p=v.scaleAndAdd;if(c)if(l){var g=v.dist(s,u);_(o,s,u),v.scale(o,o,.5),v.set(e,0,0,1),p(o,o,e,Math.min(.1*g,10)),v.copy(h,o)}else{d(e,s),m(t,u,s),d(t,t),f(r,t,e),d(r,r),f(t,e,r),_(o,e,t),d(o,o),d(e,u),m(t,s,u),d(t,t),f(r,t,e),d(r,r),f(t,e,r),_(h,e,t),d(h,h),_(i,s,u),d(i,i);var y=v.dot(s,i),b=v.dot(i,o),g=2*((this._earthRadius-y)/b);p(o,s,o,g),p(h,u,h,g)}}}(),onframe:function(e){if(this._mapRootNode){R.prototype.onframe.call(this,e),this._mapRootNode.__control.update(e);for(var t=0;this._vfParticleSurfaceList.length>t;t++)this._vfParticleSurfaceList[t].update(Math.min(e/1e3,.5)),this.zr.refreshNextFrame();this._skydome&&this._skydome.rotation.copy(this._mapRootNode.rotation)}},refresh:function(e){this.baseLayer.renderer&&(e&&(this.option=e,this.series=e.series),this._init())},ondataRange:function(){this.component.dataRange&&(this.refresh(),this.zr.refreshNextFrame())},dispose:function(){R.prototype.dispose.call(this),this.baseLayer.dispose(),this._mapRootNode.__control&&this._mapRootNode.__control.dispose(),this._mapRootNode=null,this._disposed=!0;for(var e=0;this._vfParticleSurfaceList.length>e;e++)this._vfParticleSurfaceList[e].dispose()}},r.inherits(t,R),e("echarts/chart").define(E.CHART_TYPE_MAP3D,t),t}),define("qtek/geometry/Sphere",["require","../DynamicGeometry","../dep/glmatrix","../math/BoundingBox"],function(e){"use strict";var t=e("../DynamicGeometry"),r=e("../dep/glmatrix"),i=r.vec3,a=r.vec2,n=e("../math/BoundingBox"),s=t.derive({widthSegments:20,heightSegments:20,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var e=this.attributes.position.value,t=this.attributes.texcoord0.value,r=this.attributes.normal.value;e.length=0,t.length=0,r.length=0,this.faces.length=0;var s,o,h,u,l,c,d,f,m=this.heightSegments,_=this.widthSegments,p=this.radius,g=this.phiStart,y=this.phiLength,v=this.thetaStart,b=this.thetaLength,p=this.radius;for(d=0;m>=d;d++)for(c=0;_>=c;c++)u=c/_,l=d/m,s=-p*Math.cos(g+u*y)*Math.sin(v+l*b),o=p*Math.cos(v+l*b),h=p*Math.sin(g+u*y)*Math.sin(v+l*b),e.push(i.fromValues(s,o,h)),t.push(a.fromValues(u,l)),f=i.fromValues(s,o,h),i.normalize(f,f),r.push(f);var x,T,w,S,k=this.faces,E=_+1;for(d=0;m>d;d++)for(c=0;_>c;c++)T=d*E+c,x=d*E+c+1,S=(d+1)*E+c+1,w=(d+1)*E+c,k.push(i.fromValues(x,T,S)),k.push(i.fromValues(T,w,S));this.boundingBox=new n,this.boundingBox.max.set(p,p,p),this.boundingBox.min.set(-p,-p,-p)}});return s}),define("qtek/geometry/Plane",["require","../DynamicGeometry","../math/BoundingBox"],function(e){"use strict";var t=e("../DynamicGeometry"),r=e("../math/BoundingBox"),i=t.derive({widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){var e=this.heightSegments,t=this.widthSegments,i=this.attributes.position.value,a=this.attributes.texcoord0.value,n=this.attributes.normal.value,s=this.faces;i.length=0,a.length=0,n.length=0,s.length=0;for(var o=0;e>=o;o++)for(var h=o/e,u=0;t>=u;u++){var l=u/t;if(i.push([2*l-1,2*h-1,0]),a&&a.push([l,h]),n&&n.push([0,0,1]),t>u&&e>o){var c=u+o*(t+1);s.push([c,c+1,c+t+1]),s.push([c+t+1,c+1,c+t+2])}}this.boundingBox=new r,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}});return i}),define("qtek/math/Plane",["require","./Vector3","../dep/glmatrix"],function(e){"use strict";var t=e("./Vector3"),r=e("../dep/glmatrix"),i=r.vec3,a=r.mat4,n=r.vec4,s=function(e,r){this.normal=e||new t(0,1,0),this.distance=r||0};return s.prototype={constructor:s,distanceToPoint:function(e){return i.dot(e._array,this.normal._array)-this.distance},projectPoint:function(e,r){r||(r=new t);var a=this.distanceToPoint(e);return i.scaleAndAdd(r._array,e._array,this.normal._array,-a),r._dirty=!0,r},normalize:function(){var e=1/i.len(this.normal._array);i.scale(this.normal._array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,r=this.normal._array,a=i.dot(t[0]._array,r)>this.distance,n=1;8>n;n++)if(i.dot(t[n]._array,r)>this.distance!=a)return!0},intersectLine:function(){var e=i.create();return function(r,a,n){var s=this.distanceToPoint(r),o=this.distanceToPoint(a);if(s>0&&o>0||0>s&&0>o)return null;var h=this.normal._array,u=this.distance,l=r._array;i.sub(e,a._array,r._array),i.normalize(e,e);var c=i.dot(h,e);if(0===c)return null;n||(n=new t);var d=(i.dot(h,l)-u)/c;return i.scaleAndAdd(n._array,l,e,-d),n._dirty=!0,n}}(),applyTransform:function(){var e=a.create(),t=n.create(),r=n.create();return r[3]=1,function(s){s=s._array,i.scale(r,this.normal._array,this.distance),n.transformMat4(r,r,s),this.distance=i.dot(r,this.normal._array),a.invert(e,s),a.transpose(e,e),t[3]=0,i.copy(t,this.normal._array),n.transformMat4(t,t,e),i.copy(this.normal._array,t)}}(),copy:function(e){i.copy(this.normal._array,e.normal._array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new s;return e.copy(this),e}},s}),define("qtek/light/Directional",["require","../Light","../math/Vector3"],function(e){"use strict";var t=e("../Light"),r=e("../math/Vector3"),i=t.derive({shadowBias:2e-4,shadowSlopeScale:2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(){var e=new r;return function(t){return e.copy(t.worldTransform.z).negate()._array}}()},directionalLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=t.prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});return i}),define("qtek/light/Ambient",["require","../Light"],function(e){"use strict";var t=e("../Light"),r=t.derive({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}}});return r}),define("qtek/picking/RayPicking",["require","../core/Base","../math/Ray","../math/Vector2","../math/Vector3","../math/Matrix4","../Renderable","../StaticGeometry","../core/glenum"],function(e){var t=e("../core/Base"),r=e("../math/Ray"),i=e("../math/Vector2"),a=e("../math/Vector3"),n=e("../math/Matrix4"),s=e("../Renderable"),o=e("../StaticGeometry"),h=e("../core/glenum"),u=t.derive({scene:null,camera:null,renderer:null},function(){this._ray=new r,this._ndc=new i},{pick:function(e,t){var r=this.pickAll(e,t);return r[0]||null},pickAll:function(e,t){this.renderer.screenToNdc(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray);var r=[];return this._intersectNode(this.scene,r),r.sort(this._intersectionCompareFunc),r},_intersectNode:function(e,t){e instanceof s&&e.isRenderable()&&!e.ignorePicking&&e.geometry.isUseFace()&&this._intersectRenderable(e,t);for(var r=0;e._children.length>r;r++)this._intersectNode(e._children[r],t)},_intersectRenderable:function(){var e=new a,t=new a,i=new a,s=new r,l=new n;return function(r,c){s.copy(this._ray),n.invert(l,r.worldTransform),s.applyTransform(l);var d=r.geometry;if(!d.boundingBox||s.intersectBoundingBox(d.boundingBox)){if(d.pickByRay){var f=d.pickByRay(s);return void(f&&c.push(f))}var m,_=d instanceof o,p=r.cullFace===h.BACK&&r.frontFace===h.CCW||r.cullFace===h.FRONT&&r.frontFace===h.CW;if(_)for(var g=d.faces,y=d.attributes.position.value,v=0;g.length>v;){var b=3*g[v++],x=3*g[v++],T=3*g[v++];if(e._array[0]=y[b],e._array[1]=y[b+1],e._array[2]=y[b+2],t._array[0]=y[x],t._array[1]=y[x+1],t._array[2]=y[x+2],i._array[0]=y[T],i._array[1]=y[T+1],i._array[2]=y[T+2],m=p?s.intersectTriangle(e,t,i,r.culling):s.intersectTriangle(e,i,t,r.culling)){var w=new a;a.transformMat4(w,m,r.worldTransform),c.push(new u.Intersection(m,w,r,[b,x,T],a.dist(w,this._ray.origin)))}}else for(var g=d.faces,y=d.attributes.position.value,v=0;g.length>v;v++){var S=g[v],b=S[0],x=S[1],T=S[2];if(e.setArray(y[b]),t.setArray(y[x]),i.setArray(y[T]),m=p?s.intersectTriangle(e,t,i,r.culling):s.intersectTriangle(e,i,t,r.culling)){var w=new a;a.transformMat4(w,m,r.worldTransform),c.push(new u.Intersection(m,w,r,[b,x,T],a.dist(w,this._ray.origin)))}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});return u.Intersection=function(e,t,r,i,a){this.point=e,this.pointWorld=t,this.target=r,this.face=i,this.distance=a},u}),define("echarts-x/chart/base3d",["require","echarts/config","zrender/tool/util","../component/base3d","../util/color","qtek/core/LRU","qtek/math/Vector3","qtek/math/Matrix4","../entity/marker/MarkLine","../entity/marker/MarkBar","../entity/marker/MarkPoint","../entity/marker/LargeMarkPoint"],function(e){"use strict";function t(e,t,r,i,n){a.call(this,e,t,r,i,n),this._markers={line:{list:[],count:0},point:{list:[],count:0},bar:{list:[],count:0},largePoint:{list:[],count:0}}}var r=e("echarts/config"),i=e("zrender/tool/util"),a=e("../component/base3d"),n=e("../util/color"),s=e("qtek/core/LRU"),o=e("qtek/math/Vector3"),h=e("qtek/math/Matrix4"),u={line:e("../entity/marker/MarkLine"),bar:e("../entity/marker/MarkBar"),point:e("../entity/marker/MarkPoint"),largePoint:e("../entity/marker/LargeMarkPoint")};return t.prototype={constructor:t,beforeBuildMark:function(){for(var e in this._markers){for(var t=this._markers[e],r=0;t.list.length>r;r++)t.list[r].clear();t.count=0}},buildMark:function(e,t){var a=this.series[e];a.markPoint&&(i.merge(i.merge(a.markPoint,this.ecTheme.markPoint||{}),r.markPoint),a.markPoint.large?this._buildSingleTypeMarker("largePoint",e,t):this._buildSingleTypeMarker("point",e,t)),a.markLine&&(i.merge(i.merge(a.markLine,this.ecTheme.markLine||{}),r.markLine),this._buildSingleTypeMarker("line",e,t)),a.markBar&&(i.merge(i.merge(a.markBar,this.ecTheme.markBar||{}),r.markBar),this._buildSingleTypeMarker("bar",e,t))},afterBuildMark:function(){for(var e in this._markers){for(var t=this._markers[e],r=t.count;t.list.length>r;r++)this._disposeSingleSerieMark(t.list[r]);t.list.length=t.count}},_disposeSingleSerieMark:function(e){var t=e.getSceneNode();t.getParent()&&t.getParent().remove(t),e.dispose()},_buildSingleTypeMarker:function(e,t,r){var i=this.series[t],a=this._markers[e],n=a.list,s=a.count,o=u[e];if(n&&o){n[s]||(n[s]=new o(this));var h=n[s];h.setSeries(i,t);var l=h.getSceneNode();l.getParent()!==r&&r.add(l),a.count++}},parseColor:function(e){if(!e)return null;if(e instanceof Array)return e;this._colorCache||(this._colorCache=new s(10));var t=this._colorCache.get(e);return t||(t=n.parse(e),this._colorCache.put(e,t),t[0]/=255,t[1]/=255,t[2]/=255),t},getMarkCoord:function(e,t,r){r._array[0]=t.x,r._array[1]=t.y,r._array[2]=t.z},getMarkPointTransform:function(e,t,r){h.identity(r);var i=new o;this.getMarkCoord(e,t,i);var a=r._array;a[12]=i.x,a[13]=i.y,a[14]=i.z},getMarkBarPoints:function(e,t,r,i){var a=null!=t.barHeight?t.barHeight:1;"function"==typeof a&&(a=a(t)),this.getMarkCoord(e,t,r),o.scaleAndAdd(i,i,r,1)},getMarkLinePoints:function(e,t,r,i,a,n){var s=!!a;s||(n=i),this.getMarkCoord(e,t[0],r),this.getMarkCoord(e,t[1],n),s&&(o.copy(i,r),o.copy(a,n))},getSerieLabelText:function(e,t,r,i){var a=this.deepQuery([t,e],"itemStyle."+i+".label.formatter");a||"emphasis"!==i||(a=this.deepQuery([t,e],"itemStyle.normal.label.formatter"));var n=this.getDataFromOption(t,"-");return a?"function"==typeof a?a.call(this.myChart,{seriesName:e.name,series:e,name:r,value:n,data:t,status:i}):"string"==typeof a?a=a.replace("{a}","{a0}").replace("{b}","{b0}").replace("{c}","{c0}").replace("{a0}",e.name).replace("{b0}",r).replace("{c0}",this.numAddCommas(n)):void 0:n instanceof Array?null!=n[2]?this.numAddCommas(n[2]):n[0]+" , "+n[1]:this.numAddCommas(n)
},onlegendSelected:function(e,t){var r=e.selected;for(var i in this.selectedMap)this.selectedMap[i]!=r[i]&&(t.needRefresh=!0),this.selectedMap[i]=r[i]},disposeMark:function(){for(var e in this._markers){for(var t=this._markers[e],r=0;t.list.length>r;r++)this._disposeSingleSerieMark(t.list[r]);t.list.length=t.count=0}},dispose:function(){a.prototype.dispose.call(this),this.disposeMark()},onframe:function(e){for(var t in this._markers)for(var r=this._markers[t],i=0;r.count>i;i++)r.list[i].onframe(e)}},i.inherits(t,a),t}),define("echarts-x/util/OrbitControl",["require","zrender/config","qtek/math/Vector2","qtek/math/Vector3","qtek/math/Quaternion"],function(e){"use strict";var t=e("zrender/config"),r=e("qtek/math/Vector2"),i=e("qtek/math/Vector3"),a=e("qtek/math/Quaternion"),n=t.EVENT,s=function(e,t,a){this.zr=t,this.layer=a,this.target=e;var n=!1;Object.defineProperty(this,"autoRotate",{get:function(){return n},set:function(e){n=e,this._rotating=n}}),this.minZoom=.5,this.maxZoom=1.5,this.autoRotateAfterStill=0,this.mode="rotate",this._rotating=!1,this._rotateY=0,this._rotateX=0,this._mouseX=0,this._mouseY=0,this._rotateVelocity=new r,this._panVelocity=new r,this._cameraStartPos=new i,this._zoom=1,this._zoomSpeed=0,this._animating=!1,this._stillTimeout=0,this._animators=[]};return s.prototype={constructor:s,init:function(){this._animating=!1,this.layer.bind(n.MOUSEDOWN,this._mouseDownHandler,this),this.layer.bind(n.MOUSEWHEEL,this._mouseWheelHandler,this),this._rotating=this.autoRotate,i.copy(this._cameraStartPos,this.layer.camera.position),this._decomposeRotation()},dispose:function(){this.layer.unbind(n.MOUSEDOWN,this._mouseDownHandler),this.layer.unbind(n.MOUSEMOVE,this._mouseMoveHandler),this.layer.unbind(n.MOUSEUP,this._mouseUpHandler),this.layer.unbind(n.MOUSEWHEEL,this._mouseWheelHandler),this.stopAllAnimation()},getZoom:function(){return this._zoom},setZoom:function(e){this._zoom=e,this.zr.refreshNextFrame()},rotateTo:function(e){var t,r=this;if(e.rotation)t=e.rotation;else{t=new a;var n=new i;i.negate(n,e.z),t.setAxes(n,e.x,e.y)}var s=this.zr,o={p:0},h=this.target,u=h.rotation.clone();return this._animating=!0,this._addAnimator(s.animation.animate(o).when(e.time||1e3,{p:1}).during(function(){a.slerp(h.rotation,u,t,o.p),s.refreshNextFrame()}).done(function(){r._animating=!1,r._decomposeRotation()}).start(e.easing||"Linear"))},zoomTo:function(e){var t=this.zr,r=e.zoom,i=this;return r=Math.max(Math.min(this.maxZoom,r),this.minZoom),this._animating=!0,this._addAnimator(t.animation.animate(this).when(e.time||1e3,{_zoom:r}).during(function(){i._setZoom(i._zoom),t.refreshNextFrame()}).done(function(){i._animating=!1}).start(e.easing||"Linear"))},stopAllAnimation:function(){for(var e=0;this._animators.length>e;e++)this._animators[e].stop();this._animators.length=0,this._animating=!1},moveTo:function(e){var t=this.zr,r=e.position,i=this;return this._animating=!0,this._addAnimator(t.animation.animate(this.target.position).when(e.time||1e3,{x:r.x,y:r.y,z:r.z}).during(function(){t.refreshNextFrame()}).done(function(){i._animating=!1}).start(e.easing||"Linear"))},update:function(e){this._animating||("rotate"===this.mode?this._updateRotate(e):"pan"===this.mode&&this._updatePan(e),this._updateZoom(e))},_updateRotate:function(e){var t=this._rotateVelocity;this._rotateY=(t.y+this._rotateY)%(2*Math.PI),this._rotateX=(t.x+this._rotateX)%(2*Math.PI),this._rotateX=Math.max(Math.min(this._rotateX,Math.PI/2),-Math.PI/2),this.target.rotation.identity().rotateX(this._rotateX).rotateY(this._rotateY),this._vectorDamping(t,.8),this._rotating?(this._rotateY-=1e-4*e,this.zr.refreshNextFrame()):t.len()>0&&this.zr.refreshNextFrame()},_updateZoom:function(){this._setZoom(this._zoom+this._zoomSpeed),this._zoomSpeed*=.8,Math.abs(this._zoomSpeed)>.001&&this.zr.refreshNextFrame()},_setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom);var e=this._zoom,t=this.layer.camera,r=this._cameraStartPos.len()*e;t.position.normalize().scale(r)},_updatePan:function(){var e=this._panVelocity,t=this.target,r=t.worldTransform.y,i=t.worldTransform.x,a=this.layer.camera.position.len();t.position.scaleAndAdd(i,e.x*a/400).scaleAndAdd(r,e.y*a/400),this._vectorDamping(e,.8),e.len()>0&&this.zr.refreshNextFrame()},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout(function(){t._rotating=!0},1e3*e))},_vectorDamping:function(e,t){var r=e.len();r*=t,1e-4>r&&(r=0),e.normalize().scale(r)},_decomposeRotation:function(){var e=new i;e.eulerFromQuaternion(this.target.rotation.normalize(),"ZXY"),this._rotateX=e.x,this._rotateY=e.y},_mouseDownHandler:function(e){this._animating||(this.layer.bind(n.MOUSEMOVE,this._mouseMoveHandler,this),this.layer.bind(n.MOUSEUP,this._mouseUpHandler,this),e=e.event,"rotate"===this.mode&&(this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill()),this._mouseX=e.pageX,this._mouseY=e.pageY)},_mouseMoveHandler:function(e){this._animating||(e=e.event,"rotate"===this.mode?(this._rotateVelocity.y=(e.pageX-this._mouseX)/500,this._rotateVelocity.x=(e.pageY-this._mouseY)/500):"pan"===this.mode&&(this._panVelocity.x=e.pageX-this._mouseX,this._panVelocity.y=-e.pageY+this._mouseY),this._mouseX=e.pageX,this._mouseY=e.pageY)},_mouseWheelHandler:function(e){if(!this._animating){e=e.event;var t=e.wheelDelta||-e.detail;this._zoomSpeed=t>0?this._zoom/20:-this._zoom/20,this._rotating=!1,this.autoRotate&&"rotate"===this.mode&&this._startCountingStill()}},_mouseUpHandler:function(){this.layer.unbind(n.MOUSEMOVE,this._mouseMoveHandler,this),this.layer.unbind(n.MOUSEUP,this._mouseUpHandler,this)},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done(function(){var r=t.indexOf(e);r>=0&&t.splice(r,1)}),e}},s}),define("echarts-x/surface/ZRenderSurface",["require","zrender/Storage","qtek/Texture2D","qtek/math/Vector3","qtek/math/Vector2"],function(e){var t=e("zrender/Storage"),r=e("qtek/Texture2D"),i=e("qtek/math/Vector3"),a=e("qtek/math/Vector2"),n=function(e,i){this.onrefresh=function(){},this._storage=new t,this._canvas=document.createElement("canvas"),this._width=e||512,this._height=i||512,this._canvas.width=this._width,this._canvas.height=this._height,this._ctx=this._canvas.getContext("2d"),this._texture=new r({image:this._canvas,anisotropic:32,flipY:!1}),this.refreshNextTick=this.refreshNextTick.bind(this)};return n.prototype={constructor:n,backgroundColor:"",backgroundImage:null,addElement:function(e){this._storage.addRoot(e)},delElement:function(e){this._storage.delRoot(e)},clearElements:function(){this._storage.delRoot()},getTexture:function(){return this._texture},resize:function(e,t){(this._width!==e||this._height!==t)&&(this._width=e,this._height=t,this._canvas.width=e,this._canvas.height=t,this.refresh())},getWidth:function(){return this._width},getHeight:function(){return this._height},refresh:function(){var e=this._ctx;e.clearRect(0,0,this._width,this._height),this.backgroundColor&&(e.fillStyle=this.backgroundColor,e.fillRect(0,0,this._width,this._height));var t=this.backgroundImage;t&&t.width&&t.height&&e.drawImage(this.backgroundImage,0,0,this._width,this._height);for(var r=this._storage.getShapeList(!0),i=0;r.length>i;i++){var a=r[i];a.invisible||a.brush(e,a.isHighlight,this.refreshNextTick)}this._texture.dirty(),this.onrefresh&&this.onrefresh()},refreshNextTick:function(){var e;return function(){var t=this;e&&clearTimeout(e),e=setTimeout(function(){t.refresh()},16)}}(),hover:function(e,t){var r,i=this._storage.getShapeList();if("number"==typeof e)r=this.pickByCoord(e,t);else{var a=e;r=this.pick(a.target,a.face,a.point,i)}for(var n=!1,s=0;i.length>s;s++)i[s].isHighlight=!1,i[s].zlevel=0,(i[s]==r&&!i[s].isHighlight||i[s]!=r&&i[s].isHighlight)&&(n=!0);return r&&(r.isHighlight=!0,r.zlevel=10),n&&this.refreshNextTick(),r},getShapeByName:function(e){for(var t=this._storage.getShapeList(),r=0;t.length>r;r++)if(t[r].name===e)return t[r]},pick:function(){var e=new i,t=new i,r=new i,n=new a,s=new a,o=new a,h=new a,u=new i;return function(l,c,d,f){var m=l.geometry,_=m.attributes.position,p=m.attributes.texcoord0,g=i.dot,y=i.cross;_.get(c[0],e),_.get(c[1],t),_.get(c[2],r),p.get(c[0],n),p.get(c[1],s),p.get(c[2],o),y(u,t,r);var v=g(e,u),b=g(d,u)/v;y(u,r,e);var x=g(d,u)/v;y(u,e,t);var T=g(d,u)/v;a.scale(h,n,b),a.scaleAndAdd(h,h,s,x),a.scaleAndAdd(h,h,o,T);var w=h.x*this._width,S=h.y*this._height;return this.pickByCoord(w,S,f)}}(),pickByCoord:function(e,t,r){for(var r=r||this._storage.getShapeList(),i=r.length-1;i>=0;i--){var a=r[i];if(!a.isSilent()&&a.isCover(e,t))return a}}},n}),define("echarts-x/surface/VectorFieldParticleSurface",["require","qtek/compositor/Pass","qtek/StaticGeometry","qtek/Mesh","qtek/Material","qtek/Shader","qtek/Texture2D","qtek/core/glenum","qtek/camera/Orthographic","qtek/Scene","qtek/FrameBuffer","../util/sprite"],function(e){var t=e("qtek/compositor/Pass"),r=e("qtek/StaticGeometry"),i=e("qtek/Mesh"),a=e("qtek/Material"),n=e("qtek/Shader"),s=e("qtek/Texture2D"),o=e("qtek/core/glenum"),h=e("qtek/camera/Orthographic"),u=e("qtek/Scene"),l=e("qtek/FrameBuffer"),c=e("../util/sprite"),d=function(e){this.renderer=e,this.motionBlurFactor=.99,this.vectorFieldTexture=null,this.particleLife=[10,20],this.particleSizeScaling=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this.surfaceTexture=null,this.surfaceMesh=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particleMesh=null,this._frameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._motionBlurPass=null,this._thisFrameTexture=null,this._lastFrameTexture=null};return d.prototype={constructor:d,init:function(e,d){var f=new r({mainAttribute:"texcoord0"}),m=e*d,_=f.attributes;_.texcoord0.init(m);for(var p=new Float32Array(4*m),g=0,y=this.particleLife,v=0;e>v;v++)for(var b=0;d>b;b++,g++){_.texcoord0.value[2*g]=v/e,_.texcoord0.value[2*g+1]=b/d,p[4*g]=Math.random(),p[4*g+1]=Math.random(),p[4*g+2]=Math.random();var x=(y[1]-y[0])*Math.random()+y[0];p[4*g+3]=x}var T={width:e,height:d,type:o.FLOAT,minFilter:o.NEAREST,magFilter:o.NEAREST,wrapS:o.REPEAT,wrapT:o.REPEAT,useMipmap:!1};this._spawnTexture=new s(T),this._spawnTexture.pixels=p,this._particleTexture0=new s(T),this._particleTexture1=new s(T),this._frameBuffer=new l,this._particlePass=new t({fragment:n.source("ecx.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._particlePass.setUniform("speedScaling",this.particleSpeedScaling),this._motionBlurPass=new t({fragment:n.source("ecx.motionBlur.fragment")}),this._motionBlurPass.setUniform("percent",this.motionBlurFactor);var w=new i({material:new a({shader:new n({vertex:n.source("ecx.vfParticle.renderPoints.vertex"),fragment:n.source("ecx.vfParticle.renderPoints.fragment")})}),mode:o.POINTS,geometry:f});w.material.set("spriteTexture",new s({image:c.makeSimpleSprite(128)})),w.material.set("sizeScaling",this.particleSizeScaling*this.renderer.getDevicePixelRatio()),w.material.set("color",this.particleColor),this._particleMesh=w,this._scene=new u,this._scene.add(this._particleMesh),this._camera=new h,this.surfaceTexture||(this.surfaceTexture=new s({width:1024,height:1024}));var S=this.surfaceTexture.width,k=this.surfaceTexture.height;this._lastFrameTexture=new s({width:S,height:k}),this._thisFrameTexture=new s({width:S,height:k})},update:function(e){var t=this._frameBuffer,r=this._particlePass,i=this._motionBlurPass;r.attachOutput(this._particleTexture1),r.setUniform("particleTexture",this._particleTexture0),r.setUniform("deltaTime",e),r.setUniform("elapsedTime",this._elapsedTime),r.render(this.renderer,t),this._particleMesh.material.set("particleTexture",this._particleTexture1),t.attach(this.renderer.gl,this._thisFrameTexture),t.bind(this.renderer),this.renderer.render(this._scene,this._camera),t.unbind(this.renderer),i.attachOutput(this.surfaceTexture),i.setUniform("lastFrame",this._lastFrameTexture),i.setUniform("thisFrame",this._thisFrameTexture),i.render(this.renderer,t),this._swapTexture(),this.surfaceMesh&&this.surfaceMesh.material.set("diffuseMap",this.surfaceTexture),this._elapsedTime+=e},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;var e=this.surfaceTexture;this.surfaceTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(){var e=this.renderer;e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeScene(this._scene)}},d}),define("echarts-x/util/sunCalc",[],function(){"use strict";function e(e){return e.valueOf()/g-.5+y}function t(t){return e(t)-v}function r(e,t){return _(c(e)*d(b)-f(t)*c(b),d(e))}function i(e,t){return m(c(t)*d(b)+d(t)*c(b)*c(e))}function a(e,t,r){return _(c(e),d(e)*c(t)-f(r)*d(t))}function n(e,t,r){return m(c(t)*c(r)+d(t)*d(r)*d(e))}function s(e,t){return p*(280.16+360.9856235*e)-t}function o(e){return p*(357.5291+.98560028*e)}function h(e){var t=p*(1.9148*c(e)+.02*c(2*e)+3e-4*c(3*e)),r=102.9372*p;return e+t+r+l}function u(e){var t=o(e),a=h(t);return{dec:i(a,0),ra:r(a,0)}}var l=Math.PI,c=Math.sin,d=Math.cos,f=Math.tan,m=Math.asin,_=Math.atan2,p=l/180,g=864e5,y=2440588,v=2451545,b=23.4397*p,x={};return x.getPosition=function(e,r,i){var o=p*-i,h=p*r,l=t(e),c=u(l),d=s(l,o)-c.ra;return{azimuth:a(d,h,c.dec),altitude:n(d,h,c.dec)}},x}()),define("qtek/core/LRU",["require","./LinkedList"],function(e){"use strict";var t=e("./LinkedList"),r=function(e){this._list=new t,this._map={},this._maxSize=e||10};return r.prototype.setMaxSize=function(e){this._maxSize=e},r.prototype.put=function(e,t){if(void 0===this._map[e]){var r=this._list.length();if(r>=this._maxSize&&r>0){var i=this._list.head;this._list.remove(i),delete this._map[i.key]}var a=this._list.insert(t);a.key=e,this._map[e]=a}},r.prototype.get=function(e){var t=this._map[e];return void 0!==t?(t!==this._list.tail&&(this._list.remove(t),this._list.insertEntry(t)),t.value):void 0},r.prototype.remove=function(e){var t=this._map[e];void 0!==t&&(delete this._map[e],this._list.remove(t))},r.prototype.clear=function(){this._list.clear(),this._map={}},r}),define("qtek/Light",["require","./Node","./Shader","./light/light.essl"],function(e){"use strict";var t=e("./Node"),r=e("./Shader"),i=t.derive(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512}},{type:"",clone:function(){var e=t.prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}});return r["import"](e("./light/light.essl")),i}),define("qtek/light/light.essl",function(){return"@export buildin.header.directional_light\nuniform vec3 directionalLightDirection[ DIRECTIONAL_LIGHT_NUMBER ] : unconfigurable;\nuniform vec3 directionalLightColor[ DIRECTIONAL_LIGHT_NUMBER ] : unconfigurable;\n@end\n\n@export buildin.header.ambient_light\nuniform vec3 ambientLightColor[ AMBIENT_LIGHT_NUMBER ] : unconfigurable;\n@end\n\n@export buildin.header.point_light\nuniform vec3 pointLightPosition[ POINT_LIGHT_NUMBER ] : unconfigurable;\nuniform float pointLightRange[ POINT_LIGHT_NUMBER ] : unconfigurable;\nuniform vec3 pointLightColor[ POINT_LIGHT_NUMBER ] : unconfigurable;\n@end\n\n@export buildin.header.spot_light\nuniform vec3 spotLightPosition[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform vec3 spotLightDirection[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightRange[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightUmbraAngleCosine[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightPenumbraAngleCosine[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightFalloffFactor[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform vec3 spotLightColor[SPOT_LIGHT_NUMBER] : unconfigurable;\n@end"}),define("qtek/math/Ray",["require","./Vector3","../dep/glmatrix"],function(e){"use strict";var t=e("./Vector3"),r=e("../dep/glmatrix"),i=r.vec3,a=1e-5,n=function(e,r){this.origin=e||new t,this.direction=r||new t};return n.prototype={constructor:n,intersectPlane:function(e,r){var a=e.normal._array,n=e.distance,s=this.origin._array,o=this.direction._array,h=i.dot(a,o);if(0===h)return null;r||(r=new t);var u=(i.dot(a,s)-n)/h;return i.scaleAndAdd(r._array,s,o,-u),r._dirty=!0,r},mirrorAgainstPlane:function(e){var t=i.dot(e.normal._array,this.direction._array);i.scaleAndAdd(this.direction._array,this.direction._array,e.normal._array,2*-t),this.direction._dirty=!0},distanceToPoint:function(){var e=i.create();return function(t){i.sub(e,t,this.origin._array);var r=i.dot(e,this.direction._array);if(0>r)return i.distance(this.origin._array,t);var a=i.lenSquared(e);return Math.sqrt(a-r*r)}}(),intersectSphere:function(){var e=i.create();return function(r,a,n){var s=this.origin._array,o=this.direction._array;r=r._array,i.sub(e,r,s);var h=i.dot(e,o),u=i.squaredLength(e),l=u-h*h,c=a*a;if(!(l>c)){var d=Math.sqrt(c-l),f=h-d,m=h+d;return n||(n=new t),0>f?0>m?null:(i.scaleAndAdd(n._array,s,o,m),n):(i.scaleAndAdd(n._array,s,o,f),n)}}}(),intersectBoundingBox:function(e,r){var a,n,s,o,h,u,l=this.direction._array,c=this.origin._array,d=e.min._array,f=e.max._array,m=1/l[0],_=1/l[1],p=1/l[2];if(m>=0?(a=(d[0]-c[0])*m,n=(f[0]-c[0])*m):(n=(d[0]-c[0])*m,a=(f[0]-c[0])*m),_>=0?(s=(d[1]-c[1])*_,o=(f[1]-c[1])*_):(o=(d[1]-c[1])*_,s=(f[1]-c[1])*_),a>o||s>n)return null;if((s>a||a!==a)&&(a=s),(n>o||n!==n)&&(n=o),p>=0?(h=(d[2]-c[2])*p,u=(f[2]-c[2])*p):(u=(d[2]-c[2])*p,h=(f[2]-c[2])*p),a>u||h>n)return null;if((h>a||a!==a)&&(a=h),(n>u||n!==n)&&(n=u),0>n)return null;var g=a>=0?a:n;return r||(r=new t),i.scaleAndAdd(r._array,c,l,g),r},intersectTriangle:function(){var e=i.create(),r=i.create(),n=i.create(),s=i.create();return function(o,h,u,l,c,d){var f=this.direction._array,m=this.origin._array;o=o._array,h=h._array,u=u._array,i.sub(e,h,o),i.sub(r,u,o),i.cross(s,r,f);var _=i.dot(e,s);if(l){if(_>-a)return null}else if(_>-a&&a>_)return null;i.sub(n,m,o);var p=i.dot(s,n)/_;if(0>p||p>1)return null;i.cross(s,e,n);var g=i.dot(f,s)/_;if(0>g||g>1||p+g>1)return null;i.cross(s,e,r);var y=-i.dot(n,s)/_;return 0>y?null:(c||(c=new t),d&&t.set(d,1-p-g,p,g),i.scaleAndAdd(c._array,m,f,y),c)}}(),applyTransform:function(e){t.add(this.direction,this.direction,this.origin),t.transformMat4(this.origin,this.origin,e),t.transformMat4(this.direction,this.direction,e),t.sub(this.direction,this.direction,this.origin),t.normalize(this.direction,this.direction)},copy:function(e){t.copy(this.origin,e.origin),t.copy(this.direction,e.direction)},clone:function(){var e=new n;return e.copy(this),e}},n}),define("qtek/math/Vector2",["require","../dep/glmatrix"],function(e){"use strict";var t=e("../dep/glmatrix"),r=t.vec2,i=function(e,t){e=e||0,t=t||0,this._array=r.fromValues(e,t),this._dirty=!0};if(i.prototype={constructor:i,add:function(e){return r.add(this._array,this._array,e._array),this._dirty=!0,this},set:function(e,t){return this._array[0]=e,this._array[1]=t,this._dirty=!0,this},setArray:function(e){return this._array[0]=e[0],this._array[1]=e[1],this._dirty=!0,this},clone:function(){return new i(this.x,this.y)},copy:function(e){return r.copy(this._array,e._array),this._dirty=!0,this},cross:function(e,t){return r.cross(e._array,this._array,t._array),e._dirty=!0,this},dist:function(e){return r.dist(this._array,e._array)},distance:function(e){return r.distance(this._array,e._array)},div:function(e){return r.div(this._array,this._array,e._array),this._dirty=!0,this},divide:function(e){return r.divide(this._array,this._array,e._array),this._dirty=!0,this},dot:function(e){return r.dot(this._array,e._array)},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(e,t,i){return r.lerp(this._array,e._array,t._array,i),this._dirty=!0,this},min:function(e){return r.min(this._array,this._array,e._array),this._dirty=!0,this},max:function(e){return r.max(this._array,this._array,e._array),this._dirty=!0,this},mul:function(e){return r.mul(this._array,this._array,e._array),this._dirty=!0,this},multiply:function(e){return r.multiply(this._array,this._array,e._array),this._dirty=!0,this},negate:function(){return r.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},random:function(e){return r.random(this._array,e),this._dirty=!0,this},scale:function(e){return r.scale(this._array,this._array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return r.scaleAndAdd(this._array,this._array,e._array,t),this._dirty=!0,this},sqrDist:function(e){return r.sqrDist(this._array,e._array)},squaredDistance:function(e){return r.squaredDistance(this._array,e._array)},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},sub:function(e){return r.sub(this._array,this._array,e._array),this._dirty=!0,this},subtract:function(e){return r.subtract(this._array,this._array,e._array),this._dirty=!0,this},transformMat2:function(e){return r.transformMat2(this._array,this._array,e._array),this._dirty=!0,this},transformMat2d:function(e){return r.transformMat2d(this._array,this._array,e._array),this._dirty=!0,this},transformMat3:function(e){return r.transformMat3(this._array,this._array,e._array),this._dirty=!0,this},transformMat4:function(e){return r.transformMat4(this._array,this._array,e._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var a=i.prototype;Object.defineProperty(a,"x",{get:function(){return this._array[0]},set:function(e){this._array[0]=e,this._dirty=!0}}),Object.defineProperty(a,"y",{get:function(){return this._array[1]},set:function(e){this._array[1]=e,this._dirty=!0}})}return i.add=function(e,t,i){return r.add(e._array,t._array,i._array),e._dirty=!0,e},i.set=function(e,t,i){return r.set(e._array,t,i),e._dirty=!0,e},i.copy=function(e,t){return r.copy(e._array,t._array),e._dirty=!0,e},i.cross=function(e,t,i){return r.cross(e._array,t._array,i._array),e._dirty=!0,e},i.dist=function(e,t){return r.distance(e._array,t._array)},i.distance=i.dist,i.div=function(e,t,i){return r.divide(e._array,t._array,i._array),e._dirty=!0,e},i.divide=i.div,i.dot=function(e,t){return r.dot(e._array,t._array)},i.len=function(e){return r.length(e._array)},i.lerp=function(e,t,i,a){return r.lerp(e._array,t._array,i._array,a),e._dirty=!0,e},i.min=function(e,t,i){return r.min(e._array,t._array,i._array),e._dirty=!0,e},i.max=function(e,t,i){return r.max(e._array,t._array,i._array),e._dirty=!0,e},i.mul=function(e,t,i){return r.multiply(e._array,t._array,i._array),e._dirty=!0,e},i.multiply=i.mul,i.negate=function(e,t){return r.negate(e._array,t._array),e._dirty=!0,e},i.normalize=function(e,t){return r.normalize(e._array,t._array),e._dirty=!0,e},i.random=function(e,t){return r.random(e._array,t),e._dirty=!0,e},i.scale=function(e,t,i){return r.scale(e._array,t._array,i),e._dirty=!0,e},i.scaleAndAdd=function(e,t,i,a){return r.scaleAndAdd(e._array,t._array,i._array,a),e._dirty=!0,e},i.sqrDist=function(e,t){return r.sqrDist(e._array,t._array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(e){return r.sqrLen(e._array)},i.squaredLength=i.sqrLen,i.sub=function(e,t,i){return r.subtract(e._array,t._array,i._array),e._dirty=!0,e},i.subtract=i.sub,i.transformMat2=function(e,t,i){return r.transformMat2(e._array,t._array,i._array),e._dirty=!0,e},i.transformMat2d=function(e,t,i){return r.transformMat2d(e._array,t._array,i._array),e._dirty=!0,e},i.transformMat3=function(e,t,i){return r.transformMat3(e._array,t._array,i._array),e._dirty=!0,e},i.transformMat4=function(e,t,i){return r.transformMat4(e._array,t._array,i._array),e._dirty=!0,e},i}),define("qtek/StaticGeometry",["require","./Geometry","./math/BoundingBox","./dep/glmatrix","./core/glenum"],function(e){"use strict";var t=e("./Geometry"),r=e("./math/BoundingBox"),i=e("./dep/glmatrix"),a=e("./core/glenum"),n=i.mat4,s=i.vec3,o=t.derive(function(){return{attributes:{position:new t.Attribute("position","float",3,"POSITION",!1),texcoord0:new t.Attribute("texcoord0","float",2,"TEXCOORD_0",!1),texcoord1:new t.Attribute("texcoord1","float",2,"TEXCOORD_1",!1),normal:new t.Attribute("normal","float",3,"NORMAL",!1),tangent:new t.Attribute("tangent","float",4,"TANGENT",!1),color:new t.Attribute("color","float",4,"COLOR",!1),weight:new t.Attribute("weight","float",3,"WEIGHT",!1),joint:new t.Attribute("joint","float",4,"JOINT",!1),barycentric:new t.Attribute("barycentric","float",3,null,!1)},hint:a.STATIC_DRAW,faces:null,_normalType:"vertex",_enabledAttributes:null}},{dirty:function(){this._cache.dirtyAll(),this._enabledAttributes=null},getVertexNumber:function(){var e=this.attributes[this.mainAttribute];return e&&e.value?e.value.length/e.size:0},getFaceNumber:function(){return this.faces?this.faces.length/3:0},getFace:function(e,t){return this.getFaceNumber()>e&&e>=0?(t||(t=s.create()),t[0]=this.faces[3*e],t[1]=this.faces[3*e+1],t[2]=this.faces[3*e+2],t):void 0},isUseFace:function(){return this.useFace&&null!=this.faces},createAttribute:function(e,r,i,a){var n=new t.Attribute(e,r,i,a,!1);return this.attributes[e]=n,this._attributeList.push(e),n},removeAttribute:function(e){var t=this._attributeList.indexOf(e);return t>=0?(this._attributeList.splice(t,1),delete this.attributes[e],!0):!1},getEnabledAttributes:function(){if(this._enabledAttributes)return this._enabledAttributes;for(var e=[],t=this.getVertexNumber(),r=0;this._attributeList.length>r;r++){var i=this._attributeList[r],a=this.attributes[i];a.value&&a.value.length===t*a.size&&e.push(i)}return this._enabledAttributes=e,e},getBufferChunks:function(e){return this._cache.use(e.__GLID__),this._cache.isDirty()&&(this._updateBuffer(e),this._cache.fresh()),this._cache.get("chunks")},_updateBuffer:function(e){var r=this._cache.get("chunks"),i=!1;r||(r=[],r[0]={attributeBuffers:[],indicesBuffer:null},this._cache.put("chunks",r),i=!0);for(var a=r[0],n=a.attributeBuffers,s=a.indicesBuffer,o=this.getEnabledAttributes(),h=0,u=0,l=0;o.length>l;l++){var c,d=o[l],f=this.attributes[d];if(!i){for(var m=h;n.length>m;m++)if(n[m].name===d){c=n[m],h=m+1;break}if(!c)for(var m=h-1;m>=0;m--)if(n[m].name===d){c=n[m],h=m;break}}var _;_=c?c.buffer:e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,_),e.bufferData(e.ARRAY_BUFFER,f.value,this.hint),n[u++]=new t.AttributeBuffer(d,f.type,_,f.size,f.semantic)}n.length=u,this.isUseFace()&&(s||(s=new t.IndicesBuffer(e.createBuffer()),a.indicesBuffer=s),s.count=this.faces.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.faces,this.hint))},generateVertexNormals:function(){var e=this.faces,t=this.attributes.position.value,r=this.attributes.normal.value;if(r&&r.length===t.length)for(var i=0;r.length>i;i++)r[i]=0;else r=this.attributes.normal.value=new Float32Array(t.length);for(var a=s.create(),n=s.create(),o=s.create(),h=s.create(),u=s.create(),l=s.create(),c=0;e.length>c;){var d=e[c++],f=e[c++],m=e[c++];s.set(a,t[3*d],t[3*d+1],t[3*d+2]),s.set(n,t[3*f],t[3*f+1],t[3*f+2]),s.set(o,t[3*m],t[3*m+1],t[3*m+2]),s.sub(h,a,n),s.sub(u,n,o),s.cross(l,h,u);for(var i=0;3>i;i++)r[3*d+i]=r[3*d+i]+l[i],r[3*f+i]=r[3*f+i]+l[i],r[3*m+i]=r[3*m+i]+l[i]}for(var i=0;r.length>i;)s.set(l,r[i],r[i+1],r[i+2]),s.normalize(l,l),r[i++]=l[0],r[i++]=l[1],r[i++]=l[2]},generateFaceNormals:function(){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.faces,t=this.attributes.position.value,r=this.attributes.normal.value,i=s.create(),a=s.create(),n=s.create(),o=s.create(),h=s.create(),u=s.create();r||(r=this.attributes.position.value=new Float32Array(t.length));for(var l=0;e.length>l;){var c=e[l++],d=e[l++],f=e[l++];s.set(i,t[3*c],t[3*c+1],t[3*c+2]),s.set(a,t[3*d],t[3*d+1],t[3*d+2]),s.set(n,t[3*f],t[3*f+1],t[3*f+2]),s.sub(o,i,a),s.sub(h,a,n),s.cross(u,o,h),s.normalize(u,u);for(var m=0;3>m;m++)r[3*c+m]=u[m],r[3*d+m]=u[m],r[3*f+m]=u[m]}},generateTangents:function(){var e=this.getVertexNumber();this.attributes.tangent.value||(this.attributes.tangent.value=new Float32Array(4*e));for(var t=this.attributes.texcoord0.value,r=this.attributes.position.value,i=this.attributes.tangent.value,a=this.attributes.normal.value,n=[],o=[],h=0;e>h;h++)n[h]=[0,0,0],o[h]=[0,0,0];for(var u=[0,0,0],l=[0,0,0],h=0;this.faces.length>h;){var c=this.faces[h++],d=this.faces[h++],f=this.faces[h++],m=t[2*c],_=t[2*d],p=t[2*f],g=t[2*c+1],y=t[2*d+1],v=t[2*f+1],b=r[3*c],x=r[3*d],T=r[3*f],w=r[3*c+1],S=r[3*d+1],k=r[3*f+1],E=r[3*c+2],R=r[3*d+2],M=r[3*f+2],P=x-b,N=T-b,L=S-w,A=k-w,C=R-E,q=M-E,I=_-m,O=p-m,B=y-g,z=v-g,F=1/(I*z-B*O);u[0]=(z*P-B*N)*F,u[1]=(z*L-B*A)*F,u[2]=(z*C-B*q)*F,l[0]=(I*N-O*P)*F,l[1]=(I*A-O*L)*F,l[2]=(I*q-O*C)*F,s.add(n[c],n[c],u),s.add(n[d],n[d],u),s.add(n[f],n[f],u),s.add(o[c],o[c],l),s.add(o[d],o[d],l),s.add(o[f],o[f],l)}for(var D=s.create(),V=s.create(),U=s.create(),h=0;e>h;h++){U[0]=a[3*h],U[1]=a[3*h+1],U[2]=a[3*h+2];var H=n[h];s.scale(D,U,s.dot(U,H)),s.sub(D,H,D),s.normalize(D,D),s.cross(V,U,H),i[4*h]=D[0],i[4*h+1]=D[1],i[4*h+2]=D[2],i[4*h+3]=0>s.dot(V,o[h])?-1:1}},isUniqueVertex:function(){return this.isUseFace()?this.getVertexNumber()===this.faces.length:!0},generateUniqueVertex:function(){for(var e=[],t=0,r=this.getVertexNumber();r>t;t++)e[t]=0;for(var i=this.getVertexNumber(),a=this.attributes,n=this.faces,s=this.getEnabledAttributes(),o=0;s.length>o;o++){for(var h=s[o],u=new Float32Array(this.faces.length*a[h].size),r=a[h].value.length,t=0;r>t;t++)u[t]=a[h].value[t];a[h].value=u}for(var t=0;n.length>t;t++){var l=n[t];if(e[l]>0){for(var o=0;s.length>o;o++)for(var h=s[o],c=a[h].value,d=a[h].size,f=0;d>f;f++)c[i*d+f]=c[l*d+f];n[t]=i,i++}e[l]++}},generateBarycentric:function(){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes.barycentric.value;if(!e||e.length!==3*this.faces.length){e=this.attributes.barycentric.value=new Float32Array(3*this.faces.length);for(var t=0;this.faces.length>t;)for(var r=0;3>r;r++){var i=this.faces[t++];e[i+r]=1}}},convertToDynamic:function(e){for(var t=0;this.faces.length>t;t+=3)e.faces.push(this.face.subarray(t,t+3));var i=this.getEnabledAttributes();for(var a in i){var n=i[a],s=e.attributes[a];s||(s=e.attributes[a]={type:n.type,size:n.size,value:[]},n.semantic&&(s.semantic=n.semantic));for(var t=0;n.value.length>t;t+=n.size)s.value.push(1===n.size?n.array[t]:n.subarray(t,t+n.size))}return this.boundingBox&&(e.boundingBox=new r,e.boundingBox.min.copy(this.boundingBox.min),e.boundingBox.max.copy(this.boundingBox.max)),e},applyTransform:function(e){var t=this.attributes.position.value,r=this.attributes.normal.value,i=this.attributes.tangent.value;e=e._array;var a=n.create();n.invert(a,e),n.transpose(a,a),s.forEach(t,3,0,null,s.transformMat4,e),r&&s.forEach(r,3,0,null,s.transformMat4,a),i&&s.forEach(i,4,0,null,s.transformMat4,a),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){this._cache.use(e.__GLID__);var t=this._cache.get("chunks");if(t)for(var r=0;t.length>r;r++)for(var i=t[r],a=0;i.attributeBuffers.length>a;a++){var n=i.attributeBuffers[a];e.deleteBuffer(n.buffer)}this._cache.deleteContext(e.__GLID__)}});return o}),define("echarts-x/component/base3d",["require","echarts/component/base","../core/Layer3D","zrender/tool/util"],function(e){"use strict";var t=e("echarts/component/base"),r=e("../core/Layer3D"),i=e("zrender/tool/util"),a=function(e,i,a,n,s){t.call(this,e,i,a,n,s);var o=this.getZlevelBase();this.baseLayer=new r(o,this.zr.painter),this.zr.painter.insertLayer(o,this.baseLayer),this.zr.animation.bind("frame",this.onframe,this)};return a.prototype={constructor:a,onframe:function(){},dispose:function(){this.zr.animation.unbind("frame",this.onframe)
}},i.inherits(a,t),a}),define("echarts-x/util/color",[],function(){function e(e){return e=Math.round(e),0>e?0:e>255?255:e}function t(e){return 0>e?0:e>1?1:e}function r(t){return e("%"===t[t.length-1]?255*(parseFloat(t)/100):parseInt(t))}function i(e){return t("%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))}function a(e,t,r){return 0>r?r+=1:r>1&&(r-=1),1>6*r?e+6*(t-e)*r:1>2*r?t:2>3*r?e+6*(t-e)*(2/3-r):e}function n(t){var n=t.replace(/ /g,"").toLowerCase();if(n in s)return s[n].slice();if("#"===n[0]){if(4===n.length){var o=parseInt(n.substr(1),16);return o>=0&&4095>=o?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null}if(7===n.length){var o=parseInt(n.substr(1),16);return o>=0&&16777215>=o?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null}return null}var h=n.indexOf("("),u=n.indexOf(")");if(-1!==h&&u+1===n.length){var l=n.substr(0,h),c=n.substr(h+1,u-(h+1)).split(","),d=1;switch(l){case"rgba":if(4!==c.length)return null;d=i(c.pop());case"rgb":return 3!==c.length?null:[r(c[0]),r(c[1]),r(c[2]),d];case"hsla":if(4!==c.length)return null;d=i(c.pop());case"hsl":if(3!==c.length)return null;var f=(parseFloat(c[0])%360+360)%360/360,m=i(c[1]),_=i(c[2]),p=.5>=_?_*(m+1):_+m-_*m,g=2*_-p;return[e(255*a(g,p,f+1/3)),e(255*a(g,p,f)),e(255*a(g,p,f-1/3)),d];default:return null}}return null}var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};return{parse:n}}),define("echarts-x/entity/marker/MarkLine",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","qtek/Node","../../util/geometry/Lines","../../util/geometry/CurveAnimatingPoints","qtek/math/Vector3"],function(e){var t=e("zrender/tool/util"),r=e("./Base"),i=e("qtek/Renderable"),a=e("qtek/Material"),n=e("qtek/Shader"),s=e("qtek/Node"),o=e("../../util/geometry/Lines"),h=e("../../util/geometry/CurveAnimatingPoints"),u=e("qtek/math/Vector3"),l=function(e){r.call(this,e),this._sceneNode=new s,this._markLineRenderable=null,this._curveAnimatingPointsRenderable=null,this._elapsedTime=0};return l.prototype={constructor:l,_createMarkLineRenderable:function(){var e=new a({shader:new n({vertex:n.source("ecx.albedo.vertex"),fragment:n.source("ecx.albedo.fragment")}),transparent:!0,depthMask:!1});e.shader.define("both","VERTEX_COLOR"),this._markLineRenderable=new i({geometry:new o,material:e,mode:i.LINES}),this._sceneNode.add(this._markLineRenderable)},_createCurveAnimatingPointsRenderable:function(){var e=new a({shader:new n({vertex:n.source("ecx.curveAnimatingPoints.vertex"),fragment:n.source("ecx.curveAnimatingPoints.fragment")})});this._curveAnimatingPointsRenderable=new i({material:e,mode:i.POINTS,geometry:new h}),this._sceneNode.add(this._curveAnimatingPointsRenderable)},setSeries:function(e,t){if(e.markLine&&e.markLine.data){this.seriesIndex=t;var r=this.chart,i=r.component.legend,a=r.zr,n=e.markLine,s=window.devicePixelRatio||1;this._markLineRenderable||this._createMarkLineRenderable();var o=r.query(n,"itemStyle.normal.lineStyle.width"),h=r.query(n,"itemStyle.normal.lineStyle.opacity"),l=this._markLineRenderable;l.lineWidth=o*s,l.material.set("alpha",h);var c,d=r.query(e.markLine,"effect.show");if(d){var f=r.query(n,"effect.scaleSize");this._curveAnimatingPointsRenderable||this._createCurveAnimatingPointsRenderable(),c=this._curveAnimatingPointsRenderable,c.material.set("pointSize",f*s),c.geometry.dirty()}var m;i&&(m=i.getColor(e.name)),m=r.query(n,"itemStyle.normal.color");for(var _=a.getColor(t),p=n.data,g=0;p.length>g;g++){var y=new u,v=new u,b=new u,x=new u,T=p[g],w=r.query(T,"itemStyle.normal.color"),S=w||m||_;"function"==typeof S&&(S=S(T));var k=r.parseColor(S)||new Float32Array;r.getMarkLinePoints(t,T,y,v,b,x),l.geometry.addCubicCurve(y,v,b,x,k),d&&c.geometry.addPoint(y,v,b,x,k)}l.geometry.dirty()}},clear:function(){this._elapsedTime=0,this._markLineRenderable&&this._markLineRenderable.geometry.clearLines(),this._curveAnimatingPointsRenderable&&this._curveAnimatingPointsRenderable.geometry.clearPoints()},getSceneNode:function(){return this._sceneNode},onframe:function(e){var t=this._curveAnimatingPointsRenderable;if(t&&t.geometry.getVertexNumber()>0){this._elapsedTime+=e/1e3;var r=this._elapsedTime/3;r%=1,t.material.set("percent",r),this.chart.zr.refreshNextFrame()}}},t.inherits(l,r),l}),define("echarts-x/entity/marker/MarkBar",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","../../util/geometry/Bars","qtek/math/Vector3"],function(e){var t=e("zrender/tool/util"),r=e("./Base"),i=e("qtek/Renderable"),a=e("qtek/Material"),n=e("qtek/Shader"),s=e("../../util/geometry/Bars"),o=e("qtek/math/Vector3"),h=function(e){r.call(this,e),this._markBarRenderable=null,this._albedoShader=new n({vertex:n.source("ecx.albedo.vertex"),fragment:n.source("ecx.albedo.fragment")})};return h.prototype={constructor:h,_createMarkBarRenderable:function(){var e=new a({shader:this._albedoShader});e.shader.define("both","VERTEX_COLOR"),this._markBarRenderable=new i({geometry:new s,material:e,ignorePicking:!0})},setSeries:function(e,t){if(e.markBar&&e.markBar.data){var r=this.chart,i=r.component,a=i.legend,n=i.dataRange;this._markBarRenderable||this._createMarkBarRenderable();var s,h=e.markBar.data,u=this._markBarRenderable.geometry;a&&(s=a.getColor(e.name)),s=r.query(e.markBar,"itemStyle.normal.color")||s;for(var l=r.zr.getColor(t),c=new o,d=new o,f=e.markBar.barSize,m=0;h.length>m;m++){var _=h[m],p=r.getDataFromOption(_,null),g=null;if(!n||(g=isNaN(p)?v:n.getColor(p),null!=g)){var y=r.query(_,"itemStyle.normal.color"),v=y||g||s||l;"function"==typeof v&&(v=v(_));var b=r.parseColor(v)||new Float32Array,x=null!=_.barSize?_.barSize:f;"function"==typeof x&&(x=x(_)),r.getMarkBarPoints(t,_,c,d),u.addBar(c,d,x,b)}}u.dirty()}},getSceneNode:function(){return this._markBarRenderable},clear:function(){this._markBarRenderable&&this._markBarRenderable.geometry.clearBars()}},t.inherits(h,r),h}),define("echarts-x/entity/marker/MarkPoint",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","qtek/Node","qtek/Texture","../../surface/TextureAtlasSurface","../../util/geometry/Sprites","echarts/util/shape/Icon","zrender/shape/Image","echarts/util/ecData","qtek/math/Matrix4","zrender/config"],function(e){var t=e("zrender/tool/util"),r=e("./Base"),i=e("qtek/Renderable"),a=e("qtek/Material"),n=e("qtek/Shader"),s=e("qtek/Node"),o=e("qtek/Texture"),h=e("../../surface/TextureAtlasSurface"),u=e("../../util/geometry/Sprites"),l=e("echarts/util/shape/Icon"),c=e("zrender/shape/Image"),d=e("echarts/util/ecData"),f=e("qtek/math/Matrix4"),m=e("zrender/config"),_=["CLICK","DBLCLICK","MOUSEOVER","MOUSEOUT","MOUSEMOVE"],p=function(e){r.call(this,e),this._sceneNode=new s,this._spritesRenderables=[],this._spritesShader=null,this._textureAtlasList=[],this._spriteSize=128};return p.prototype={constructor:p,setSeries:function(e,t){if(e.markPoint&&e.markPoint.data&&0!==e.markPoint.data.length){this.seriesIndex=t;var r,i=this.chart,a=i.component,n=a.legend,s=a.dataRange,u=e.markPoint,m=i.zr,_=this._spriteSize,p=u.data;n&&(r=n.getColor(e.name)),r=i.query(e.markBar,"itemStyle.normal.color")||r;var g=m.getColor(t),y=new f,v=o.prototype.nextHighestPowerOfTwo(Math.sqrt(p.length)*this._spriteSize);v=Math.min(2048,v);var b=new h(i.zr,v,v);this._textureAtlasList.push(b);for(var x=this._createSpritesRenderable(b),T=0;p.length>T;T++){var w=p[T],S=i.getDataFromOption(w,null),k=[w,u],E=null;if(!s||(E=isNaN(S)?M:s.getColor(S),null!=E)){var R=i.query(w,"itemStyle.normal.color"),M=R||E||r||g;"function"==typeof M&&(M=M(w));var P,N=i.deepQuery(k,"symbol"),L=i.deepQuery(k,"symbolSize"),A=i.deepQuery(k,"itemStyle.normal.borderColor"),C=i.deepQuery(k,"itemStyle.normal.borderWidth");P=N.match(/^image:\/\//)?new c({style:{image:N.replace(/^image:\/\//,"")}}):new l({style:{iconType:N,color:M,brushType:"both",strokeColor:A,lineWidth:C/L*_}});var q=P.style;q.x=q.y=0,q.width=q.height=_,d.pack(P,e,t,w,T,w.name,S);var I="itemStyle.normal.label";i.deepQuery(k,I+".show")&&(q.text=i.getSerieLabelText(u,w,w.name,"normal"),q.textPosition=i.deepQuery(k,I+".position"),q.textColor=i.deepQuery(k,I+".textStyle.color"),q.textFont=i.getFont(i.deepQuery(k,I+".textStyle")));var O=b.addShape(P,_,_);O||(b=new h(i.zr,v,v),this._textureAtlasList.push(b),x=this._createSpritesRenderable(b),O=b.addShape(P,_,_)),i.getMarkPointTransform(t,w,y),x.geometry.addSprite(y,O)}}for(var T=0;this._textureAtlasList.length>T;T++)this._textureAtlasList[T].refresh()}},_createSpritesRenderable:function(e){this._spritesShader||(this._spritesShader=new n({vertex:n.source("ecx.albedo.vertex"),fragment:n.source("ecx.albedo.fragment")}),this._spritesShader.enableTexture("diffuseMap"));var t=new i({material:new a({shader:this._spritesShader,transparent:!0,depthMask:!1}),culling:!1,geometry:new u,textureAtlas:e});return t.material.set("diffuseMap",e.getTexture()),_.forEach(function(e){t.on(m.EVENT[e],this._mouseEventHandler,this)},this),this._spritesRenderables.push(t),this._sceneNode.add(t),t},clear:function(){var e=this.chart.baseLayer.renderer;e.disposeNode(this._sceneNode,!0,!0),this._sceneNode=new s,this._spritesRenderables=[],this._textureAtlasList=[]},getSceneNode:function(){return this._sceneNode},_mouseEventHandler:function(e){var t=this.chart,r=t.zr,i=e.target,a=i.textureAtlas,n=a.hover(e);if(n){if(e.type===m.EVENT.CLICK||e.type===m.EVENT.DBLCLICK){if(!n.clickable)return}else if(!n.hoverable)return;r.handler.dispatch(e.type,{target:n,event:e.event,type:e.type})}}},t.inherits(p,r),p}),define("echarts-x/entity/marker/LargeMarkPoint",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","qtek/Node","../../util/geometry/Points","../../util/geometry/AnimatingPoints","qtek/Texture2D","../../util/sprite","qtek/math/Vector3","echarts/util/shape/Icon"],function(e){var t=e("zrender/tool/util"),r=e("./Base"),i=e("qtek/Renderable"),a=e("qtek/Material"),n=e("qtek/Shader"),s=e("qtek/Node"),o=e("../../util/geometry/Points"),h=e("../../util/geometry/AnimatingPoints"),u=e("qtek/Texture2D"),l=e("../../util/sprite"),c=e("qtek/math/Vector3"),d=e("echarts/util/shape/Icon"),f=function(e){r.call(this,e),this._sceneNode=new s,this._markPointRenderable=null,this._animatingMarkPointRenderable=null,this._spriteTexture=null,this._elapsedTime=0};return f.prototype={constructor:f,_createMarkPointRenderable:function(){var e=new a({shader:new n({vertex:n.source("ecx.points.vertex"),fragment:n.source("ecx.points.fragment")}),depthMask:!1,transparent:!0});e.shader.enableTexture("sprite"),this._markPointRenderable=new i({geometry:new o,material:e,mode:i.POINTS}),this._spriteTexture&&e.set("sprite",this._spriteTexture),this._sceneNode.add(this._markPointRenderable)},_createAnimatingMarkPointRenderable:function(){var e=new a({shader:new n({vertex:n.source("ecx.points.vertex"),fragment:n.source("ecx.points.fragment")}),depthMask:!1,transparent:!0});e.shader.enableTexture("sprite"),e.shader.define("vertex","ANIMATING"),this._animatingMarkPointRenderable=new i({geometry:new h,material:e,mode:i.POINTS}),this._spriteTexture&&e.set("sprite",this._spriteTexture),this._sceneNode.add(this._animatingMarkPointRenderable)},_updateSpriteTexture:function(e,t){this._spriteTexture||(this._spriteTexture=new u({flipY:!1}));var r=this._spriteTexture;r.image=l.makeSpriteFromShape(e,t,r.image),r.dirty()},clear:function(){this._markPointRenderable&&this._markPointRenderable.geometry.clearPoints(),this._animatingMarkPointRenderable&&this._animatingMarkPointRenderable.geometry.clearPoints(),this._elapsedTime=0},setSeries:function(e,t){if(e.markPoint&&e.markPoint.data){this.seriesIndex=t;var r=this.chart,i=r.component,a=i.legend,n=i.dataRange,s=e.markPoint,o=r.zr,h=r.query(s,"symbol"),u=r.query(s,"effect.show"),l=r.query(s,"effect.shadowBlur")||0,f=new d({style:{x:0,y:0,width:128,height:128,iconType:h,color:"white",shadowBlur:128*l,shadowColor:"white"}});this._updateSpriteTexture(128,f),u?(this._animatingMarkPointRenderable||this._createAnimatingMarkPointRenderable(),this._animatingMarkPointRenderable.geometry.dirty()):(this._markPointRenderable||this._createMarkPointRenderable(),this._markPointRenderable.geometry.dirty());var m,_=s.data;a&&(m=a.getColor(e.name)),m=r.query(s,"itemStyle.normal.color")||m;for(var p=o.getColor(t),g=r.query(s,"symbolSize")||2,y=0;_.length>y;y++){var v=_[y],b=r.getDataFromOption(v,null),x=null;if(!n||(x=isNaN(b)?w:n.getColor(b),null!=x)){var T=r.query(v,"itemStyle.normal.color"),w=T||x||m||p;"function"==typeof w&&(w=w(v));var S=r.parseColor(w)||new Float32Array(4),k=null==v.symbolSize?g:v.symbolSize;"function"==typeof k&&(k=k(v)),k*=window.devicePixelRatio||1;var E=new c;r.getMarkCoord(t,v,E),u?this._animatingMarkPointRenderable.geometry.addPoint(E,S,k,2*Math.random()):this._markPointRenderable.geometry.addPoint(E,S,k)}}}},getSceneNode:function(){return this._sceneNode},onframe:function(e){if(this._animatingMarkPointRenderable){var t=this._animatingMarkPointRenderable;t.geometry.getVertexNumber()>0&&(this._elapsedTime+=e/1e3,t.material.set("elapsedTime",this._elapsedTime),this.chart.zr.refreshNextFrame())}}},t.inherits(f,r),f}),define("echarts-x/core/Layer3D",["require","qtek/Renderer","qtek/Scene","qtek/camera/Perspective","qtek/picking/RayPicking","zrender/mixin/Eventful","zrender/tool/util","zrender/tool/event"],function(e){var t=e("qtek/Renderer"),r=e("qtek/Scene"),i=e("qtek/camera/Perspective"),a=e("qtek/picking/RayPicking"),n=e("zrender/mixin/Eventful"),s=e("zrender/tool/util"),o=e("zrender/tool/event"),h=function(e,a){n.call(this),this.id=e;try{this.renderer=new t({}),this.renderer.resize(a.getWidth(),a.getHeight())}catch(s){return this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecx-nowebgl",void(this.dom.innerHTML="Sorry, your browser does support WebGL")}this.dom=this.renderer.canvas;var o=this.dom.style;o.position="absolute",o.left="0",o.top="0",this.camera=new i,this.camera.aspect=a.getWidth()/a.getHeight(),this.scene=new r,this._viewport={x:0,y:0,width:1,height:1},this._initHandlers()};return h.prototype._initHandlers=function(){this.bind("click",this._clickHandler,this),this.bind("mousedown",this._mouseDownHandler,this),this.bind("mouseup",this._mouseUpHandler,this),this.bind("mousemove",this._mouseMoveHandler,this),this._picking=new a({scene:this.scene,camera:this.camera,renderer:this.renderer})},h.prototype.resize=function(e,t){var r=this.renderer;r.resize(e,t);var i=this._viewport;this.setViewport(i.x*e,i.y*t,i.width*e,i.height*t)},h.prototype.setViewport=function(e,t,r,a){var n=this.renderer,s=n.getWidth(),o=n.getHeight(),h=this._viewport;h.x=e/s,h.y=t/o,h.width=r/s,h.height=1-a/o,n.setViewport(e,t,r,a);var u=this.camera;u instanceof i&&(u.aspect=r/a)},h.prototype.getViewportWidth=function(){return this._viewport.width*this.renderer.getWidth()},h.prototype.getViewportHeight=function(){return this._viewport.height*this.renderer.getHeight()},h.prototype.clear=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)},h.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)},h.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},h.prototype.refresh=function(){this.clear(),this.renderer.render(this.scene,this.camera)},h.prototype.renderScene=function(e){this.renderer.render(e,this.camera)},h.prototype.dispose=function(){this.renderer.disposeScene(this.scene)},h.prototype.onmousedown=function(e){e=e.event;var t=this.pickObject(o.getX(e),o.getY(e));t&&this._dispatchEvent("mousedown",e,t)},h.prototype.onmousemove=function(e){e=e.event;var t=this.pickObject(o.getX(e),o.getY(e));t&&this._dispatchEvent("mousemove",e,t)},h.prototype.onmouseup=function(e){e=e.event;var t=this.pickObject(o.getX(e),o.getY(e));t&&this._dispatchEvent("mouseup",e,t)},h.prototype.onclick=function(e){e=e.event;var t=this.pickObject(o.getX(e),o.getY(e));t&&this._dispatchEvent("click",e,t)},h.prototype.pickObject=function(e,t){return this._picking.pick(e,t)},h.prototype._dispatchEvent=function(e,t,r){var i=r.target;for(r.cancelBubble=!1,r.event=t,r.type=e;i&&(i.trigger(e,r),i=i.getParent(),!r.cancelBubble););},s.inherits(h,n),h}),define("qtek/Renderer",["require","./core/Base","./Texture","./core/glinfo","./core/glenum","./math/BoundingBox","./math/Matrix4","./shader/library","./Material","./math/Vector2","./dep/glmatrix"],function(e){"use strict";var t=e("./core/Base");e("./Texture");var r=e("./core/glinfo"),i=e("./core/glenum"),a=e("./math/BoundingBox"),n=e("./math/Matrix4"),s=e("./shader/library"),o=e("./Material"),h=e("./math/Vector2"),u=e("./dep/glmatrix"),l=u.mat4,c=u.vec3,d=0,f={},m=t.derive(function(){return{canvas:null,width:100,height:100,devicePixelRatio:window.devicePixelRatio||1,color:[0,0,0,0],clear:17664,alhpa:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},_viewportSettings:[],_clearSettings:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height);try{var e={alhpa:this.alhpa,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=this.canvas.getContext("webgl",e)||this.canvas.getContext("experimental-webgl",e),!this.gl)throw Error();this.gl.__GLID__=d++,this.width=this.canvas.width,this.height=this.canvas.height,this.resize(this.width,this.height),r.initialize(this.gl)}catch(t){throw"Error creating WebGL Context "+t}},{resize:function(e,t){var r=this.canvas;void 0!==e?(r.style.width=e+"px",r.style.height=t+"px",r.width=e*this.devicePixelRatio,r.height=t*this.devicePixelRatio,this.width=e,this.height=t):(this.width=r.width/this.devicePixelRatio,this.height=r.height/this.devicePixelRatio),this.setViewport(0,0,e,t)},getWidth:function(){return this.width},getHeight:function(){return this.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this.width,this.height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getExtension:function(e){return r.getExtension(this.gl,e)},setViewport:function(e,t,r,i,a){if("object"==typeof e){var n=e;e=n.x,t=n.y,r=n.width,i=n.height}a=a||this.devicePixelRatio,this.gl.viewport(e*a,t*a,r*a,i*a),this.viewport={x:e,y:t,width:r,height:i}},saveViewport:function(){this._viewportSettings.push(this.viewport)},restoreViewport:function(){this._viewportSettings.length>0&&this.setViewport(this._viewportSettings.pop())},saveClear:function(){this._clearSettings.push(this.clear)},restoreClear:function(){this._clearSettings.length>0&&(this.clear=this._clearSettings.pop())},render:function(e,t,r,i){var a=this.gl;this._sceneRendering=e;var n=this.color;this.clear&&(a.colorMask(!0,!0,!0,!0),a.depthMask(!0),a.clearColor(n[0],n[1],n[2],n[3]),a.clear(this.clear)),r||e.update(!1),t.getScene()||t.update(!0);var s=e.opaqueQueue,o=e.transparentQueue,h=e.material;if(e.trigger("beforerender",this,e,t),o.length>0)for(var u=l.create(),d=c.create(),f=0;o.length>f;f++){var _=o[f];l.multiply(u,t.viewMatrix._array,_.worldTransform._array),c.transformMat4(d,_.position._array,u),_.__depth=d[2]}s.sort(m.opaqueSortFunc),o.sort(m.transparentSortFunc),e.trigger("beforerender:opaque",this,s),t.sceneBoundingBoxLastFrame.min.set(1/0,1/0,1/0),t.sceneBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0),a.disable(a.BLEND),a.enable(a.DEPTH_TEST);var p=this.renderQueue(s,t,h,i);e.trigger("afterrender:opaque",this,s,p),e.trigger("beforerender:transparent",this,o),a.enable(a.BLEND);var g=this.renderQueue(o,t,h);e.trigger("afterrender:transparent",this,o,g);var y={};for(var v in p)y[v]=p[v]+g[v];return e.trigger("afterrender",this,e,t,y),this._sceneRendering=null,y},renderQueue:function(e,t,r,i){var a={faceNumber:0,vertexNumber:0,drawCallNumber:0,meshNumber:e.length,renderedMeshNumber:0};l.copy(_.VIEW,t.viewMatrix._array),l.copy(_.PROJECTION,t.projectionMatrix._array),l.multiply(_.VIEWPROJECTION,t.projectionMatrix._array,_.VIEW),l.copy(_.VIEWINVERSE,t.worldTransform._array),l.invert(_.PROJECTIONINVERSE,_.PROJECTION),l.invert(_.VIEWPROJECTIONINVERSE,_.VIEWPROJECTION);var n,h,u,c,d,m,p,g,y=this.gl,v=this._sceneRendering;if(i){var b=new o({shader:s.get("buildin.prez")}),x=b.shader;g=[],x.bind(y),y.colorMask(!1,!1,!1,!1),y.depthMask(!0),y.enable(y.DEPTH_TEST);for(var T=0;e.length>T;T++){var w=e[T],S=w.worldTransform._array,k=w.geometry;if(l.multiply(_.WORLDVIEW,_.VIEW,S),l.multiply(_.WORLDVIEWPROJECTION,_.VIEWPROJECTION,S),!(k.boundingBox&&this.isFrustumCulled(w,t,_.WORLDVIEW,_.PROJECTION)||w.skeleton)){w.cullFace!==m&&(m=w.cullFace,y.cullFace(m)),w.frontFace!==p&&(p=w.frontFace,y.frontFace(p)),w.culling!==d&&(d=w.culling,d?y.enable(y.CULL_FACE):y.disable(y.CULL_FACE));var E=x.matrixSemantics.WORLDVIEWPROJECTION;x.setUniform(y,E.type,E.symbol,_.WORLDVIEWPROJECTION),w.render(y,b),g.push(w)}}y.depthFunc(y.LEQUAL),y.colorMask(!0,!0,!0,!0),y.depthMask(!1)}else g=e;d=null,m=null,p=null;for(var T=0;g.length>T;T++){var w=g[T],R=r||w.material,M=R.shader,k=w.geometry,S=w.worldTransform._array;if(l.copy(_.WORLD,S),l.multiply(_.WORLDVIEW,_.VIEW,S),l.multiply(_.WORLDVIEWPROJECTION,_.VIEWPROJECTION,S),(M.matrixSemantics.WORLDINVERSE||M.matrixSemantics.WORLDINVERSETRANSPOSE)&&l.invert(_.WORLDINVERSE,S),(M.matrixSemantics.WORLDVIEWINVERSE||M.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&l.invert(_.WORLDVIEWINVERSE,_.WORLDVIEW),(M.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||M.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&l.invert(_.WORLDVIEWPROJECTIONINVERSE,_.WORLDVIEWPROJECTION),!k.boundingBox||i||!this.isFrustumCulled(w,t,_.WORLDVIEW,_.PROJECTION)){if(h!==M){v&&v.isShaderLightNumberChanged(M)&&v.setShaderLightNumber(M);var P=M.bind(y);if(P){if(f[M.__GUID__])continue;if(f[M.__GUID__]=!0,this.throwError)throw Error(P);this.trigger("error",P)}v&&v.setLightUniforms(M,y),h=M}n!==R&&(i||(R.depthTest!==u&&(R.depthTest?y.enable(y.DEPTH_TEST):y.disable(y.DEPTH_TEST),u=R.depthTest),R.depthMask!==c&&(y.depthMask(R.depthMask),c=R.depthMask)),R.bind(y,n),n=R,R.transparent&&(R.blend?R.blend(y):(y.blendEquationSeparate(y.FUNC_ADD,y.FUNC_ADD),y.blendFuncSeparate(y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA,y.ONE,y.ONE_MINUS_SRC_ALPHA))));for(var N=M.matrixSemanticKeys,L=0;N.length>L;L++){var A=N[L],E=M.matrixSemantics[A],C=_[A];if(E.isTranspose){var q=_[E.semanticNoTranspose];l.transpose(C,q)}M.setUniform(y,E.type,E.symbol,C)}w.cullFace!==m&&(m=w.cullFace,y.cullFace(m)),w.frontFace!==p&&(p=w.frontFace,y.frontFace(p)),w.culling!==d&&(d=w.culling,d?y.enable(y.CULL_FACE):y.disable(y.CULL_FACE));var I=w.render(y,r);I&&(a.faceNumber+=I.faceNumber,a.vertexNumber+=I.vertexNumber,a.drawCallNumber+=I.drawCallNumber,a.renderedMeshNumber++)}}return i&&y.depthFunc(y.LESS),a},isFrustumCulled:function(){var e=new a,t=new n;return function(r,i,a,n){var s=r.boundingBox||r.geometry.boundingBox;if(t._array=a,e.copy(s),e.applyTransform(t),r.isRenderable()&&r.castShadow&&i.sceneBoundingBoxLastFrame.union(e),r.frustumCulling){if(!e.intersectBoundingBox(i.frustum.boundingBox))return!0;t._array=n,e.max._array[2]>0&&0>e.min._array[2]&&(e.max._array[2]=-1e-20),e.applyProjection(t);var o=e.min._array,h=e.max._array;if(-1>h[0]||o[0]>1||-1>h[1]||o[1]>1||-1>h[2]||o[2]>1)return!0}return!1}}(),disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,r){var i={},a=this.gl;e.getParent()&&e.getParent().remove(e),e.traverse(function(e){e.geometry&&t&&e.geometry.dispose(a),e.material&&(i[e.material.__GUID__]=e.material),e.dispose&&e.dispose(a)});for(var n in i){var s=i[n];s.dispose(a,r)}},disposeShader:function(e){e.dispose(this.gl)},disposeGeometry:function(e){e.dispose(this.gl)},disposeTexture:function(e){e.dispose(this.gl)},disposeFrameBuffer:function(e){e.dispose(this.gl)},dispose:function(){r.dispose(this.gl)},screenToNdc:function(e,t,r){r||(r=new h),t=this.height-t;var i=this.viewport,a=r._array;return a[0]=(e-i.x)/i.width,a[0]=2*a[0]-1,a[1]=(t-i.y)/i.height,a[1]=2*a[1]-1,r}});m.opaqueSortFunc=function(e,t){return e.material.shader===t.material.shader?e.material===t.material?e.geometry.__GUID__-t.geometry.__GUID__:e.material.__GUID__-t.material.__GUID__:e.material.shader.__GUID__-t.material.shader.__GUID__},m.transparentSortFunc=function(e,t){return e.__depth===t.__depth?e.material.shader===t.material.shader?e.material===t.material?e.geometry.__GUID__-t.geometry.__GUID__:e.material.__GUID__-t.material.__GUID__:e.material.shader.__GUID__-t.material.shader.__GUID__:e.__depth-t.__depth};var _={WORLD:l.create(),VIEW:l.create(),PROJECTION:l.create(),WORLDVIEW:l.create(),VIEWPROJECTION:l.create(),WORLDVIEWPROJECTION:l.create(),WORLDINVERSE:l.create(),VIEWINVERSE:l.create(),PROJECTIONINVERSE:l.create(),WORLDVIEWINVERSE:l.create(),VIEWPROJECTIONINVERSE:l.create(),WORLDVIEWPROJECTIONINVERSE:l.create(),WORLDTRANSPOSE:l.create(),VIEWTRANSPOSE:l.create(),PROJECTIONTRANSPOSE:l.create(),WORLDVIEWTRANSPOSE:l.create(),VIEWPROJECTIONTRANSPOSE:l.create(),WORLDVIEWPROJECTIONTRANSPOSE:l.create(),WORLDINVERSETRANSPOSE:l.create(),VIEWINVERSETRANSPOSE:l.create(),PROJECTIONINVERSETRANSPOSE:l.create(),WORLDVIEWINVERSETRANSPOSE:l.create(),VIEWPROJECTIONINVERSETRANSPOSE:l.create(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:l.create()};return m.COLOR_BUFFER_BIT=i.COLOR_BUFFER_BIT,m.DEPTH_BUFFER_BIT=i.DEPTH_BUFFER_BIT,m.STENCIL_BUFFER_BIT=i.STENCIL_BUFFER_BIT,m}),define("qtek/Scene",["require","./Node","./Light"],function(e){"use strict";function t(e,t){return t.castShadow&&!e.castShadow?!0:void 0}var r=e("./Node"),i=e("./Light"),a=r.derive(function(){return{material:null,autoUpdate:!0,opaqueQueue:[],transparentQueue:[],lights:[],_lightUniforms:{},_lightNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0,AMBIENT_LIGHT:0},_opaqueObjectCount:0,_transparentObjectCount:0,_nodeRepository:{}}},function(){this._scene=this},{addToScene:function(e){e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},cloneNode:function(e){var t=e.clone(),r={},i=function(a,n){a.skeleton&&(n.skeleton=a.skeleton.clone(e,t),n.joints=a.joints.slice()),a.material&&(r[a.material.__GUID__]={oldMat:a.material});for(var s=0;a._children.length>s;s++)i(a._children[s],n._children[s])};i(e,t);for(var a in r)r[a].newMat=r[a].oldMat.clone();return t.traverse(function(e){e.material&&(e.material=r[e.material.__GUID__].newMat)}),t},update:function(e,t){if(this.autoUpdate||e){r.prototype.update.call(this,e);var i=this.lights,a=this.material&&this.material.transparent;if(this._opaqueObjectCount=0,this._transparentObjectCount=0,i.length=0,this._updateRenderQueue(this,a),this.opaqueQueue.length=this._opaqueObjectCount,this.transparentQueue.length=this._transparentObjectCount,!t){for(var n in this._lightNumber)this._lightNumber[n]=0;for(var s=0;i.length>s;s++){var o=i[s];this._lightNumber[o.type]++}this._updateLightUniforms()}}},_updateRenderQueue:function(e,t){if(e.visible)for(var r=0;e._children.length>r;r++){var a=e._children[r];a instanceof i&&this.lights.push(a),a.isRenderable()&&(a.material.transparent||t?this.transparentQueue[this._transparentObjectCount++]=a:this.opaqueQueue[this._opaqueObjectCount++]=a),a._children.length>0&&this._updateRenderQueue(a)}},_updateLightUniforms:function(){var e=this.lights;e.sort(t);var r=this._lightUniforms;for(var i in r)r[i].value.length=0;for(var a=0;e.length>a;a++){var n=e[a];for(i in n.uniformTemplates){var s=n.uniformTemplates[i];r[i]||(r[i]={type:"",value:[]});var o=s.value(n),h=r[i];switch(h.type=s.type+"v",s.type){case"1i":case"1f":h.value.push(o);break;case"2f":case"3f":case"4f":for(var u=0;o.length>u;u++)h.value.push(o[u]);break;default:console.error("Unkown light uniform type "+s.type)}}}},isShaderLightNumberChanged:function(e){return e.lightNumber.POINT_LIGHT!==this._lightNumber.POINT_LIGHT||e.lightNumber.DIRECTIONAL_LIGHT!==this._lightNumber.DIRECTIONAL_LIGHT||e.lightNumber.SPOT_LIGHT!==this._lightNumber.SPOT_LIGHT||e.lightNumber.AMBIENT_LIGHT!==this._lightNumber.AMBIENT_LIGHT},setShaderLightNumber:function(e){for(var t in this._lightNumber)e.lightNumber[t]=this._lightNumber[t];e.dirty()},setLightUniforms:function(e,t){for(var r in this._lightUniforms){var i=this._lightUniforms[r];
e.setUniform(t,i.type,r,i.value)}},dispose:function(){this.material=null,this.opaqueQueue=[],this.transparentQueue=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});return a}),define("qtek/camera/Perspective",["require","../Camera"],function(e){"use strict";var t=e("../Camera"),r=t.derive({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},clone:function(){var e=t.prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}});return r}),define("qtek/shader/library",["require","../Shader","../core/util"],function(e){function t(){this._pool={}}function r(e,t,r){a[e]={vertex:t,fragment:r}}var i=e("../Shader");e("../core/util");var a={};t.prototype.get=function(e,t){var r=[],n={},s={};"string"==typeof t?r=Array.prototype.slice.call(arguments,1):"[object Object]"==Object.prototype.toString.call(t)?(r=t.textures||[],n=t.vertexDefines||{},s=t.fragmentDefines||{}):t instanceof Array&&(r=t);var o=Object.keys(n),h=Object.keys(s);r.sort(),o.sort(),h.sort();var u=[e];u=u.concat(r);for(var l=0;o.length>l;l++)u.push(n[o[l]]);for(var l=0;h.length>l;l++)u.push(s[h[l]]);var c=u.join("_");if(this._pool[c])return this._pool[c];var d=a[e];if(!d)return void console.error('Shader "'+e+'" is not in the library');for(var f=new i({vertex:d.vertex,fragment:d.fragment}),l=0;r.length>l;l++)f.enableTexture(r[l]);for(var e in n)f.define("vertex",e,n[e]);for(var e in s)f.define("fragment",e,s[e]);return this._pool[c]=f,f},t.prototype.clear=function(){this._pool={}};var n=new t;return{createLibrary:function(){return new t},get:function(){return n.get.apply(n,arguments)},template:r,clear:function(){return n.clear()}}}),define("qtek/Camera",["require","./Node","./math/Matrix4","./math/Frustum","./math/BoundingBox","./math/Ray","./dep/glmatrix"],function(e){"use strict";var t=e("./Node"),r=e("./math/Matrix4"),i=e("./math/Frustum"),a=e("./math/BoundingBox"),n=e("./math/Ray"),s=e("./dep/glmatrix"),o=s.mat4,h=s.vec3,u=s.vec4,l=t.derive(function(){return{projectionMatrix:new r,invProjectionMatrix:new r,viewMatrix:new r,frustum:new i,sceneBoundingBoxLastFrame:new a}},function(){this.update(!0)},{update:function(e){t.prototype.update.call(this,e),o.invert(this.viewMatrix._array,this.worldTransform._array),this.updateProjectionMatrix(),o.invert(this.invProjectionMatrix._array,this.projectionMatrix._array),this.frustum.setFromProjection(this.projectionMatrix)},updateProjectionMatrix:function(){},castRay:function(){var e=u.create();return function(t,r){var i=void 0!==r?r:new n,a=t._array[0],s=t._array[1];return u.set(e,a,s,-1,1),u.transformMat4(e,e,this.invProjectionMatrix._array),u.transformMat4(e,e,this.worldTransform._array),h.scale(i.origin._array,e,1/e[3]),u.set(e,a,s,1,1),u.transformMat4(e,e,this.invProjectionMatrix._array),u.transformMat4(e,e,this.worldTransform._array),h.scale(e,e,1/e[3]),h.sub(i.direction._array,e,i.origin._array),h.normalize(i.direction._array,i.direction._array),i.direction._dirty=!0,i.origin._dirty=!0,i}}()});return l}),define("qtek/math/Frustum",["require","./Vector3","./BoundingBox","./Plane","../dep/glmatrix"],function(e){"use strict";e("./Vector3");var t=e("./BoundingBox"),r=e("./Plane"),i=e("../dep/glmatrix"),a=i.vec3,n=function(){this.planes=[];for(var e=0;6>e;e++)this.planes.push(new r);this.boundingBox=new t,this.vertices=[];for(var e=0;8>e;e++)this.vertices[e]=a.fromValues(0,0,0)};return n.prototype={setFromProjection:function(e){var t=this.planes,r=e._array,i=r[0],n=r[1],s=r[2],o=r[3],h=r[4],u=r[5],l=r[6],c=r[7],d=r[8],f=r[9],m=r[10],_=r[11],p=r[12],g=r[13],y=r[14],v=r[15];if(a.set(t[0].normal._array,o-i,c-h,_-d),t[0].distance=-(v-p),t[0].normalize(),a.set(t[1].normal._array,o+i,c+h,_+d),t[1].distance=-(v+p),t[1].normalize(),a.set(t[2].normal._array,o+n,c+u,_+f),t[2].distance=-(v+g),t[2].normalize(),a.set(t[3].normal._array,o-n,c-u,_-f),t[3].distance=-(v-g),t[3].normalize(),a.set(t[4].normal._array,o-s,c-l,_-m),t[4].distance=-(v-y),t[4].normalize(),a.set(t[5].normal._array,o+s,c+l,_+m),t[5].distance=-(v+y),t[5].normalize(),0===v){var b=u/i,x=-y/(m-1),T=-y/(m+1),w=-T/u,S=-x/u;this.boundingBox.min.set(-w*b,-w,T),this.boundingBox.max.set(w*b,w,x);var k=this.vertices;a.set(k[0],-w*b,-w,T),a.set(k[1],-w*b,w,T),a.set(k[2],w*b,-w,T),a.set(k[3],w*b,w,T),a.set(k[4],-S*b,-S,x),a.set(k[5],-S*b,S,x),a.set(k[6],S*b,-S,x),a.set(k[7],S*b,S,x)}else{var E=(-1-p)/i,R=(1-p)/i,M=(1-g)/u,P=(-1-g)/u,N=(-1-y)/m,L=(1-y)/m;this.boundingBox.min.set(E,P,L),this.boundingBox.max.set(R,M,N);for(var A=0;8>A;A++)a.copy(this.vertices[A],this.boundingBox.vertices[A])}},getTransformedBoundingBox:function(){var e=a.create();return function(t,r){var i=this.vertices,n=r._array,s=t.min._array,o=t.max._array,h=i[0];a.transformMat4(e,h,n),a.copy(s,e),a.copy(o,e);for(var u=1;8>u;u++)h=i[u],a.transformMat4(e,h,n),s[0]=Math.min(e[0],s[0]),s[1]=Math.min(e[1],s[1]),s[2]=Math.min(e[2],s[2]),o[0]=Math.max(e[0],o[0]),o[1]=Math.max(e[1],o[1]),o[2]=Math.max(e[2],o[2]);return t.min._dirty=!0,t.max._dirty=!0,t}}()},n}),define("qtek/core/LinkedList",["require"],function(){"use strict";var e=function(){this.head=null,this.tail=null,this._length=0};return e.prototype.insert=function(t){var r=new e.Entry(t);return this.insertEntry(r),r},e.prototype.insertAt=function(t,r){if(!(0>t)){for(var i=this.head,a=0;i&&a!=t;)i=i.next,a++;if(i){var n=new e.Entry(r),s=i.prev;s.next=n,n.prev=s,n.next=i,i.prev=n}else this.insert(r)}},e.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,this.tail=e):this.head=this.tail=e,this._length++},e.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._length--},e.prototype.removeAt=function(e){if(!(0>e)){for(var t=this.head,r=0;t&&r!=e;)t=t.next,r++;return t?(this.remove(t),t.value):void 0}},e.prototype.getHead=function(){return this.head?this.head.value:void 0},e.prototype.getTail=function(){return this.tail?this.tail.value:void 0},e.prototype.getAt=function(e){if(!(0>e)){for(var t=this.head,r=0;t&&r!=e;)t=t.next,r++;return t.value}},e.prototype.indexOf=function(e){for(var t=this.head,r=0;t;){if(t.value===e)return r;t=t.next,r++}},e.prototype.length=function(){return this._length},e.prototype.isEmpty=function(){return 0===this._length},e.prototype.forEach=function(e,t){for(var r=this.head,i=0,a=void 0!==t;r;)a?e.call(t,r.value,i):e(r.value,i),r=r.next,i++},e.prototype.clear=function(){this.tail=this.head=null,this._length=0},e.Entry=function(e){this.value=e,this.next=null,this.prev=null},e}),define("echarts-x/entity/marker/Base",["require"],function(){var e=function(e){this.chart=e};return e.prototype.setSeries=function(){},e.prototype.clear=function(){},e.prototype.onframe=function(){},e.prototype.getSceneNode=function(){},e.prototype.dispose=function(){var e=this.chart.baseLayer.renderer;e.disposeNode(this.getSceneNode(),!0,!0)},e}),define("echarts-x/util/geometry/Lines",["require","qtek/DynamicGeometry","qtek/Geometry","qtek/dep/glmatrix"],function(e){var t=e("qtek/DynamicGeometry"),r=e("qtek/Geometry"),i=e("qtek/dep/glmatrix").vec3,a=t.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),color:new r.Attribute("color","float",4,"COLOR",!0)}}},{clearLines:function(){this.attributes.position.value.length=0,this.attributes.color.value.length=0},addLine:function(e,t,r){this.attributes.position.value.push(e._array,t._array),this.attributes.color.value.push(r,r)},addCubicCurve:function(e,t,r,a,n){e=e._array,t=t._array,r=r._array,a=a._array;for(var s=e[0],o=e[1],h=e[2],u=t[0],l=t[1],c=t[2],d=r[0],f=r[1],m=r[2],_=a[0],p=a[1],g=a[2],y=i.dist(e,t)+i.len(r,t)+i.len(a,r),v=15*(1/(y+1)),b=v*v,x=b*v,T=3*v,w=3*b,S=6*b,k=6*x,E=s-2*u+d,R=o-2*l+f,M=h-2*c+m,P=3*(u-d)-s+_,N=3*(l-f)-o+p,L=3*(c-m)-h+g,A=s,C=o,q=h,I=(u-s)*T+E*w+P*x,O=(l-o)*T+R*w+N*x,B=(c-h)*T+M*w+L*x,z=E*S+P*k,F=R*S+N*k,D=M*S+L*k,V=P*k,U=N*k,H=L*k,W=this.attributes.position.value,G=this.attributes.color.value,Q=W.length,y=0,X=0;1+v>X;)y>1&&(W.push(W[Q+y-1]),G.push(G[Q+y-1]),y++),W.push(i.fromValues(A,C,q)),G.push(n),y++,A+=I,C+=O,q+=B,I+=z,O+=F,B+=D,z+=V,F+=U,D+=H,X+=v}});return a}),define("echarts-x/util/geometry/CurveAnimatingPoints",["require","qtek/DynamicGeometry","qtek/Geometry"],function(e){var t=e("qtek/DynamicGeometry"),r=e("qtek/Geometry"),i=r.Attribute,a=t.derive(function(){return{attributes:{p0:new i("p0","float",3,"",!0),p1:new i("p1","float",3,"",!0),p2:new i("p2","float",3,"",!0),p3:new i("p3","float",3,"",!0),offset:new i("offset","float",1,"",!0),size:new i("size","float",1,"",!0),color:new i("color","float",4,"COLOR",!0)},mainAttribute:"p0"}},{clearPoints:function(){var e=this.attributes;e.p0.value.length=0,e.p1.value.length=0,e.p2.value.length=0,e.p3.value.length=0,e.offset.value.length=0,e.size.value.length=0,e.color.value.length=0},addPoint:function(e,t,r,i,a){for(var n=this.attributes,s=Math.random(),o=0;15>o;o++)n.p0.value.push(e._array),n.p1.value.push(t._array),n.p2.value.push(r._array),n.p3.value.push(i._array),n.offset.value.push(s),n.size.value.push(o/15),n.color.value.push(a),s+=.004}});return a}),define("echarts-x/util/geometry/Bars",["require","qtek/DynamicGeometry","qtek/math/Matrix4","qtek/math/Vector3","qtek/dep/glmatrix"],function(e){var t=e("qtek/DynamicGeometry"),r=e("qtek/math/Matrix4"),i=e("qtek/math/Vector3"),a=e("qtek/dep/glmatrix"),n=a.vec3,s=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,-2],[1,-1,-2],[1,1,-2],[-1,1,-2]],o=[[1,5,6],[1,6,2],[0,3,7],[0,7,4],[3,2,7],[2,6,7],[1,4,5],[1,0,4],[4,6,5],[4,7,6]],h=t.derive(function(){return{_barMat:new r,_barScaleVec:new i}},{clearBars:function(){this.attributes.position.value.length=0,this.attributes.color.value.length=0,this.faces.length=0},addBar:function(e,t,a,h){var u=this._barMat,l=this._barScaleVec,c=i.dist(e,t);if(!(0>=c)){i.set(l,.5*a,.5*a,.5*c),r.identity(u),r.lookAt(u,e,t,i.UP),r.invert(u,u),r.scale(u,u,l);for(var d=this.getVertexNumber(),f=0;o.length>f;f++){var m=n.clone(o[f]);m[0]+=d,m[1]+=d,m[2]+=d,this.faces.push(m)}for(var f=0;s.length>f;f++){var _=n.clone(s[f]);n.transformMat4(_,_,u._array),this.attributes.position.value.push(_),this.attributes.color.value.push(h)}}}});return h}),define("echarts-x/surface/TextureAtlasSurface",["require","./ZRenderSurface","zrender/tool/area"],function(e){var t=e("./ZRenderSurface"),r=e("zrender/tool/area"),i=function(e,r,i){this.zr=e,this._x=0,this._y=0,this._width=r||1024,this._height=i||1024,this._rowHeight=0,this._coords={},this._zrenderSurface=new t(r,i),this._zrenderSurface.onrefresh=function(){e.refreshNextFrame()}};return i.prototype={clear:function(){this._x=0,this._y=0,this._rowHeight=0,this._zrenderSurface.clearElements(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._zrenderSurface.getTexture()},resize:function(e,t){this._zrenderSurface.resize(e,t)},addShape:function(e,t,r){this._fitShape(e,t,r);var i=e.scale[1]/e.scale[0];t=r*i,e.position[0]*=i,e.scale[0]=e.scale[1];var a=this._x,n=this._y;if(a+t>this._width&&n+this._rowHeight>this._height)return null;a+t>this._width&&(a=this._x=0,n+=this._rowHeight,this._y=n,this._rowHeight=0),this._x+=t,this._rowHeight=Math.max(this._rowHeight,r),e.position[0]+=a,e.position[1]+=n,this._zrenderSurface.addElement(e);var s=[[a/this._width,n/this._height],[(a+t)/this._width,(n+r)/this._height]];return this._coords[e.id]=s,s},refresh:function(){this._zrenderSurface.refresh()},refreshNextTick:function(){this._zrenderSurface.refreshNextTick()},_fitShape:function(e,t,i){var a=e.style,n=e.getRect(a),s=a.lineWidth||0,o=a.shadowBlur||0,h=s+o,u=0,l=0;if(a.text&&(l=r.getTextHeight("",a.textFont),u=r.getTextWidth(a.text,a.textFont)),n.x-=h,n.y-=h,n.width+=2*h,n.height+=2*h,a.text){var c=n.width,d=n.height,f=10;switch(a.textPosition){case"inside":c=Math.max(u,c),d=Math.max(l,d),n.x-=(c-n.width)/2,n.y-=(d-n.height)/2;break;case"top":c=Math.max(u,c),d+=l+f,n.x-=(c-n.width)/2,n.y-=l+f;break;case"bottom":c=Math.max(u,c),d+=l+f,n.x-=(c-n.width)/2;break;case"left":c+=u+f,d=Math.max(l,d),n.x-=u+f,n.y-=(d-n.height)/2;break;case"right":c+=u+f,d=Math.max(l,d),n.y-=(d-n.height)/2}n.width=c,n.height=d}var m=t/n.width,_=i/n.height;e.position=[-n.x*m,-n.y*_],e.scale=[m,_],e.updateTransform()},hover:function(e,t){return this._zrenderSurface.hover(e,t)},getImageCoords:function(e){return this._coords[e]}},i}),define("echarts-x/util/geometry/Sprites",["require","qtek/DynamicGeometry","qtek/dep/glmatrix"],function(e){function t(e,t){return[n(-e,-t,0),n(e,-t,0),n(e,t,0),n(-e,t,0)]}var r=e("qtek/DynamicGeometry"),i=e("qtek/dep/glmatrix").vec3,a=e("qtek/dep/glmatrix").vec2,n=i.fromValues,s=[[0,1,2],[0,2,3]],o=r.derive({},{clearSprites:function(){var e=this.attributes;e.position.value.length=0,e.texcoord0.value.length=0},addSprite:function(e,r){for(var n=this.getVertexNumber(),o=0;s.length>o;o++){var h=Array.prototype.slice.call(s[o]);h[0]+=n,h[1]+=n,h[2]+=n,this.faces.push(h)}for(var u=(r[1][0]-r[0][0])/(r[1][1]-r[0][1]),l=t(u,1),o=0;l.length>o;o++){var c=l[o];i.transformMat4(c,c,e._array),this.attributes.position.value.push(c)}var d=this.attributes.texcoord0.value,f=a.fromValues;d.push(f(r[0][0],r[1][1])),d.push(f(r[1][0],r[1][1])),d.push(f(r[1][0],r[0][1])),d.push(f(r[0][0],r[0][1]))}});return o}),define("echarts-x/util/geometry/Points",["require","qtek/DynamicGeometry","qtek/Geometry"],function(e){var t=e("qtek/DynamicGeometry"),r=e("qtek/Geometry"),i=t.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),size:new r.Attribute("size","float",1,"",!0),color:new r.Attribute("color","float",4,"COLOR",!0)}}},{clearPoints:function(){var e=this.attributes;e.position.value.length=0,e.color.value.length=0,e.size.value.length=0},addPoint:function(e,t,r){var i=this.attributes;i.position.value.push(e._array),i.color.value.push(t),i.size.value.push(r)}});return i}),define("echarts-x/util/geometry/AnimatingPoints",["require","qtek/DynamicGeometry","qtek/Geometry"],function(e){var t=e("qtek/DynamicGeometry"),r=e("qtek/Geometry"),i=t.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),size:new r.Attribute("size","float",1,"",!0),delay:new r.Attribute("delay","float",1,"",!0),color:new r.Attribute("color","float",4,"COLOR",!0)}}},{clearPoints:function(){var e=this.attributes;e.position.value.length=0,e.color.value.length=0,e.size.value.length=0,e.delay.value.length=0},addPoint:function(e,t,r,i){var a=this.attributes;a.position.value.push(e._array),a.color.value.push(t),a.size.value.push(r),a.delay.value.push(i)}});return i}),define("echarts-x/util/sprite",["require"],function(){function e(e,t,r){var i=t||document.createElement("canvas");i.width=e,i.height=e;var a=i.getContext("2d");return r&&r(a),i}var t={makeSpriteFromShape:function(t,r,i){var a=r.getRect(r.style),n=r.style.lineWidth||0,s=r.style.shadowBlur||0,o=n+s;a.x-=o,a.y-=o,a.width+=2*o,a.height+=2*o;var h=t/a.width,u=t/a.height;return r.position=[-a.x*h,-a.y*u],r.scale=[h,u],r.updateTransform(),e(t,i,function(e){r.brush(e)})},makeSimpleSprite:function(t,r){return e(t,r,function(e){var r=t/2;e.beginPath(),e.arc(r,r,60,0,2*Math.PI,!1),e.closePath();var i=e.createRadialGradient(r,r,0,r,r,r);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=i,e.fill()})}};return t}),define("qtek/compositor/Pass",["require","../core/Base","../camera/Orthographic","../geometry/Plane","../Shader","../Material","../Mesh","../core/glinfo","../core/glenum","../shader/source/compositor/vertex.essl"],function(e){"use strict";var t=e("../core/Base"),r=e("../camera/Orthographic"),i=e("../geometry/Plane"),a=e("../Shader"),n=e("../Material"),s=e("../Mesh"),o=e("../core/glinfo"),h=e("../core/glenum");a["import"](e("../shader/source/compositor/vertex.essl"));var u=new i,l=new s({geometry:u}),c=new r,d=t.derive(function(){return{fragment:"",outputs:null,material:null}},function(){var e=new a({vertex:a.source("buildin.compositor.vertex"),fragment:this.fragment}),t=new n({shader:e});e.enableTexturesAll(),this.material=t},{setUniform:function(e,t){var r=this.material.uniforms[e];r&&(r.value=t)},getUniform:function(e){var t=this.material.uniforms[e];return t?t.value:void 0},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||h.COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var r in this.outputs){var i=this.outputs[r];i&&t.attach(e.gl,i,r)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var r=e.gl;if(t){this.bind(e,t);var i=o.getExtension(r,"EXT_draw_buffers");if(i&&this.outputs){var a=[];for(var n in this.outputs)n=+n,n>=r.COLOR_ATTACHMENT0&&r.COLOR_ATTACHMENT0+8>=n&&a.push(n);i.drawBuffersEXT(a)}}this.trigger("beforerender",this,e),r.disable(r.BLEND),r.clear(r.DEPTH_BUFFER_BIT),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){l.material=this.material,e.renderQueue([l],c)}});return d}),define("qtek/camera/Orthographic",["require","../Camera"],function(e){"use strict";var t=e("../Camera"),r=t.derive({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},clone:function(){var e=t.prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}});return r}),define("qtek/FrameBuffer",["require","./core/Base","./TextureCube","./core/glinfo","./core/glenum","./core/Cache"],function(e){"use strict";var t=e("./core/Base"),r=e("./TextureCube"),i=e("./core/glinfo"),a=e("./core/glenum"),n=e("./core/Cache"),s=t.derive({depthBuffer:!0,_attachedTextures:null,_width:0,_height:0,_binded:!1},function(){this._cache=new n,this._attachedTextures={}},{resize:function(e,t){this._width=e,this._height=t},bind:function(e){var t=e.gl;this._binded||(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer(t)),this._binded=!0);var r=this._cache;if(r.put("viewport",e.viewport),e.setViewport(0,0,this._width,this._height,1),!r.get("depthtexture_attached")&&this.depthBuffer){r.miss("renderbuffer")&&r.put("renderbuffer",t.createRenderbuffer());var i=this._width,a=this._height,n=r.get("renderbuffer");(i!==r.get("renderbuffer_width")||a!==r.get("renderbuffer_height"))&&(t.bindRenderbuffer(t.RENDERBUFFER,n),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i,a),r.put("renderbuffer_width",i),r.put("renderbuffer_height",a),t.bindRenderbuffer(t.RENDERBUFFER,null)),r.get("renderbuffer_attached")||(t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n),r.put("renderbuffer_attached",!0))}},unbind:function(e){var t=e.gl;t.bindFramebuffer(t.FRAMEBUFFER,null),this._binded=!1,this._cache.use(t.__GLID__);var i=this._cache.get("viewport");i&&e.setViewport(i.x,i.y,i.width,i.height);for(var a in this._attachedTextures){var n=this._attachedTextures[a];if(!n.NPOT&&n.useMipmap){var s=n instanceof r?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D;t.bindTexture(s,n.getWebGLTexture(t)),t.generateMipmap(s),t.bindTexture(s,null)}}},getFrameBuffer:function(e){return this._cache.use(e.__GLID__),this._cache.miss("framebuffer")&&this._cache.put("framebuffer",e.createFramebuffer()),this._cache.get("framebuffer")},attach:function(e,t,r,n,s){if(!t.width)throw Error("The texture attached to color buffer is not a valid.");if(this._binded||(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer(e)),this._binded=!0),this._width=t.width,this._height=t.height,r=r||e.COLOR_ATTACHMENT0,n=n||e.TEXTURE_2D,s=s||0,r===e.DEPTH_ATTACHMENT){var o=i.getExtension(e,"WEBGL_depth_texture");if(!o)return void console.error(" Depth texture is not supported by the browser");if(t.format!==a.DEPTH_COMPONENT)return void console.error("The texture attached to depth buffer is not a valid.");this._cache.put("renderbuffer_attached",!1),this._cache.put("depthtexture_attached",!0)}this._attachedTextures[r]=t,e.framebufferTexture2D(e.FRAMEBUFFER,r,n,t.getWebGLTexture(e),s)},detach:function(){},dispose:function(e){this._cache.use(e.__GLID__);var t=this._cache.get("renderbuffer");t&&e.deleteRenderbuffer(t);var r=this._cache.get("framebuffer");r&&e.deleteFramebuffer(r),this._attachedTextures={},this._width=this._height=0,this._cache.deleteContext(e.__GLID__)}});return s.COLOR_ATTACHMENT0=a.COLOR_ATTACHMENT0,s.DEPTH_ATTACHMENT=a.DEPTH_ATTACHMENT,s.STENCIL_ATTACHMENT=a.STENCIL_ATTACHMENT,s.DEPTH_STENCIL_ATTACHMENT=a.DEPTH_STENCIL_ATTACHMENT,s}),define("qtek/shader/source/compositor/vertex.essl",function(){return"\n@export buildin.compositor.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    v_Texcoord = texcoord;\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n\n@end"}),define("qtek/TextureCube",["require","./Texture","./core/glinfo","./core/glenum","./core/util"],function(e){function t(e){return"CANVAS"===e.nodeName||e.complete}var r=e("./Texture"),i=e("./core/glinfo"),a=e("./core/glenum"),n=e("./core/util"),s=["px","nx","py","ny","pz","nz"],o=r.derive(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}},{update:function(e){e.bindTexture(e.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.beforeUpdate(e);var t=this.format,r=this.type;e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,this.wrapS),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,this.wrapT),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,this.magFilter),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,this.minFilter);var n=i.getExtension(e,"EXT_texture_filter_anisotropic");if(n&&this.anisotropic>1&&e.texParameterf(e.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===r){var s=i.getExtension(e,"OES_texture_half_float");s||(r=a.FLOAT)}if(this.mipmaps.length)for(var o=this.width,h=this.height,u=0;this.mipmaps.length>u;u++){var l=this.mipmaps[u];this._updateTextureData(e,l,u,o,h,t,r),o/=2,h/=2}else this._updateTextureData(e,this,0,this.width,this.height,t,r),!this.NPOT&&this.useMipmap&&e.generateMipmap(e.TEXTURE_CUBE_MAP);e.bindTexture(e.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,r,i,a,n,o){for(var h=0;6>h;h++){var u=s[h],l=t.image&&t.image[u];l?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,r,n,n,o,l):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,r,n,i,a,0,n,o,t.pixels&&t.pixels[u])}},generateMipmap:function(e){this.useMipmap&&!this.NPOT&&(e.bindTexture(e.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),e.generateMipmap(e.TEXTURE_CUBE_MAP))},bind:function(e){e.bindTexture(e.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.bindTexture(e.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){function e(e){return 0===(e&e-1)}return this.image.px?e(this.image.px.width)&&e(this.image.px.height):e(this.width)&&e(this.height)},isRenderable:function(){return this.image.px?t(this.image.px)&&t(this.image.nx)&&t(this.image.py)&&t(this.image.ny)&&t(this.image.pz)&&t(this.image.nz):this.width&&this.height},load:function(e){var t=0,r=this;return n.each(e,function(e,i){var a=new Image;a.onload=function(){t--,0===t&&(r.dirty(),r.trigger("success",r)),a.onload=null},a.onerror=function(){t--,a.onerror=null},t++,a.src=e,r.image[i]=a}),this}});return o}),define("zrender/shape/ShapeBundle",["require","./Base","../tool/util"],function(e){var t=e("./Base"),r=function(e){t.call(this,e)};return r.prototype={constructor:r,type:"shape-bundle",brush:function(e,t){var r=this.beforeBrush(e,t);e.beginPath();for(var i=0;r.shapeList.length>i;i++){var a=r.shapeList[i],n=a.style;t&&(n=a.getHighlightStyle(n,a.highlightStyle||{},a.brushTypeOnly)),a.buildPath(e,n)}switch(r.brushType){case"both":e.fill();case"stroke":r.lineWidth>0&&e.stroke();break;default:e.fill()}this.drawText(e,r,this.style),this.afterBrush(e)},getRect:function(e){if(e.__rect)return e.__rect;for(var t=1/0,r=-1/0,i=1/0,a=-1/0,n=0;e.shapeList.length>n;n++)var s=e.shapeList[n],o=s.getRect(s.style),t=Math.min(o.x,t),i=Math.min(o.y,i),r=Math.max(o.x+o.width,r),a=Math.max(o.y+o.height,a);return e.__rect={x:t,y:i,width:r-t,height:a-i},e.__rect},isCover:function(e,t){var r=this.transformCoordToLocal(e,t);if(e=r[0],t=r[1],this.isCoverRect(e,t))for(var i=0;this.style.shapeList.length>i;i++){var a=this.style.shapeList[i];if(a.isCover(e,t))return!0}return!1}},e("../tool/util").inherits(r,t),r});