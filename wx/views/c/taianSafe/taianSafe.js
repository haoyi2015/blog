function goHrefDetail(t,e){"wood"==t?updateLocation("type",0,"safeDetailWood.html"):updateLocation("type",e,"safeDetailNoWood"+e+".html")}function decodeToJson(t){var e="";e=t?t:location.search,e.length>0&&(e=e.substring(1));var o={};if(e.length>0)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");if(i.length>2){var r=i[0];if(""!=r){var d=[];i.forEach(function(t,e){0!=e&&d.push(t)}),o[r]=d.join("=")}}else{var r=i[0];""!=r&&(o[r]=i[1])}}return o}function updateLocation(t,e,o){var n=decodeToJson();n[t]=e;var a="?";for(var i in n)a+=i+"="+n[i]+"&";a=a.substring(0,a.length-1),window.location.href=o+a}$(function(){function t(t){return 15==t.length?t.substring(14,15)%2:18==t.length?t.substring(14,17)%2:null}function e(t){var e;return 15==t.length?(e=t.charAt(6)+t.charAt(7),e=parseInt(e)<10?"20"+e:"19"+e,e=e+"-"+t.charAt(8)+t.charAt(9)+"-"+t.charAt(10)+t.charAt(11)):18==t.length&&(e=t.charAt(6)+t.charAt(7)+t.charAt(8)+t.charAt(9)+"-"+t.charAt(10)+t.charAt(11)+"-"+t.charAt(12)+t.charAt(13)),e}function o(){var t=decodeToJson(),e=t.code,o=t.wxOpenId;o?r=o:($.showLoading("身份验证中，请稍等..."),$.get(DOMAIN.API+"/api/wx/openId/"+e+"/MP4INN").done(function(t){if($.hideLoading(""),!t.openid){if(window.localStorage){var e=window.localStorage.getItem("openId");if(e)return void(r=e)}return void $.toast("微信认证失败","cancel",function(){})}r=t.openid,window.localStorage&&window.localStorage.setItem("openId",t.openid)}))}function n(t){$.ajax({type:"POST",url:DOMAIN.PMS+"/api/htbx/insure/"+r,contentType:"application/json;charset=utf-8",data:JSON.stringify(t),error:function(){$.alert("网络错误！")},success:function(t){if(200==t.status){var e=t.payHtml,o=t.orderNo;window.localStorage&&window.localStorage.setItem("ht_orderId",o),$(document.body).html(e)}else $.alert(t.message)}})}function a(t){var e=[],o=decodeToJson().roomNo;return e[0]=e[1]=5>=o?100:100+30*(o-5),e[2]=10>=o?700:700+30*(o-10),e[3]=20>=o?1600:1600+30*(o-20),e[4]=30>=o?2700:2700+30*(o-30),e[t]}var i;i=[["北京","东城","西城","宣武","朝阳","崇文","海淀","丰台","石景山","通州","平谷","顺义","怀柔","密云","延庆","昌平","门头沟","房山","大兴"],["上海","近郊","闵行","浦东","南汇","奉贤","金山","松江","青浦","嘉定","宝山","崇明"],["天津","塘沽","汉沽","宁河","静海","武清","宝坻","蓟县"],["重庆"],["内蒙古","呼和浩特","集宁","包头","临河","乌海","东胜","海拉尔","赤峰","锡林浩特","太仆寺旗","通辽","阿拉善盟","白城"],["河北","石家庄","衡水","邢台","邯郸","沧州","唐山","廊坊","秦皇岛","承德","保定","张家口"],["辽宁","沈阳","铁岭","抚顺","鞍山","营口","大连","本溪","丹东","锦州","朝阳","阜新","盘锦"],["吉林","长春","吉林","延吉","通化","梅河口","四平","白城","松原"],["黑龙江","哈尔滨","绥化","佳木斯","牡丹江","齐齐哈尔","大庆","北安","大兴安岭"],["江苏","南京","镇江","常州","无锡","苏州","徐州","连云港","淮阴","盐城","扬州","南通"],["安徽","合肥","淮南","蚌埠","宿州","阜阳","六安","巢湖","滁州","芜湖","屯溪","安庆"],["山东","济南","聊城","德州","淄博","东营","潍坊","烟台","青岛","泰安","济宁","荷泽","临沂","枣庄"],["浙江","杭州","绍兴","湖州","嘉兴","宁波","舟山","台州","金华","丽水","衢州","温州"],["江西","南昌","九江","景德镇","上饶","鹰潭","宜春","萍乡","赣州","吉安","抚州"],["福建","福州","南平","邵武","福安","厦门","泉州","漳州","龙岩","三明"],["湖南","长沙","株洲","益阳","岳阳","常德","吉首","娄底","怀化","衡阳","邵阳","郴州","零陵","张家界"],["湖北","武汉","沙市","黄石","鄂州","咸宁","襄樊","十堰","宜昌","恩施"],["河南","郑州","新乡","安阳","许昌","漯河","驻马店","信阳","周口","平顶山","洛阳","三门峡","南阳","开封","商丘"],["广东","广州","韶关","英德","梅州","汕头","惠州","深圳","湛江","茂名","肇庆","佛山"],["广西","南宁","百色","钦州","玉林","桂林","梧州","柳州","河池"],["贵州","贵阳","六盘水","玉屏","凯里","都匀","安顺","遵义"],["四川","成都","乐山","凉山","渡口","绵阳","汶川","雅安","甘孜","广元","南充","达州","内江","自贡","宜宾","泸州"],["云南","昆明","曲靖","昭通","开远","文山","思茅","大理","楚雄","临沧","保山","六盘水","渡口"],["陕西","西安","渭南","延安","绥德","榆林","宝鸡","汉中","安康","商洛","铜川"],["宁夏","银川","吴忠","石咀山","固原"],["新疆","乌鲁木齐","石河子","乌苏","克拉玛依","伊宁","吐鲁番","哈密","巴音郭楞","阿克苏","喀什"],["山西","太原","离石","忻州","宁武","大同","临汾","侯马","运城","阳泉","长治","晋城"]];var r,d={0:"女",1:"男"};if(void 0!=decodeToJson().county&&($("#county").find(".weui_cell_ft").html(i[decodeToJson().county][0]),$("#county").attr("value",i[decodeToJson().county][0]),$(".step1Click").removeClass("btn_disabled").addClass("weui_btn_primary")),void 0!=decodeToJson().roomNo&&($("#step2RoomNo").val(decodeToJson().roomNo),$(".step2Click").removeClass("btn_disabled").addClass("weui_btn_primary"),$(".safeDetailRoomNo").html(decodeToJson().roomNo)),""!=$("#step2RoomNo").val()&&$(".step2Click").removeClass("btn_disabled").addClass("weui_btn_primary"),void 0!=decodeToJson().startdate){$("#info_county").html(i[decodeToJson().county][0]);var c=decodeToJson().type;$(".detailPayFee").html(a(c))}if(void 0!=decodeToJson().type){$(".safeDetail .date_input").val(date.tomorrow("yyyy-MM-dd")),$(".safeDetail .date_input").parents(".weui_cells").next().find(".weui_cell_ft").html(date.plusDate(date.today(),1,"y","yyyy-MM-dd"));var l=decodeToJson().type,s={woodConstru:["木结构"],nowoodConstru:["钢结构","钢/钢筋混凝土结构","砖混结构"]};$("#info_type").select(0==l?{title:"房屋结构",items:s.woodConstru,onChange:function(t){$(".info_type").html(t.values),$(".info_type").attr("data-id",4)}}:{title:"房屋结构",items:s.nowoodConstru,onChange:function(t){$(".info_type").html(t.values),s.nowoodConstru.forEach(function(e,o){e==t.values&&$(".info_type").attr("data-id",o+1)})}})}0==decodeToJson().nowood&&$(".woodFee").html(a(0).toFixed(2)),1==decodeToJson().nowood&&($(".nowoodFee1").html(a(1).toFixed(2)),$(".nowoodFee2").html(a(2).toFixed(2)),$(".nowoodFee3").html(a(3).toFixed(2)),$(".nowoodFee4").html(a(4).toFixed(2))),$(".indexClick").on("click",function(){""!=r&&void 0!=r&&null!=r?updateLocation("wxOpenId",r,"step1.html"):$.alert("微信认证失败，无法进入！")}),$(".step1Click").on("click",function(){var t=$("#county").attr("value");if(void 0==t||""==t)$.alert("请选择省份！","提示！");else{var e=0;i.forEach(function(o,n){o[0]==t&&(e=n)}),updateLocation("county",e,"step2.html")}}),$("#step2RoomNo").on("keyup",function(){var t=$(this).val();""!=t&&void 0!=t?$(".step2Click").removeClass("btn_disabled").addClass("weui_btn_primary"):$(".step2Click").removeClass("weui_btn_primary").addClass("btn_disabled")}),$(".step2Back").on("click",function(){var t=decodeToJson();void 0!=t.county&&(window.location.href="step1.html"+location.search)}),$(".step2Click").on("click",function(){var t=$("#step2RoomNo").val();return void 0==t||""==t?void $.alert("请填写房间数量！","提示！"):t>50?void $.alert("最高投保不超过50间房！","提示！"):isNaN(t)||0>=t||t!=parseInt(t)?void $.alert("房间数量只能为正整数！"):void updateLocation("roomNo",parseInt(t),"step3.html")}),$(".step3Back").on("click",function(){var t=decodeToJson();void 0!=t.county&&(window.location.href="step2.html"+location.search)}),$(".step3Click").on("click",function(){var t=$(".step3_select .on").index();0==t?updateLocation("nowood",t,"resultListWood.html"):updateLocation("nowood",t,"resultList.html")}),$(".btn_tb").on("click",function(){var t=$(".safeDetail .date_input").val();return""==t?($.alert("请选择保险起期！"),!1):void updateLocation("startdate",t,"detailList.html")}),$(".tbxz").on("click",function(){window.history.go(-1)}),$(".info_cardNo").blur(function(){if("01"==$(".info_card").attr("data-id")){var o=$(".info_cardNo").val(),n=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i;if(n.test(o)){$(".info_sex").html(d[t(o)]),$("#sex").attr("data-values",1-t(o));var a=e(o);$(".info_date").val(a)}}}),$(".surePay").on("click",function(){var t=/^0?1[3|4|5|8][0-9]\d{8}$/,e=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i;if(""==$(".info_name").val())return $.alert("请填写姓名！"),!1;if(""==$(".info_card").html())return $.alert("请选择证件类型！"),!1;if(""==$(".info_cardNo").val())return $.alert("请填写证件号码！"),!1;if("01"==$(".info_card").attr("data-id")&&!e.test($(".info_cardNo").val()))return $.alert("请填写正确的身份证格式！"),!1;if(""==$(".info_date").val())return $.alert("请选择出生日期！"),!1;var o=date.getDatePeriod($(".info_date").val(),date.today(),"y");if(18>o)return $.alert("投保人年龄不能低于18岁！"),!1;if(""==$(".info_tel").val())return $.alert("请填写手机号码！"),!1;if(!t.test($(".info_tel").val()))return $.alert("请填写正确的手机号码！"),!1;if(""==$(".info_mail").val())return $.alert("请填写邮箱！"),!1;if(""==$(".info_sex").html())return $.alert("请选择性别！"),!1;if(""==$("#idType").find(".weui_cell_ft").html())return $.alert("请选择投保人身份类型！"),!1;if(0!=$(".info_city p").length)return $.alert("请选择城市！"),!1;if(""==$(".info_adress").val())return $.alert("请填写街道！"),!1;if(""==$(".info_type").html())return $.alert("请选择房屋结构！"),!1;if(0==$(".weui_icon_blue").length)return $.alert("请勾选并确定您已同意《投保须知》和《投保条款》！"),!1;var i=date.plusDate(decodeToJson().startdate,1,"y","yyyy-MM-dd");i=date.plusDate(i,-1,"d","yyyy-MM-dd")+" 23:59:59";var r=decodeToJson().startdate+" 00:00:00",d={appntObject:{appliacntBirthday:$(".info_date").val(),appliacntGender:$("#sex").attr("data-values"),appliacntIDType:$(".info_card").attr("data-id"),appliacntName:$(".info_name").val(),appliacntNumber:$(".info_cardNo").val(),appliacntTelNumber:$(".info_tel").val()},insuranceObject:{effectivTime:r,insuranceCode:"",insuranceName:"",plan:"",premium:a(decodeToJson().type),terminalTime:i},prodcutDisffObject:{ccAddress:$("#info_county").html()+$(".info_city").html()+$(".info_adress").val(),propertyQty:$(".safeDetailRoomNo").html(),propertyStructure:$(".info_type").attr("data-id"),applicantIdentity:$("#idType").attr("data-id")}};0==decodeToJson().nowood?(d.insuranceObject.insuranceCode="24ED",d.insuranceObject.insuranceName="木结构"):(d.insuranceObject.insuranceCode="24EC",d.insuranceObject.insuranceName="非木结构"),0==decodeToJson().type||1==decodeToJson().type?d.insuranceObject.plan="A":2==decodeToJson().type?d.insuranceObject.plan="B":3==decodeToJson().type?d.insuranceObject.plan="C":4==decodeToJson().type&&(d.insuranceObject.plan="D"),n(d)}),o()});var _hmt=_hmt||[];!function(){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?f982003799c920ee8d4e14f679f3e82b";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();